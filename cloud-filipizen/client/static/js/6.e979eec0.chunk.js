(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[6],{544:function(e,t,n){"use strict";n.r(t),n.d(t,"TerminalTicketWebController",(function(){return y}));var a=n(0),r=n.n(a),i=n(2),l=(n(87),n(88));function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var c={container:{display:"flex",flexDirection:"column",justifyContent:"center",maxWidth:350,padding:15,border:"1px solid #aaa",borderRadius:5,borderShadow:"5px 0px 7px -7px rgba(0,0,0,0.8)"},text:{textAlign:"center",opacity:.75,marginTop:0}},u={itineraryContainer:{display:"flex",justifyContent:"space-between",border:"1px solid #aaa",padding:"0px 15px",marginBottom:5,borderRadius:5},text:{fontWeight:800,marginRight:15}},s=function(e){var t=0;return e.guestInfo.numadult&&(t+=parseInt(e.guestInfo.numadult)),e.guestInfo.numsenior&&(t+=parseInt(e.guestInfo.numsenior)),e.guestInfo.numchildren&&(t+=parseInt(e.guestInfo.numchildren)),"With "+t+" Guest(s)"},m=function(e){var t=e.partner,n=e.onCancel,l=e.onSubmit,c=e.error,u=Object(i.lb)()[0],m=Object(a.useState)(c)[0],f=u.entity,p=u.bill,b=f.routes.filter((function(e){return e.selected})),y=s(f);return r.a.createElement(i.e,{style:{maxWidth:500}},r.a.createElement(i.Y,null,"Boracay Terminal Fee Ticket Order"),r.a.createElement(i.T,null,"Order Fees"),r.a.createElement(i.Q,null),r.a.createElement(i.s,{msg:m}),r.a.createElement(i.K,{style:d.infoContainer},r.a.createElement("label",{style:{fontWeight:500}},"Terminal Fee Summary"),r.a.createElement(i.Q,null),b.map((function(e){return r.a.createElement("label",{key:e.objid,style:d.info},e.title+" on "+Object(i.cb)(e.traveldate))})),r.a.createElement("label",{style:d.info},y)),r.a.createElement(i.Q,null),r.a.createElement(i.K,{style:d.billContainer},p.items.map((function(e,t){return r.a.createElement(i.K,{style:d.row,key:t},r.a.createElement(i.y,null,e.item.title),r.a.createElement(i.y,null,Object(i.ab)(e.amount)))})),r.a.createElement(i.Q,null),r.a.createElement(i.K,{style:d.row},r.a.createElement(i.y,{style:{fontWeight:800}},"TOTAL:"),r.a.createElement(i.y,{style:{fontWeight:800}},Object(i.ab)(p.amount)))),r.a.createElement(i.a,null,r.a.createElement(i.b,{caption:"Back",action:function(){n(4)}}),r.a.createElement(i.d,{caption:"Checkout",action:function(){var e=f.routes.filter((function(e){return e.selected})),n="Terminal Fee for";n+=" "+e.map((function(e){return e.origin+" - "+e.destination})).join(" and "),n+=" "+function(e){return e.map((function(e){return Object(i.cb)(e.traveldate)})).join(" and ")}(e),n+=". "+s(f);var a=o({},f.guestInfo,{routes:f.routes.filter((function(e){return e.selected}))});l({refno:p.billno,txntype:u.txntype,origin:u.origin,txntypename:"BORACAY TERMINAL TICKET",orgcode:t.id,paidby:p.paidby,paidbyaddress:p.paidbyaddress,amount:p.amount,paymentdetails:n,particulars:n,info:{data:a},items:p.items})}})))},d={infoContainer:{display:"flex",flexDirection:"column",alignItems:"center"},info:{fontSize:14,fontWeight:400},billContainer:{display:"flex",flexDirection:"column",margin:"0px 20%",border:"1px solid #aaa",padding:15,borderRadius:5},row:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},f={txntype:"ticketing",txntypename:"ticketing",origin:"filipizen",bill:{},contact:{},entity:{guestInfo:{total:0,numadult:null,numsenior:null,numchildren:null,numfil:null,numnonfil:null},routes:[{objid:"1",origin:"Caticlan",destination:"Cagban",title:"Caticlan - Cagban",selected:!1},{objid:"2",origin:"Cagban",destination:"Caticlan",title:"Cagban - Caticlan",selected:!1}]}},p=function(e,t){switch(t.type){case"SET_ENTITY":return void(e.entity=t.entity);case"SET_GUESTINFO":return void(e.entity.guestInfo=t.guestInfo);case"SET_BILL":return void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},b=[{step:1,name:"disclaimer",caption:"Disclaimer",Component:function(e){var t=e.history,n=e.moveNextStep,l=e.title,o=Object(a.useState)(!1),u=o[0],s=o[1],m=Object(a.useState)(!1),d=m[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.I,{open:m[0],msg:"Kindly click on the check box to agree on the terms and conditions",onAccept:function(){return d(!1)}}),r.a.createElement(i.e,null,r.a.createElement(i.Y,null,l),r.a.createElement(i.T,null,"Initial Information"),r.a.createElement(i.Q,null),r.a.createElement(i.K,{style:c.container},r.a.createElement("p",{style:c.text},"Please read before proceeding. The following section will require you to provide names of guests and other information that will require consent."),r.a.createElement("p",{style:c.text},"This information will be used for this transaction and for tourism purposes. In compliance with RA 10173 or Data Privacy Act of the Philippines, your data will not be used for other purposes except for the above mentioned."),r.a.createElement("p",{style:c.text},"By using, you agree to our terms and conditions."),r.a.createElement(i.Q,{height:30}),r.a.createElement(i.K,{style:{padding:"0px 30px"}},r.a.createElement(i.h,{caption:"I have read and agree with the terms and conditions",value:u,onChange:s}))),r.a.createElement(i.a,null,r.a.createElement(i.b,{action:function(){return t.goBack()}}),r.a.createElement(i.d,{caption:"Next",action:function(){u?n():d(!0)}}))))}},{step:2,name:"verification",caption:"Verification",Component:function(e){return r.a.createElement(l.b,o({},e,{showName:!0,emailRequired:!0}))}},{step:3,name:"itinerary",caption:"Travel Itinerary",Component:function(e){var t=e.title,n=e.moveNextStep,l=e.movePrevStep,c=Object(i.lb)(),s=c[1],m=Object(a.useState)(o({},c[0].entity)),d=m[0],f=m[1],p=Object(a.useState)(),b=p[0],y=p[1],E=Object(a.useState)([{},{}]),g=E[0],v=E[1];return r.a.createElement(i.e,null,r.a.createElement(i.Y,null,t),r.a.createElement(i.T,null,"Travel Itinerary"),r.a.createElement(i.Q,null),r.a.createElement(i.t,{context:d,handler:f},r.a.createElement("h4",null,"Specify Dates of Travel"),r.a.createElement(i.s,{msg:b}),d.routes.map((function(e,t){return r.a.createElement(i.K,{style:u.itineraryContainer,key:e.objid},r.a.createElement(i.h,{caption:e.origin+" - "+e.destination,name:"routes["+t+"].selected"}),r.a.createElement(i.l,{name:"routes["+t+"].traveldate",fullWidth:!1,style:{width:200},placeholder:"mm/dd/yyyy",variant:"filled",error:g[t].error,helperText:g[t].error,readOnly:!d.routes[t].selected}))}))),r.a.createElement(i.a,null,r.a.createElement(i.b,{action:l}),r.a.createElement(i.d,{caption:"Next",action:function(){try{!function(){if(y(null),d.routes.findIndex((function(e){return e.selected}))<0)throw"Kindly select at least one (1) travel destination";var e=!1,t=d.routes.map((function(t,n){if(t.selected){if(!t.traveldate)return e=!0,{error:"Travel date is required"};if(0==n&&!Object(i.jb)(t.traveldate,Object(i.bb)(-1)))return e=!0,{error:"Date must be on or after current date"};if(1==n&&!Object(i.jb)(t.traveldate,Object(i.bb)(-1)))return e=!0,{error:"Date must be on or after departure date"};if(1==n&&d.routes[0].selected&&d.routes[0].traveldate){var a=d.routes[0].traveldate;if(Object(i.kb)(t.traveldate,a))return e=!0,{error:"Date must be after "+a}}}return{error:null}}));if(e)throw v(t),null}(),s({type:"SET_ENTITY",entity:d}),n()}catch(e){y(e)}}})))}},{step:4,name:"guest",caption:"Guest Profile",Component:function(e){var t=e.title,n=e.partner,l=e.moveNextStep,c=e.movePrevStep,u=Object(i.lb)(),s=u[0],m=u[1],d=Object(a.useState)(),f=d[0],p=d[1],b=Object(a.useState)(!1),y=b[0],E=b[1],g=Object(a.useState)(o({},s.entity.guestInfo)),v=g[0],h=g[1],x=Object(a.useRef)(),T=function(){var e=0;return v.numadult&&(e+=parseInt(v.numadult)),v.numsenior&&(e+=parseInt(v.numsenior)),v.numchildren&&(e+=parseInt(v.numchildren)),e},j=function(e){return e-v.numfil};return r.a.createElement("form",{ref:x},r.a.createElement(i.e,null,r.a.createElement(i.Y,null,t),r.a.createElement(i.T,null,"Guest Profile"),r.a.createElement(i.Q,null),r.a.createElement(i.s,{msg:f}),r.a.createElement(i.K,{width:400},r.a.createElement(i.t,{context:v,handler:h},r.a.createElement(i.w,{caption:"No. of Adults (ages 12 or above)",name:"numadult",allowNegative:!1,autoFocus:!0}),r.a.createElement(i.w,{caption:"No. of Senior (ages 60 and above)",name:"numsenior",allowNegative:!1}),r.a.createElement(i.w,{caption:"No. of Children (below 12)",name:"numchildren",allowNegative:!1}),r.a.createElement(i.Q,null),r.a.createElement(i.w,{caption:"No. of Filipino citizens",name:"numfil",required:!0,allowNegative:!1}))),r.a.createElement(i.a,null,r.a.createElement(i.b,{caption:"Back",variant:"text",action:c}),r.a.createElement(i.d,{caption:"Next",action:function(){var e=T();if(0!==e){if(1===e||x.current.reportValidity()){var t=j(e);t<0?p("Number of Filipino citizens should not exceed "+e):(E(!0),p(null),m({type:"SET_GUESTINFO",guestInfo:o({},v,{numnonfil:t,total:e})}),function(){try{return Promise.resolve(i.P.lookupAsync(n.id+":OnlineTicketingService","ticketing")).then((function(e){var t=T(),n=o({},v,{numnonfil:j(t),total:t,contact:s.contact,routes:s.entity.routes,tag:"TOURIST"});return Promise.resolve(e.invoke("getBilling",{info:n}))}))}catch(e){return Promise.reject(e)}}().then((function(e){console.log("BILL",e),m({type:"SET_BILL",bill:e}),E(!1),l()})).catch((function(e){console.log("error",e),p(e.toString()),E(!1)})))}}else p("At least one (1) guest should be specified.")},loading:y,disabled:y}))))}},{step:5,name:"epayment",caption:"Payment",Component:function(e){var t=Object(i.lb)();return r.a.createElement(l.d,o({module:{title:"Boracay Terminal Fee Ticket Order",component:m}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],y=function(e){var t=e.partner,n=e.service,l=e.location,c=e.history,u=e.initialStep,s=Object(a.useState)(void 0===u?0:u),m=s[0],d=s[1],y=b[m];return r.a.createElement(i.R,{initialState:f,reducer:p},r.a.createElement(i.J,null,r.a.createElement(i.j,{center:!0},r.a.createElement(y.Component,o({page:y},{partner:t,service:n,location:l,history:c,moveNextStep:function(){d((function(e){return e+1}))},movePrevStep:function(){0===m?c.goBack():d((function(e){return e-1}))},cancelPayment:function(){d(1)},title:"Terminal Fee Ticket Order"})))))}}}]);