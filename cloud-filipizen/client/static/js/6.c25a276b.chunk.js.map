{"version":3,"sources":["../../src/billing/InitialInfo.js","../../src/billing/OnlineBilling.js","../../src/billing/WaterworksBillingWebController.js","../../src/billing/Payment.js"],"names":["OnlineBilling","title","partner","onCancel","onSubmit","paymentError","error","ctx","useData","refno","txntype","useState","bill","setBill","loading","React","Card","style","maxWidth","Title","Subtitle","Spacer","Error","msg","FormPanel","context","handler","Text","name","caption","readOnly","Panel","row","Table","items","showPagination","TableColumn","expr","currencyFormat","item","amount","type","align","styles","totalContainer","total","ActionBar","disabled","BackLink","action","Button","origin","orgcode","id","billtoyear","billtoqtr","paidby","paidbyaddress","info","data","particulars","acctno","disableWhen","subtitle","fontSize","fontWeight","opacity","color","display","justifyContent","marginTop","marginRight","initialState","contact","reducer","draft","pages","step","Component","ContactVerification","moveNextStep","movePrevStep","dispatch","setError","setLoading","setRefno","Fragment","value","onChange","autoFocus","variant","billOptions","Service","lookupAsync","svc","params","invoke","then","e","err","toString","props","EPayment","module","component","initialContact","initialStep","cancelPayment","WaterworksBillingWebController","service","location","history","setStep","page","StateProvider","Page","Content","center","cs","goBack"],"mappings":"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","file":"static/js/6.c25a276b.chunk.js","sourcesContent":["import React, { useState } from 'react'\nimport {\n  Text,\n  Title,\n  Button,\n  ActionBar,\n  Subtitle,\n  Spacer,\n  Service,\n  Error,\n  BackLink,\n  useData,\n  Card\n} from 'rsi-react-web-components'\n\nconst InitialInfo = ({\n  title,\n  partner,\n  moveNextStep,\n  movePrevStep,\n}) => {\n\n  const [ctx, dispatch] = useData();\n  const { txntype } = ctx;\n\n  const [error, setError] = useState()\n  const [loading, setLoading] = useState(false)\n  const [refno, setRefno] = useState()\n\n  const getBilling = async (billOptions = {}) => {\n    const svc = await Service.lookupAsync(`${partner.id}:OnlineWaterworksBillingService`, \"waterworks\")\n    const params = { txntype, refno, ...billOptions }\n    return await svc.invoke(\"getBilling\", params);\n  }\n\n  const loadBill = (billOptions = {}) => {\n    setLoading(true);\n    setError(null);\n    getBilling(billOptions).then(bill => {\n      dispatch({type: \"SET_BILL\", refno: refno, bill: bill});\n      moveNextStep();\n    }).catch(err => {\n      setError(err.toString());\n      setLoading(false)\n    })\n  }\n\n  return (\n    <React.Fragment>\n    <Card>\n      <Title>{title}</Title>\n      <Subtitle>Initial Information</Subtitle>\n      <Spacer />\n      <Error msg={error} />\n      <Text\n        caption=\"Account No.\"\n        name=\"refno\"\n        value={refno}\n        onChange={setRefno}\n        readOnly={loading}\n        autoFocus={true}\n      />\n      <ActionBar>\n        <BackLink caption='Back' variant=\"text\" action={movePrevStep} />\n        <Button caption='Next' action={loadBill} loading={loading} disabled={loading} />\n      </ActionBar>\n    </Card>\n    </React.Fragment>\n  )\n}\n\nexport default InitialInfo\n","import React, { useState } from 'react'\nimport {\n  Card,\n  Panel,\n  Text,\n  Button,\n  FormPanel,\n  ActionBar,\n  Spacer,\n  Error,\n  Subtitle,\n  Title,\n  BackLink,\n  useData,\n  Table,\n  TableColumn,\n  currencyFormat\n} from 'rsi-react-web-components'\n\nconst origin = 'filipizen'\n\nconst OnlineBilling = ({\n  title,\n  partner,\n  onCancel,\n  onSubmit,\n  error: paymentError\n}) => {\n  const [ctx, dispatch] = useData();\n  const { refno, txntype, contact, bill: initialBill } = ctx;\n  const [bill, setBill] = useState(initialBill);\n  const [error, setError] = useState(paymentError);\n  const [loading, setLoading] = useState(false)\n\n  const checkoutPayment = () => {\n    onSubmit({\n      refno,\n      txntype,\n      origin,\n      orgcode: partner.id,\n      billtoyear: bill.billtoyear,\n      billtoqtr: bill.billtoqtr,\n      paidby: bill.paidby,\n      paidbyaddress: bill.paidbyaddress,\n      amount: bill.amount,\n      info: {data: bill },\n      particulars: `Wateworks Account No. ${bill.acctno}`\n    });\n  }\n\n  const onCancelBilling = () => {\n    onCancel(0);\n  }\n\n  return (\n    <Card style={{maxWidth: 500}}>\n      <Title>{title}</Title>\n      <Subtitle>Billing Information</Subtitle>\n      <Spacer />\n        <Error msg={error} />\n        <FormPanel context={bill} handler={setBill}>\n          <Text name=\"acctno\" caption=\"Account No.\" readOnly />\n          <Text name=\"acctname\" caption=\"Account Name\" readOnly />\n          <Text name=\"address.text\" caption=\"Address\" readOnly />\n          <Text name=\"classificationid\" caption=\"Classification\" readOnly />\n          <Text name=\"billno\" caption=\"Last Bill Period\" readOnly />\n          <Panel row>\n            <Text name=\"monthname\" caption=\"Bill Month\" readOnly />\n            <Text name=\"year\" caption=\"Bill Year\" readOnly />\n          </Panel>\n          <Panel row>\n            <Text name=\"meter.size.title\" caption=\"Meter Size\" readOnly />\n            <Text name=\"consumption.prev.reading\" caption=\"Previous Reading\" readOnly />\n            <Text name=\"consumption.reading\" caption=\"Current Reading\" readOnly />\n            <Text name=\"consumption.volume\" caption=\"Consumption\" readOnly />\n          </Panel>\n          <Spacer />\n          <h4>Bill Details</h4>\n          <Table items={bill.items} showPagination={false}>\n            <TableColumn expr=\"item.title\" caption=\"Account\" />\n            <TableColumn expr=\"remarks\" caption=\"Particulars\" />\n            <TableColumn\n              expr={item =>  currencyFormat(item.amount)}\n              caption=\"Amount Due\"\n              type=\"decimal\"\n              align=\"right\"\n            />\n          </Table>\n          <Panel style={styles.totalContainer}>\n            <h4 style={styles.total}>TOTAL</h4>\n            <h4 style={styles.amount}>{currencyFormat(bill.amount)}</h4>\n          </Panel>\n        </FormPanel>\n      <ActionBar disabled={loading}>\n        <BackLink caption='Back' action={onCancelBilling} />\n        <Button caption='Confirm Payment' action={checkoutPayment} disableWhen={bill.amount === 0} />\n      </ActionBar>\n    </Card>\n  )\n}\n\nconst styles = {\n  subtitle: {\n    fontSize: 16,\n    fontWeight: 400,\n    opacity: 0.8,\n    color: \"green\"\n  },\n  totalContainer: {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    marginTop: -10\n  },\n  total: {\n    fontWeight: 800,\n    marginRight: 40,\n  },\n  amount: {\n    marginRight: 20,\n  }\n};\n\nexport default OnlineBilling\n","import React, { useState } from 'react'\nimport { Page, StateProvider, Content } from \"rsi-react-web-components\";\nimport \"rsi-react-web-components/dist/index.css\";\n\nimport { ContactVerification } from 'rsi-react-filipizen-components'\n\nconst initialState = {\n  txntype: \"waterworks\",\n  refno: null,\n  bill: {},\n  contact: {},\n}\n\nconst reducer = (draft, action) => {\n  switch(action.type) {\n    case \"SET_BILL\":\n      draft.refno = action.refno;\n      draft.bill = action.bill;\n      return;\n\n    case \"SET_CONTACT\":\n      draft.contact = action.contact;\n      return;\n  }\n}\n\nimport InitialInfo from \"./InitialInfo\";\nimport Payment from \"./Payment\";\n\nconst pages = [\n  {step: 1, name: \"verification\", caption: \"Verification\", Component: ContactVerification},\n  {step: 2, name: \"initial\", caption: \"Initial Information\", Component: InitialInfo},\n  {step: 3, name: \"payment\", caption: \"Payment\", Component: Payment},\n]\n\nconst WaterworksBillingWebController = ({\n  partner,\n  service,\n  location,\n  history,\n  initialStep=0\n}) => {\n\n  const [step, setStep] = useState(initialStep);\n\n  const moveNextStep = () => {\n    setStep(cs => cs+1);\n  }\n\n  const movePrevStep = () => {\n    if (step === 0) {\n      history.goBack();\n    } else {\n      setStep(cs => cs-1);\n    }\n  }\n\n  const cancelPayment = () => {\n    setStep(1);\n  }\n\n  const page = pages[step];\n  const PageComponent = page.Component;\n  const compProps = {\n    partner,\n    service,\n    location,\n    history,\n    moveNextStep,\n    movePrevStep,\n    cancelPayment,\n    title: \"Waterworks Online Billing\",\n  };\n\n  return (\n    <StateProvider initialState={initialState} reducer={reducer}>\n      <Page>\n        <Content center>\n          <PageComponent page={page} {...compProps} />\n        </Content>\n      </Page>\n    </StateProvider>\n  )\n}\n\nexport default WaterworksBillingWebController\n","import React from 'react'\nimport { useData } from 'rsi-react-web-components'\nimport { EPayment } from 'rsi-react-filipizen-components'\n\nimport OnlineBilling from './OnlineBilling';\n\nconst Payment = (props) => {\n  const [ctx, dispatch] = useData()\n  const module = {\n    title: 'Waterworks Online Billing',\n    component: OnlineBilling\n  }\n  return (\n    <EPayment\n      module={module}\n      {...props}\n      initialContact={ctx.contact}\n      initialStep={1}\n      cancelPayment={props.cancelPayment}\n    />\n  )\n}\n\nexport default Payment\n"],"sourceRoot":""}