(this["webpackJsonpfilipizen-client"]=this["webpackJsonpfilipizen-client"]||[]).push([[3],{742:function(e,t,n){"use strict";n.r(t),n.d(t,"BplsBillingWebController",(function(){return d})),n.d(t,"NewBusinessWebController",(function(){return M})),n.d(t,"RenewBusinessWebController",(function(){return A}));var a=n(0),r=n.n(a),i=n(2),l=(n(116),n(117));function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var o=function(e){var t=e.initialValue,n=e.open,l=e.onAccept,c=e.onCancel,o=Object(a.useState)(void 0===t?{billtoqtr:4}:t),s=o[0];return r.a.createElement(i.L,{open:n,caption:"Pay Options",onAccept:function(){l(s)},onCancel:c,maxWidth:100},r.a.createElement(i.w,{context:s,handler:o[1]},r.a.createElement(i.T,{caption:"Quarter to Bill",name:"billtoqtr",items:[1,2,3,4]})))},s=function(e){var t=e.title,n=e.partner,l=e.onCancel,c=e.onSubmit,s=e.error,m=Object(i.tb)()[0],p=m.refno,u=m.txntype,d=m.contact,b=Object(a.useState)(m.bill),E=b[0],f=b[1],v=Object(a.useState)(s),h=v[0],g=v[1],y=Object(a.useState)(!1),S=y[0],O=y[1],j=Object(a.useState)(!1),N=j[0],A=j[1],w=Object(a.useState)(4),x=w[0],B=w[1],k=Object(a.useState)()[1];Object(a.useEffect)((function(){p&&(O(!0),g(null),function(){try{var e={txntype:u,refno:p,qtr:x,showdetails:!0},t=i.U.lookupAsync(n.id+":OnlineBusinessBillingService","bpls");return Promise.resolve(t.invoke("getBilling",e))}catch(e){return Promise.reject(e)}}().then((function(e){var t=e.info;t.qtr=4,0==t.amount&&(t.items=[]),f(t),k("51001:"+t.billno),O(!1)})).catch((function(e){g(e.toString()),O(!1)})))}),[x]);var T=d&&d.email===E.email;return r.a.createElement(i.g,{style:{maxWidth:800}},r.a.createElement(i.fb,null,t),r.a.createElement(i.Z,null,"Billing Information"),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:h}),r.a.createElement(i.O,null,r.a.createElement(i.B,{context:E,caption:"Application No.",expr:"appno"}),r.a.createElement(i.B,{context:E,caption:"Application Type",expr:"apptype"}),r.a.createElement(i.B,{context:E,caption:"Date Filed",expr:"appdate"}),r.a.createElement(i.B,{context:E,caption:"BIN",expr:"bin"}),r.a.createElement(i.B,{context:E,caption:"Trade Name",expr:"tradename",visibleWhen:T}),r.a.createElement(i.B,{context:E,caption:"Owner Name",expr:"ownername",visibleWhen:T}),r.a.createElement(i.B,{context:E,caption:"Business Address",expr:"address",visibleWhen:T}),r.a.createElement(i.W,null),r.a.createElement(i.O,{style:{display:"flex",justifyContent:"flex-start"}},r.a.createElement(i.e,{variant:"outlined",caption:"Pay Option",action:function(){return A(!0)}})),r.a.createElement(i.cb,{items:E?E.items:[],size:"small",showPagination:!1},r.a.createElement(i.db,{caption:"Particulars",expr:function(e){return(e.lobname?e.lobname:"")+" -"+e.account}}),r.a.createElement(i.db,{caption:"Amount",expr:"amount",align:"right",format:"currency"}),r.a.createElement(i.db,{caption:"Surcharge",expr:"surcharge",align:"right",format:"currency"}),r.a.createElement(i.db,{caption:"Interest",expr:"interest",align:"right",format:"currency"}),r.a.createElement(i.db,{caption:"Total",expr:"total",align:"right",format:"currency"})),r.a.createElement(i.O,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",paddingRight:15}},r.a.createElement(i.B,{context:E,caption:"Bill Amount:",expr:function(e){return Object(i.hb)(e.amount)}}))),r.a.createElement(i.b,{disabled:S},r.a.createElement(i.d,{caption:"Back",action:function(){l(0)}}),r.a.createElement(i.e,{caption:"Confirm Payment",action:function(){c({refno:p,txntype:u,origin:"filipizen",orgcode:n.id,qtr:x,info:{data:E,qtr:x},paidby:E.paidby,paidbyaddress:E.paidbyaddress,amount:E.amount,particulars:"Business Tax for Application No. "+E.appno})},disableWhen:0===E.amount})),r.a.createElement(o,{initialValue:E&&{qtr:x},open:N,onAccept:function(e){A(!1),B(e.billtoqtr)},onCancel:function(){return A(!1)}}))},m={txntype:"bpls",refno:null,bill:{},contact:{}},p=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},u=[{step:1,name:"verification",caption:"Verification",Component:l.b},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,l=e.moveNextStep,c=e.movePrevStep,o=Object(i.tb)(),s=o[1],m=o[0].txntype,p=Object(a.useState)(),u=p[0],d=p[1],b=Object(a.useState)(!1),E=b[0],f=b[1],v=Object(a.useState)(),h=v[0],g=v[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement(i.Z,null,"Initial Information"),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:u}),r.a.createElement(i.eb,{name:"appno",caption:"BIN or Application No.",value:h,onChange:g,autoFocus:!0}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",variant:"text",action:c}),r.a.createElement(i.e,{caption:"Next",action:function(){f(!0),d(null),function(){try{var e={txntype:m,refno:h,qtr:4,showdetails:!0},t=i.U.lookupAsync(n.id+":OnlineBusinessBillingService","bpls");return Promise.resolve(t.invoke("getBilling",e))}catch(e){return Promise.reject(e)}}().then((function(e){var t=e.info;t.qtr=4,0==t.amount&&(t.items=[]),s({type:"SET_BILL",refno:h,bill:t}),l()})).catch((function(e){d(e.toString()),f(!1)}))},loading:E,disabled:E}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(i.tb)();return r.a.createElement(l.d,c({module:{title:e.title,component:s}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],d=function(e){var t=e.partner,n=e.service,l=e.location,o=e.history,s=e.initialStep,d=Object(a.useState)(void 0===s?0:s),b=d[0],E=d[1],f=u[b];return r.a.createElement(i.X,{initialState:m,reducer:p},r.a.createElement(i.N,null,r.a.createElement(i.l,{center:!0},r.a.createElement(i.O,null,r.a.createElement(f.Component,c({page:f},{partner:t,service:n,location:l,history:o,moveNextStep:function(){E((function(e){return e+1}))},movePrevStep:function(){0===b?o.goBack():E((function(e){return e-1}))},cancelPayment:function(){E(1)},title:"Business Online Billing"}))))),r.a.createElement(i.W,{height:50}))},b={bin:null,app:{objid:"",lobs:[],infos:[],newinfos:[],redflags:[]},contact:{}},E=function(e,t){var n;switch(t.type){case"SET_APP":return e.app=t.app,void(e.bin=t.app.bin);case"UPDATE_APP_INFOS":return e.app=t.app,(n=e.app.newinfos).push.apply(n,t.infos),void(e.bin=t.app.bin);case"SET_CONTACT":return void(e.contact=t.contact);default:return e}},f=function(e){var t=e.partner,n=e.title,l=void 0===n?"New Permit Application":n,c=e.cancelCaption,o=void 0===c?"Cancel":c,s=e.onCancel,m=e.onContinue,p=e.error,u=Object(a.useState)(!1),d=u[0],b=u[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.Z,null,l),r.a.createElement(i.W,{height:30}),r.a.createElement(i.v,{msg:p}),r.a.createElement(i.ab,null,"Please read thoroughly before proceeding"),r.a.createElement("p",{style:{opacity:.8}},"This online service will require personal information from the applicant, lot owner(s) and professionals involved in this transaction. In compliance with the Data Privacy Act, we are securing your consent that you have been authorized by the aforementioned parties to act on their behalf. The data collected will be stored, processed and used for effectively carrying out legitimate transactions with the local government of ",t.title,". If you do not agree to these terms, you can cancel out by click on the Cancel button. If you agree to these terms, tick on the checkbox and click Continue."),r.a.createElement(i.j,{caption:"Yes, I have read and agree to the terms and conditions",value:d,name:"agreeDisclaimer",onChange:b}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:o,action:s}),r.a.createElement(i.e,{caption:"Continue",action:m,disableWhen:!d})))},v=function(e){var t=e.title,n=e.appno,a=e.onContinue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.Z,null,void 0===t?"New Permit Application":t),r.a.createElement(i.W,{height:30}),r.a.createElement(i.ab,null,"Application created"),r.a.createElement("p",null,"Please take note of the tracking number for this application. This will be your tracking reference for completing and follow up for this application."),r.a.createElement(i.ab,null,n),r.a.createElement(i.b,null,r.a.createElement(i.e,{caption:"Continue",action:a})))},h=function(e){var t=e.isPreviousInfo,n=void 0===t||t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.cb,{items:e.lobs,showPagination:!1},r.a.createElement(i.db,{caption:"Line of Business",width:400,expr:"lob.name"}),r.a.createElement(i.db,{caption:n?"Previous Gross (Php)":"Gross (Php)",expr:function(e){return Object(i.hb)(n?e.prevgross:e.gross)},type:"decimal",align:"right"})))},g=[{name:"contact",caption:"Contact Information"},{name:"enter-bin",caption:"Business Identification Number"},{name:"app-notice",caption:"Business Renewal Notice"},{name:"verify-info",caption:"Business Verify Information"},{name:"confirmation",caption:"Confirmation"},{name:"newapp",caption:"New Application "}],y={decimal:i.o,integer:i.y},S=function(e){var t=e.dataType,n=e.name,a=e.autoFocus,i=void 0!==a&&a,l=e.error,c=void 0!==l&&l,o=e.helperText,s=y[void 0===t?"integer":t];return r.a.createElement("div",{className:"_1WWgR"},r.a.createElement("label",{style:{width:350}},e.caption),r.a.createElement(s,{className:"_zFpAi",name:n,fullWidth:!1,variant:"outlined",size:"small",required:!0,autoFocus:i,helperText:o,error:c}))},O={lobTitles:{display:"flex",justifyContent:"space-between"}},j=function(e){var t=e.app,n=e.requirements,l=e.deleteRequirement,c=e.onUpload,o=Object(a.useState)({ref:{},attachment:{}})[1],s=Object(a.useState)(-1),m=s[0],p=s[1];return Object(a.useEffect)((function(){n.length>0&&m<0&&(o(n[0]),p(0))}),[n]),r.a.createElement("div",{className:"_2TeAB"},r.a.createElement("table",{className:"_30N21"},n.map((function(e){console.log("requirement",e);var n=t.objid.replace(/\W/g,""),a=e.attachment.location?r.a.createElement("td",{key:e.objid},r.a.createElement("div",{className:"_hWy1N"},r.a.createElement(i.f,{href:e.attachment.location,target:"_blank"},"View"),r.a.createElement(i.p,{attachment:e.attachment,action:function(){return l(e)}}))):r.a.createElement("td",{key:e.objid,colspan:"2"},r.a.createElement(i.gb,{key:e.objid,fileId:"attachments/"+n,data:e,onUpload:function(t){return c(t,e)},uploadedFile:e.attachment}));return r.a.createElement("tr",{key:e.objid},r.a.createElement("td",{className:"_vaLwg"},e.ref.title),a)}))))},N=[{step:0,name:"select",caption:"Select Application Type",component:function(e){var t=e.service,n=e.history,l=e.appService,c=e.moveNextStep,o=Object(a.useState)(),s=o[0],m=o[1],p=Object(a.useState)("new"),u=p[0],d=p[1],b=Object(a.useState)(),E=b[0],f=b[1],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(i.tb)()[1];return r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t.title),r.a.createElement(i.Z,null,"Select an action"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.S,{value:u,onChange:d},r.a.createElement(i.z,{caption:"Create New Application",value:"new"}),r.a.createElement(i.z,{caption:"Resume Pending Application",value:"resume"})),r.a.createElement(i.eb,{caption:"Application Tracking No.",value:E,onChange:f,visibleWhen:"resume"===u,variant:"outlined",fullWidth:!1,required:!0,style:{marginLeft:40},error:s,helperText:s,size:"small",autoFocus:!0}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return n.goBack()}}),r.a.createElement(i.e,{caption:"Next",action:function(){"new"===u?c():E?(g(!0),l.invoke("getApplication",{controlno:E},(function(e,t){e?m(e):(t.infos=[],t.lobs=[],y({type:"SET_APP",app:t}),c(t.step)),g(!1)}))):m("Tracking No. is required.")},disabled:h,processing:h})))}},{step:1,name:"initial",caption:"Initial",component:function(e){var t=e.partner,n=e.history,o=e.title,s=e.appService,m=e.moveNextStep,p=Object(i.tb)(),u=p[1],d=p[0].contact,b=Object(a.useState)(),E=b[0],y=b[1],S=Object(a.useState)(!1),O=S[0],j=S[1],N=(Object(a.useState)(!1),Object(a.useState)({})),A=N[0],w=N[1],x=Object(a.useState)(0),B=x[1],k=g[x[0]],T=function(){y(null),B((function(e){return e+1}))},W=function(){y(null),B((function(e){return e-1}))};return r.a.createElement(r.a.Fragment,null,"contact"===k.name?r.a.createElement(l.b,{partner:t,showName:!0,moveNextStep:T,movePrevStep:W,title:o,subtitle:"Contact Verification",emailRequired:!0}):r.a.createElement(i.g,null,r.a.createElement(i.W,null),r.a.createElement(i.w,{context:A,handler:w,visibleWhen:"enter-bin"===k.name},r.a.createElement(i.fb,null,o),r.a.createElement(i.Z,null,k.caption),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:E}),r.a.createElement(i.eb,{caption:"Enter BIN",name:"bin",required:!0,autoFocus:!0}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return n.goBack()}}),r.a.createElement(i.e,{caption:"Next",action:function(){y(null),j(!0),s.invoke("validateBin",c({},A,{contact:d}),(function(e,t){var n;e?y(e):(n=g.findIndex(0==t.redflags.length?function(e){return"verify-info"===e.name}:function(e){return"app-notice"===e.name}),t.step=1,w(t),B(n)),j(!1)}))},processing:O,disableWhen:!A.bin}))),r.a.createElement(i.w,{visibleWhen:"app-notice"===k.name,context:A,handler:w},r.a.createElement(i.fb,null,o),r.a.createElement(i.Z,null,k.caption),r.a.createElement(i.W,{height:30}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"BIN",name:"bin",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application No.",name:"prevapp.appno",readOnly:!0})),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"Application Year",name:"prevapp.appyear",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application Type",name:"prevapp.apptype",readOnly:!0})),r.a.createElement(i.eb,{caption:"Trade Name",name:"tradename",readOnly:!0}),r.a.createElement(i.eb,{caption:"Owner Name",name:"owner.name",readOnly:!0}),r.a.createElement(i.eb,{caption:"Business Address",name:"businessaddress",readOnly:!0}),r.a.createElement("p",null,"You cannot renew business due to the following issues. Please settle it with the corresponding offices. You can contact our helpdesk at ",t.phoneno,"."),r.a.createElement(i.cb,{items:A.redflags,showPagination:!1},r.a.createElement(i.db,{caption:"Issue",width:300,expr:"issue"}),r.a.createElement(i.db,{caption:"Office/Department",expr:"office"})),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return n.goBack()}}))),r.a.createElement(i.w,{visibleWhen:"verify-info"===k.name,context:A,handler:w},r.a.createElement(i.fb,null,o),r.a.createElement(i.Z,null,k.caption),r.a.createElement(i.W,{height:30}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"BIN",name:"bin",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application No.",name:"prevapp.appno",readOnly:!0})),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"Application Year",name:"prevapp.appyear",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application Type",name:"prevapp.apptype",readOnly:!0})),r.a.createElement(i.eb,{caption:"Trade Name",name:"tradename",readOnly:!0}),r.a.createElement(i.eb,{caption:"Owner Name",name:"owner.name",readOnly:!0}),r.a.createElement(i.eb,{caption:"Business Address",name:"businessaddress",readOnly:!0}),r.a.createElement(i.W,null),r.a.createElement("h3",null,"Line of Businesses Operated"),r.a.createElement(h,{lobs:A.lobs}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:function(){return B(1)}}),r.a.createElement(i.e,{caption:"Next",action:T}))),r.a.createElement(i.O,{visibleWhen:"confirmation"===k.name},r.a.createElement(i.fb,null,o),r.a.createElement(f,{title:"Business Renewal Application",partner:t,error:E,onCancel:W,onContinue:function(){s.invoke("create",c({},A,{partner:t}),(function(e,t){e?y(e):(t.redflags=[],u({type:"SET_APP",app:t}),w(t),T())}))}})),r.a.createElement(i.O,{visibleWhen:"newapp"===k.name,width:400},r.a.createElement(i.fb,null,o),r.a.createElement(v,{appno:A.controlno,onContinue:m}))))}},{step:2,name:"info",caption:"General Information",component:function(e){var t=e.moveNextStep,n=e.appService,l=e.title,c=Object(i.tb)()[0].app,o=Object(a.useState)(),s=o[0],m=o[1],p=Object(a.useState)(!1)[1],u=Object(a.useState)(c),d=u[0],b=u[1];return Object(a.useEffect)((function(){p(!0),n.invoke("getInfos",{objid:d.objid},(function(e,t){e?m(e):b(t),p(!1)}))}),[]),r.a.createElement(i.g,null,r.a.createElement(i.v,{msg:s}),r.a.createElement(i.w,{context:d,handler:b},r.a.createElement(i.fb,null,l),r.a.createElement(i.ab,null,"Tracking No. ",d.controlno),r.a.createElement(i.Z,null,"General Information"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"BIN",name:"bin",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application No.",name:"controlno",readOnly:!0})),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"Application Year",name:"appyear",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application Type",name:"apptype",readOnly:!0})),r.a.createElement(i.eb,{caption:"Trade Name",name:"tradename",readOnly:!0}),r.a.createElement(i.eb,{caption:"Owner Name",name:"owner.name",readOnly:!0}),r.a.createElement(i.eb,{caption:"Business Address",name:"businessaddress",readOnly:!0}),r.a.createElement(i.W,null),d.infos.map((function(e){return r.a.createElement(i.B,{key:e.name,caption:e.caption,captionStyle:{width:350}},e.value)})),r.a.createElement(i.W,null),r.a.createElement(h,{lobs:d.lobs,isPreviousInfo:!1}),r.a.createElement(i.b,null,r.a.createElement(i.e,{caption:"Next",action:t}))))}},{step:3,name:"edit-info",caption:"Edit Information",component:function(e){var t=e.appService,n=e.moveNextStep,l=e.movePrevStep,c=e.title,o=Object(i.tb)(),s=o[1],m=o[0].app,p=Object(a.useState)([]),u=p[0],d=p[1],b=Object(a.useState)(),E=b[0],f=b[1],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(a.useState)(m),j=y[0],N=y[1];return Object(a.useEffect)((function(){g(!0),t.invoke("getInfos",j,(function(e,t){e?f(e):(N(t),s({type:"SET_APP",app:t})),g(!1)}))}),[]),r.a.createElement(i.g,null,r.a.createElement(i.v,{msg:E}),r.a.createElement(i.w,{context:j,handler:N},r.a.createElement(i.fb,null,c),r.a.createElement(i.ab,null,"Tracking No. ",j.controlno),r.a.createElement(i.Z,null,"Edit Information"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"BIN",name:"bin",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application No.",name:"controlno",readOnly:!0})),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"Application Year",name:"appyear",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application Type",name:"apptype",readOnly:!0})),r.a.createElement(i.eb,{caption:"Trade Name",name:"tradename",readOnly:!0}),r.a.createElement(i.eb,{caption:"Owner Name",name:"owner.name",readOnly:!0}),r.a.createElement(i.eb,{caption:"Business Address",name:"businessaddress",readOnly:!0}),r.a.createElement(i.W,null),r.a.createElement("h4",null,"Business Information"),j.infos.map((function(e,t){return r.a.createElement(S,{key:e.name+":"+t,name:"infos["+t+"].value",dataType:e.datatype,caption:e.caption,autoFocus:0===t})})),r.a.createElement(i.W,null),r.a.createElement(i.O,{style:O.lobTitles},r.a.createElement("h4",null,"Line of Businesses"),r.a.createElement("h4",null,"Last Year Gross (Php)")),j.lobs.map((function(e,t){return r.a.createElement(S,{key:e.name+":"+t,name:"lobs["+t+"].gross",dataType:"decimal",caption:e.lob.name,error:u[t],helperText:u[t]})})),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:l}),r.a.createElement(i.e,{caption:"Next",action:function(){(function(){var e=[];return j.lobs.forEach((function(t,n){e.push(t.gross?null:"Gross is required")})),d(e),e.findIndex((function(e){return null!=e}))<0})()&&(f(null),g(!0),t.invoke("saveInfos",{objid:j.objid,step:4,lobs:j.lobs,infos:j.infos},(function(e,t){e?f(e):n(),g(!1)})))},loading:h,disableWhen:h}))))}},{step:4,name:"requirements",caption:"Requirements",component:function(e){var t=e.appService,n=e.moveNextStep,l=e.movePrevStep,o=e.title,s=Object(i.tb)(),m=s[1],p=s[0].app,u=Object(a.useState)(),d=u[0],b=u[1],E=Object(a.useState)(!1),f=E[0],v=E[1],h=Object(a.useState)([]),g=h[0],y=h[1];Object(a.useEffect)((function(){v(!0),t.invoke("getRequirements",p,(function(e,t){e?b(e):(t.forEach((function(e){e.attachment||(e.attachment={})})),m({type:"SET_APP",app:c({},p,{step:4})}),y(t)),v(!1)}))}),[]);var S=function(e){t.invoke("update",{objid:p.objid,requirements:e},(function(e,t){e&&b(e)}))},O=-1==g.findIndex((function(e){return void 0===e.attachment}));return r.a.createElement(i.g,null,r.a.createElement(i.v,{msg:d}),r.a.createElement(i.fb,null,o),r.a.createElement(i.ab,null,"Tracking No. "+p.controlno),r.a.createElement(i.Z,null,"Requirements"),r.a.createElement("h4",null,"Please attach the following documents:"),r.a.createElement(j,{app:p,requirements:g,onUpload:function(e,t){var n=g.findIndex((function(e){return e.objid===t.objid})),a=[].concat(g);a[n].attachment=e,y(a),S(a)},deleteRequirement:function(e){var t=g.findIndex((function(t){return t.objid===e.objid})),n=[].concat(g);n[t].attachment={},y(n),S(n)}}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:l}),r.a.createElement(i.e,{caption:"Next",action:function(){v(!0),t.invoke("update",{objid:p.objid,step:p.step+1},(function(e,t){e?b(e):n(),v(!1)}))},processing:f,disableWhen:!O})))}},{step:5,name:"confirm",caption:"Confirm",component:function(e){var t=e.moveNextStep,n=e.movePrevStep,l=e.appService,c=e.title,o=Object(i.tb)()[0].app,s=Object(a.useState)(),m=s[0],p=s[1],u=(Object(a.useState)(!1),Object(a.useState)(o)),d=u[0],b=u[1],E=Object(a.useState)(!1),f=E[0],v=E[1];return Object(a.useEffect)((function(){l.invoke("getInfos",{objid:d.objid},(function(e,t){e?p(e):b(t)}))}),[]),r.a.createElement(i.g,null,r.a.createElement(i.v,{msg:m}),r.a.createElement(i.w,{context:d,handler:b},r.a.createElement(i.fb,null,c),r.a.createElement(i.ab,null,"Tracking No. ",d.controlno),r.a.createElement(i.Z,null,"Confirmation"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"BIN",name:"bin",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application No.",name:"prevapp.appno",readOnly:!0})),r.a.createElement(i.O,{row:!0},r.a.createElement(i.eb,{caption:"Application Year",name:"prevapp.appyear",readOnly:!0}),r.a.createElement(i.eb,{caption:"Application Type",name:"prevapp.apptype",readOnly:!0})),r.a.createElement(i.eb,{caption:"Trade Name",name:"tradename",readOnly:!0}),r.a.createElement(i.eb,{caption:"Owner Name",name:"owner.name",readOnly:!0}),r.a.createElement(i.eb,{caption:"Business Address",name:"businessaddress",readOnly:!0}),r.a.createElement(i.W,null),d.infos.map((function(e){return r.a.createElement(i.B,{key:e.name,caption:e.caption,captionStyle:{width:300}},e.value)})),r.a.createElement(i.W,null),r.a.createElement(h,{lobs:d.lobs,isPreviousInfo:!1}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:n}),r.a.createElement(i.e,{caption:"Next",action:function(){return v(!0)}}))),r.a.createElement(i.M,{open:f,title:"New Application Confirmation",type:"confirm",onAccept:function(){l.invoke("submit",{objid:d.objid,step:6},(function(e,n){e?(p(e),v(!1)):t()}))},acceptCaption:"Submit Application",onCancel:function(){return v(!1)}},r.a.createElement("p",null,"Verify that all information in your application are correct and then click on Submit Application.")))}},{step:6,name:"completed",caption:"Completed",component:function(e){var t=e.history,n=e.partner,a=e.title,l=Object(i.tb)()[0].app;return r.a.createElement(i.g,null,r.a.createElement(i.O,null,r.a.createElement(i.fb,null,a),r.a.createElement(i.ab,null,"Tracking No. "+l.controlno),r.a.createElement(i.Z,null,"Application Completed"),r.a.createElement(i.W,{height:30}),r.a.createElement("p",null,"Your application has been successfully submitted."),r.a.createElement("p",null,"A notification would be sent on your business email account upon approval of your application for payment."),r.a.createElement("p",null,"Thank you for using this service."),r.a.createElement(i.b,null,r.a.createElement(i.e,{caption:"Return",action:function(){t.replace("/partner/"+n.name+"/services",{partner:n})}}))))}}],A=function(e){var t=e.partner,n=e.service,l=e.location,o=e.history,s=e.initialStep,m=Object(a.useState)(void 0===s?0:s),p=m[0],u=m[1],d=Object(a.useState)({step:0}),f=d[0],v=d[1],h=N[p],g=h.component,y={partner:t,service:n,location:l,history:o,moveNextStep:function(e){"number"==typeof e?u(e):(e=p+1,u((function(e){return e+1}))),v(c({},f,{step:e}))},movePrevStep:function(){0===p?o.goBack():u((function(e){return e-1}))},appService:i.U.lookup(t.id+":OnlineBusinessRenewalService","bpls"),stepCompleted:p<f.step,title:"Business Renewal Application"};return r.a.createElement(i.X,{initialState:b,reducer:E},r.a.createElement(i.N,null,p>1&&p<6&&r.a.createElement(i.O,{target:"left",style:w.stepperContainer},r.a.createElement(i.Y,{steps:N.filter((function(e){return e.step>1})),completedStep:f.step-1,activeStep:p-2,handleStep:function(e){u(e+2)}})),r.a.createElement(i.l,{center:!0},r.a.createElement(i.O,null,r.a.createElement(g,c({page:h},y)))),r.a.createElement(i.W,{height:40})))},w={stepperContainer:{paddingTop:30,paddingLeft:40}},x=function(e,t){switch(t.type){case"SET_APP":return e.app=t.app,void(e.bin=t.app.bin);case"SET_CONTACT":return void(e.contact=t.contact);case"SET_APPLICANT":return void(e.applicant=t.applicant);case"SET_ATTACHMENTS":return void(e.app.attachments=t.attachments);case"SET_LOBS":return void(e.app.lobs=t.lobs);case"SET_INFOS":return void(e.infos=t.infos);case"SET_REQUIREMENTS":return void(e.requirements=t.requirements);default:return e}},B=[{name:"contact",caption:"Contact Information"},{name:"business-name",caption:"New Business Name"},{name:"confirmation",caption:"Confirmation"},{name:"newapp",caption:"New Application "}],k=["MAIN","BRANCH"],T={SING:{type:"dti",title:"DTI Registration",url:"https://bnrs.dti.gov.ph/registration"},CORP:{type:"sec",title:"SEC Registration",url:"https://www.sec.gov.ph/online-services/sec-company-registration-system/"},COOP:{type:"cda",title:"CDA Registration",url:"https://cda.gov.ph/services/regulatory-services/registration/"}},W=function(e){var t=e.partner,n=e.editable,a=void 0===n||n,c=e.visibleWhen,o=e.editableBrgy,s=void 0===o||o,m=e.showBldgName;return void 0===c||c?r.a.createElement(i.O,null,(void 0===m||m)&&r.a.createElement(i.eb,{name:"bldgname",caption:"Building Name",editable:a}),r.a.createElement(i.eb,{name:"unitno",caption:"Unit No.",editable:a}),r.a.createElement(i.eb,{name:"street",caption:"Street",editable:a}),s?r.a.createElement(l.a,{orgcode:t.id,name:"barangay",caption:"Barangay",required:!1}):r.a.createElement(i.eb,{name:"barangay.name",caption:"Barangay",editable:s})):null},P=function(e){var t=e.partner;return r.a.createElement(i.I,{name:e.name,caption:"Market",fetchList:function(e){try{var n=i.U.lookupAsync(t.id+":OnlineBusinessSupportService","bpls");return Promise.resolve(n.invoke("getMarkets",{searchtext:e}))}catch(e){return Promise.reject(e)}},expr:function(e){return e.name},cols:[{name:"name",caption:"Name"},{name:"address",caption:"Address"}]})},C=function(e){var t=e.partner;return r.a.createElement(i.I,{name:e.name,caption:"Lessor",fetchList:function(e){try{var n=i.U.lookupAsync(t.id+":OnlineBusinessSupportService","bpls");return Promise.resolve(n.invoke("getLessors",{searchtext:e}))}catch(e){return Promise.reject(e)}},expr:function(e){return e.name},cols:[{name:"name",caption:"Name"},{name:"bldgname",caption:"Building"},{name:"address",caption:"Address"}]})},I=function(e){return r.a.createElement(i.I,c({fetchList:function(e){try{var t=i.U.lookup("OnlinePsicService","bpls");return Promise.resolve(new Promise((function(n,a){t.invoke("getSubclasses",{searchtext:e},(function(e,t){e?a(e):n(t.lobs)}))})))}catch(e){return Promise.reject(e)}},expr:function(e){return e.code+" - "+e.name},variant:"outlined",cols:[{name:"code",caption:"PSIC No."},{name:"name",caption:"Business Activity",infoField:"description"}]},e))},L={lobContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",border:"1px solid #AAAAAA",paddingLeft:5,borderRadius:3,marginTop:5,marginLeft:2}},q={decimal:i.o,integer:i.y,string:i.eb},R={table:{},category:{fontSize:"0.875rem",fontWeight:600,border:"1px soid #DDDDDD",backgroundColor:"#EEEEEE",padding:5},caption:{width:200,fontSize:"0.85rem",paddingLeft:20},handler:{width:100}},_={SING:"Single Proprietorship",CORP:"Corporation",COOP:"Cooperative"},D={decimal:i.o,integer:i.y,string:i.eb},U=function(e){var t=[];return e.unitno&&t.push(e.unitno),e.bldgname&&t.push(e.bldgname),e.subdivision&&t.push(e.subdivision),e.street&&t.push(e.street),e.barangay.name&&t.push(e.barangay.name),e.citymunicipality&&t.push(e.citymunicipality),t.join(", ")},F={title:{border:"1px solid #AAAAAA",padding:5,backgroundColor:"#EAEAEA",borderRadius:3},category:{fontSize:"0.8rem",fontWeight:600,border:"1px soid #DDDDDD",backgroundColor:"#EEEEEE",padding:5,opacity:.8},caption:{width:200,fontSize:"0.8rem",paddingLeft:20},handler:{width:120},requirement:{fontSize:"0.85rem"}},z=i.U.lookup("OnlineBusinessService","bpls"),Z=[{step:0,name:"select",caption:"Select Application Type",component:function(e){var t=e.service,n=e.history,l=e.appService,c=e.moveNextStep,o=Object(a.useState)(),s=o[0],m=o[1],p=Object(a.useState)("new"),u=p[0],d=p[1],b=Object(a.useState)(),E=b[0],f=b[1],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(i.tb)()[1];return r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t.title),r.a.createElement(i.Z,null,"Select an action"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.S,{value:u,onChange:d},r.a.createElement(i.z,{caption:"Create New Application",value:"new"}),r.a.createElement(i.z,{caption:"Resume Pending Application",value:"resume"})),r.a.createElement(i.eb,{caption:"Application Tracking No.",value:E,onChange:f,visibleWhen:"resume"===u,variant:"outlined",required:!0,style:{marginLeft:40},error:s,helperText:s,size:"small",autoFocus:!0}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return n.goBack()}}),r.a.createElement(i.e,{caption:"Next",action:function(){"new"===u?c():E?(g(!0),l.invoke("findApp",{controlno:E},(function(e,t){e?m(e):(t.infos=[],t.lobs=[],y({type:"SET_APP",app:t}),c(t.step)),g(!1)}))):m("Tracking No. is required.")},loading:h})))}},{step:1,name:"initial",caption:"Initial",component:function(e){var t=e.partner,n=e.history,o=e.title,s=e.appService,m=e.moveNextStep,p=Object(i.tb)(),u=p[1],d=p[0].contact,b=Object(a.useState)(),E=b[0],h=b[1],g=Object(a.useState)(!1),y=g[0],S=g[1],O=Object(a.useState)({officetype:k[0]}),j=O[0],N=O[1],A=Object(a.useState)(0),w=A[1],x=B[A[0]],T=Object(a.useRef)(),W=function(){w((function(e){return e+1}))},P=function(){w((function(e){return e-1}))};return r.a.createElement(r.a.Fragment,null,"contact"===x.name?r.a.createElement(l.b,{partner:t,showName:!0,moveNextStep:W,movePrevStep:P,title:o,subtitle:"Contact Verification",emailRequired:!0}):r.a.createElement("form",{ref:T},r.a.createElement(i.g,null,r.a.createElement(i.W,null),r.a.createElement(i.w,{context:j,handler:N,visibleWhen:"business-name"===x.name},r.a.createElement(i.fb,null,o),r.a.createElement(i.Z,null,x.caption),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:E}),r.a.createElement(i.eb,{caption:"Name of Business",name:"businessname",required:!0,autoFocus:!0}),r.a.createElement(i.k,{caption:"Office Type",items:k,name:"officetype",required:!0}),"BRANCH"===j.officetype&&r.a.createElement(i.eb,{caption:"Branch Name",name:"branch",required:!0}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return n.goBack()}}),r.a.createElement(i.e,{caption:"Next",action:function(){if(T.current.reportValidity()){h(null),S(!0);var e=c({},j,{orgcode:t.id,partner:t,contact:d});s.invoke("validateInitialInfo",e,(function(e,t){e?h(e):(N(t),W()),S(!1)}))}},loading:y}))),r.a.createElement(i.O,{visibleWhen:"confirmation"===x.name},r.a.createElement(i.fb,null,o),r.a.createElement(f,{title:o,partner:t,error:E,onCancel:P,onContinue:function(){S(!0),s.invoke("create",c({},j,{apptype:"NEW",orgcode:t.id}),(function(e,t){e?h(e):(t.redflags=[],u({type:"SET_APP",app:t}),N(t),W()),S(!1)}))},cancelCaption:"Back"})),r.a.createElement(i.O,{visibleWhen:"newapp"===x.name,width:400},r.a.createElement(i.fb,null,o),r.a.createElement(v,{appno:j.controlno,onContinue:m})))))}},{step:2,name:"registration",caption:"Business Name Registration",component:function(e){var t=e.history,n=e.title,l=e.appService,o=e.moveNextStep,s=e.page,m=Object(i.tb)(),p=m[0],u=m[1],d=Object(a.useState)(c({},p.app)),b=d[0],E=d[1],f=Object(a.useState)(""),v=f[0],h=f[1],g=Object(a.useState)(!1),y=g[0],S=g[1],O=Object(a.useState)(b.orgtype?"business-name":"orgtype"),j=O[0],N=O[1],A=Object(a.useState)([]),w=A[0],x=A[1],B=Object(a.useState)([]),k=B[0],W=B[1],P=T[b.orgtype]||T.SING;return Object(a.useEffect)((function(){b.attachments&&b.attachments.length>0&&(x(b.attachments.filter((function(e){return e.type===P.type}))),W(b.attachments.filter((function(e){return"incentive"===e.type}))))}),[b]),r.a.createElement(i.g,null,r.a.createElement(i.fb,null,n),r.a.createElement("label",null,"Tracking No. "+b.controlno),r.a.createElement(i.w,{context:b,handler:E},r.a.createElement(i.Z,null,"Business Name Registration"),r.a.createElement(i.v,{msg:v}),r.a.createElement(i.O,{visibleWhen:"orgtype"===j},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Select Type of Business"),r.a.createElement(i.S,{name:"orgtype"},r.a.createElement(i.z,{caption:"Single Proprietorship",value:"SING"}),r.a.createElement(i.z,{caption:"Corporation/Partnership",value:"CORP"}),r.a.createElement(i.z,{caption:"Cooperative",value:"COOP"})),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Cancel",action:function(){return t.goBack()}}),r.a.createElement(i.e,{caption:"Next",action:function(){return N("business-name")},loading:y}))),r.a.createElement(i.O,{visibleWhen:"business-name"===j},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Business Name"),r.a.createElement(i.W,{height:10}),r.a.createElement(i.eb,{name:"tradename",caption:"Business Name as it appears in your "+P.title,required:!0,autoFocus:!0}),r.a.createElement(i.B,null,"If you have not yet applied for business name registration ",r.a.createElement("a",{href:""+P.url,target:"_blank"},"click here.")),r.a.createElement(i.bb,null,P.title),r.a.createElement(i.eb,{name:"registration.refno",caption:P.title+" No.",required:!0}),r.a.createElement(i.n,{name:"registration.dtissued",caption:"Date Issued",required:!0}),r.a.createElement(i.W,null),r.a.createElement(i.B,null,"Attach "+P.title+" documents here."),r.a.createElement(i.c,{type:P.type,filePrefix:"BPLS/"+P.title+"/"+b.objid,onUpload:x,attachments:w}),r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Business Incentives"),r.a.createElement(i.B,null,"If you have business incentives, attach documents here."),r.a.createElement(i.c,{type:"incentive",filePrefix:"BPLS/incentive/"+b.objid,onUpload:W,attachments:k}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:function(){return N("orgtype")}}),r.a.createElement(i.e,{caption:"Next",action:function(){if(h(null),0!==w.length){S(!0);var e=c({},p.applicant);e.entitytype="SING"===b.orgtype?"INDIVIDUAL":"JURIDICAL";var t={objid:b.objid,step:b.step<=s.step?s.step+1:b.step,businessname:b.businessname,tradename:b.tradename,registration:c({},b.registration,{reftype:P.title}),attachments:[].concat(w,k),orgtype:b.orgtype};l.invoke("update",t,(function(t,n){t?h(t):(u({type:"SET_APP",app:b}),u({type:"SET_APPLICANT",applicant:e}),o()),S(!1)}))}else h(P.title+" documents must be attached.")},loading:y})))),r.a.createElement("div",{style:{minWidth:500}}))}},{step:3,name:"applicant",caption:"Applicant Details",component:function(e){var t=e.title,n=e.partner,o=e.page,s=e.appService,m=e.moveNextStep,p=e.movePrevStep,u=Object(i.tb)()[0],d=u.app,b=u.applicant,E=Object(a.useState)(!0)[1],f=Object(a.useState)(!1)[0],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(a.useState)("read")[1],S=Object(a.useState)(!1),O=S[0],j=S[1],N=Object(a.useState)(c({},b)),A=N[0],w=N[1],x=Object(a.useRef)();return Object(a.useEffect)((function(){g(null),s.invoke("getApplicant",{objid:d.objid},(function(e,t){e?g(e):(y(t.isnew?"create":"read"),w(t)),E(!1)}))}),[]),r.a.createElement("form",{ref:x},r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement("label",null,"Tracking No. "+d.controlno),r.a.createElement(i.Z,null,"Applicant Details"),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:h}),r.a.createElement(i.w,{context:A,handler:w},r.a.createElement(i.eb,{name:"entitytype",caption:"Type of Applicant",editable:!1}),r.a.createElement(i.eb,{caption:"Name",name:"name",visibleWhen:"INDIVIDUAL"!==A.entitytype}),r.a.createElement(i.W,null),r.a.createElement(i.O,null,r.a.createElement(i.ab,null,"Administrator or contact name of applicant"),r.a.createElement(i.eb,{caption:"Last Name",name:"lastname",required:!0}),r.a.createElement(i.eb,{caption:"First Name",name:"firstname",required:!0}),r.a.createElement(i.eb,{caption:"Middle Name",name:"middlename",required:!0}),r.a.createElement(i.u,{name:"email",required:!0}),r.a.createElement(i.K,{name:"mobileno"})),r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Applicant Address"),r.a.createElement(i.j,{caption:"Resident",name:"resident",onChange:function(){var e=c({},A,{appid:d.objid,resident:!A.resident,address:{}});w(e)}}),A.resident?r.a.createElement(l.i,{orgcode:n.id,name:"address",caption:"Address"}):r.a.createElement(l.j,{name:"address",caption:"Address"}),r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Proof of Identity"),r.a.createElement(l.h,{name:"id",onError:function(e){j(e)},dtIssued:A.id?A.id.dtissued:null})),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:p}),r.a.createElement(i.e,{caption:"Next",action:function(){!O&&x.current.reportValidity()&&(g(null),s.invoke("saveApplicant",c({},A,{_step:o.step+1}),(function(e,t){e?g(e):m(),E(!1)})))},loading:f}))))}},{step:4,name:"location",caption:"Business Location",component:function(e){var t=e.title,n=e.page,l=e.appService,o=e.moveNextStep,s=e.movePrevStep,m=e.partner,p=Object(i.tb)(),u=p[1],d=p[0].app,b=Object(a.useRef)(),E=Object(a.useState)(!0)[1],f=Object(a.useState)(!1)[0],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(a.useState)("location"),S=y[0],O=y[1],j=Object(a.useState)({}),N=j[0],A=j[1],w=Object(a.useState)(),x=w[0],B=w[1],k=Object(a.useState)([]),T=k[0],I=k[1];Object(a.useEffect)((function(){d.attachments&&d.attachments.length>0&&I(d.attachments.filter((function(e){return"leasecontract"===e.type})))}),[d]),Object(a.useEffect)((function(){g(null),l.invoke("getLocation",{objid:d.objid},(function(e,t){e?g(e):(A(t),O(L(t.type))),E(!1)}))}),[]);var L=function(e){return e?"location-"+e.toLowerCase():"location"},q=function(){B(N.type),O("location")},R=function(){if(!/rented/i.test(N.type)||T&&0!==T.length){if(b.current.reportValidity()){g(null);var e=[].concat(d.attachments.filter((function(e){return"leasecontract"!==e.type})),T);l.invoke("saveLocation",c({},N,{appid:d.objid,attachments:e,_step:d.step<=n.step?n.step+1:d.step}),(function(t,n){t?g(t):(u({type:"SET_ATTACHMENTS",attachments:e}),o()),E(!1)}))}}else g("Lease contract documents must be attached.")},_=function(e){try{var t=i.U.lookupAsync(m.id+":OnlineBusinessSupportService","bpls");return Promise.resolve(t.invoke("getFaas",{tdno:e}))}catch(e){return Promise.reject(e)}},D=function(e){A(c({},N,{td:e,barangay:e?e.barangay:{}}))},U=!N.td||!N.td.objid,F=!(!N.lessor||!N.lessor.objid);return r.a.createElement("form",{ref:b},r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement("label",null,"Tracking No. "+d.controlno),r.a.createElement(i.Z,null,"Business Location"),r.a.createElement(i.v,{msg:h}),r.a.createElement(i.w,{context:N,handler:A,width:500},r.a.createElement(i.O,{visibleWhen:"location"===S},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Select type of location"),r.a.createElement(i.S,{name:"type"},r.a.createElement(i.z,{caption:"Location is rented",value:"rented"}),r.a.createElement(i.z,{caption:"Location is owned",value:"local"}),r.a.createElement(i.z,{caption:"Located in a government property",value:"government"}),r.a.createElement(i.z,{caption:"Located in LGU operated market",value:"market"})),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:s}),r.a.createElement(i.e,{caption:"Next",action:function(){var e=N.type;O(L(e)),e!==x&&A({type:e})},disableWhen:!N.type}))),r.a.createElement(i.O,{visibleWhen:"location-rented"===S,width:500},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Location is Leased"),r.a.createElement(i.B,null,"Select a lessor. If a lessor does not exist, just leave it blank but make sure to attach the lease contract."),r.a.createElement(i.W,{height:10}),r.a.createElement(C,{partner:m,name:"lessor"}),!F&&r.a.createElement(i.eb,{name:"lessor.name",caption:"Lessor",required:!0}),r.a.createElement(i.eb,{name:"lessor.address",caption:"Address",required:!0,editable:!F}),r.a.createElement(i.W,null),r.a.createElement(i.eb,{name:"lessor.bldgname",caption:"Building Name",editable:!F}),r.a.createElement(i.eb,{name:"lessor.unitno",caption:"Unit No."}),r.a.createElement(i.eb,{name:"lessor.location",caption:"Location Details"}),r.a.createElement(i.o,{name:"lessor.rent",caption:"Rental Rate",required:!0,textAlign:"left"}),r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Lease Contract Documents"),r.a.createElement(i.B,null,"Kindly attach the lease contract documents from your Lessor."),r.a.createElement(i.c,{type:"leasecontract",filePrefix:"BPLS/leasecontract/"+d.objid,onUpload:function(e){I(e)},attachments:T}),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:q}),r.a.createElement(i.e,{caption:"Next",action:R,loading:f}))),r.a.createElement(i.O,{visibleWhen:"location-local"===S,width:500},r.a.createElement(i.ab,null,"Location is owned"),r.a.createElement(i.W,null),r.a.createElement(i.B,null,"Please search the Tax Declaration No. of your property"),r.a.createElement(i.V,{name:"td",expr:function(e){return e.tdno},caption:"TD No.",fetchData:_,onSelect:D}),r.a.createElement(W,{partner:m,editableBrgy:U}),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:q}),r.a.createElement(i.e,{caption:"Next",action:R,loading:f}))),r.a.createElement(i.O,{visibleWhen:"location-government"===S},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Location is Government Owned"),r.a.createElement(i.B,null,"Please enter the Tax Declaration No. of the property"),r.a.createElement(i.V,{name:"td",expr:function(e){return e.tdno},caption:"TD No.",fetchData:_,onSelect:D}),r.a.createElement(W,{partner:m,editableBrgy:U}),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:q}),r.a.createElement(i.e,{caption:"Next",action:R,loading:f}))),r.a.createElement(i.O,{visibleWhen:"location-market"===S},r.a.createElement(i.W,null),r.a.createElement(i.ab,null,"Location is LGU operated Market"),r.a.createElement(i.B,null,"Select Market Account"),r.a.createElement(P,{partner:m,name:"market"}),r.a.createElement(W,{partner:m,editableBrgy:U,showBldgName:!1}),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:q}),r.a.createElement(i.e,{caption:"Next",action:R,loading:f})))),r.a.createElement("div",{style:{minWidth:500}})))}},{step:5,name:"lob",caption:"Line of Business",component:function(e){var t=e.title,n=e.partner,l=e.page,o=e.appService,s=e.moveNextStep,m=e.movePrevStep,p=Object(i.tb)(),u=p[1],d=p[0].app,b=Object(a.useState)(!0)[1],E=Object(a.useState)(!1)[0],f=Object(a.useState)(),v=f[0],h=f[1],g=Object(a.useState)(),y=g[0],S=g[1],O=Object(a.useState)(!1),j=O[0],N=O[1],A=Object(a.useState)({}),w=A[0],x=A[1],B=Object(a.useState)([]),k=B[0],T=B[1],W=Object(a.useState)(""),P=W[0],C=W[1];return Object(a.useEffect)((function(){h(null),o.invoke("getLobs",{objid:d.objid},(function(e,t){e?h(e):u({type:"SET_LOBS",lobs:t}),b(!1)}))}),[]),Object(a.useEffect)((function(){var e=d.lobs.find((function(e){return!0===e.dominant}));e||(e={}),x(e),T(d.lobs.filter((function(e){return!0!==e.dominant})))}),[d.lobs]),r.a.createElement(r.a.Fragment,null,r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement("label",null,"Tracking No. "+d.controlno),r.a.createElement(i.Z,null,"Line of Business"),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:v}),r.a.createElement(i.O,{minWidth:400},r.a.createElement(i.bb,null,"Select dominant business activity that you want to apply permit for."),r.a.createElement(i.W,{height:10}),r.a.createElement(I,{partner:n,value:w,onChange:x,caption:"Dominant Business Activity",validate:function(e){if(k.findIndex((function(t){return t.objid===e.objid}))>=0)throw"Selected line of business has already been added to other business activity"}}),r.a.createElement(i.W,{height:10}),r.a.createElement(i.eb,{name:"dominantInfo",value:P,onChange:C,caption:"Business Activity Additional Description",multiline:!0,rows:4,variant:"outlined"}),r.a.createElement(i.W,{height:10}),r.a.createElement(i.bb,null,"Other lines of business you also want to apply for permits."),k&&k.map((function(e,t){return r.a.createElement(i.O,{key:e.objid+t,row:!0,style:L.lobContainer},r.a.createElement(i.B,null,e.code+" - "+e.name),r.a.createElement(i.q,{action:function(){return t=e,n=k.filter((function(e){return e.objid!==t.objid})),T(n),void u({type:"SET_LOBS",lobs:[w].concat(n)});var t,n}}))})),r.a.createElement(i.W,{height:5}),r.a.createElement(i.O,{row:!0},r.a.createElement(i.e,{caption:"Add another business activity",action:function(){return N(!0)},variant:"outlined"}))),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:m}),r.a.createElement(i.e,{caption:"Next",action:function(){if(h(null),w){var e=k.map((function(e){return c({},e,{dominant:!1,assessmenttype:"NEW"})})),t=[c({},w,{dominant:!0,assessmenttype:"NEW"})].concat(e);o.invoke("update",{objid:d.objid,lobs:t,step:d.step<=l.step?l.step+1:d.step,dominantlobinfo:P},(function(e,n){e?h(e):(s(),u({type:"SET_LOBS",lobs:t})),b(!1)}))}else h("Dominant business activity must be specified.")},loading:E})),r.a.createElement("div",{style:{minWidth:500}})),r.a.createElement(i.A,{caption:"Line of Business Lookup",partner:n,fetchList:function(e){try{var t=i.U.lookup("OnlinePsicService","bpls");return Promise.resolve(new Promise((function(n,a){t.invoke("getSubclasses",{searchtext:e},(function(e,t){e?a(e):n(t)}))})))}catch(e){return Promise.reject(e)}},open:j,validate:function(e){if(e.objid===w.objid)throw"Selected line of business should not be the same as Dominant Business Activity"},onAccept:function(e){return h(null),S(null),w.objid===e.objid?(S("Selected Line of business must not be equal to dominant business activity."),!1):(N(!1),-1===k.findIndex((function(t){return t.objid===e.objid}))&&T([].concat(k,[e])),!0)},onCancel:function(){return N(!1)},error:y,cols:[{name:"name",caption:"Name"},{name:"classification.name",caption:"Classification"}]}))}},{step:6,name:"detail",caption:"Business Details",component:function(e){var t=e.title,n=e.page,l=e.appService,c=e.moveNextStep,o=e.movePrevStep,s=Object(i.tb)(),m=s[1],p=s[0].app,u=Object(a.useState)(!0)[1],d=Object(a.useState)(!1),b=d[0],E=d[1],f=Object(a.useState)(),v=f[0],h=f[1],g=Object(a.useState)({infos:p.infos?p.infos:[]}),y=g[0],S=g[1];Object(a.useEffect)((function(){y.infos&&y.infos.length>0||(h(null),E(!0),l.invoke("getAppInfos",{assessmenttype:"new",lobs:p.lobs},(function(e,t){e?h(e):S({infos:t}),u(!1),E(!1)})))}),[]);var O=null,j=null;return r.a.createElement("form",null,r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement("label",null,"Tracking No. "+p.controlno),r.a.createElement(i.Z,null,"Business Details"),r.a.createElement(i.v,{msg:v}),r.a.createElement(i.W,null),r.a.createElement(i.w,{context:y,handler:S,width:500},r.a.createElement(i.ab,null,"Main Business Info"),r.a.createElement(i.W,{height:10}),r.a.createElement("table",{style:R.table},y.infos.map((function(e,t){var n=null;O!==(j=e.lob?e.lob.name:e.category)&&(n=r.a.createElement("tr",null,r.a.createElement("td",{colspan:"2",style:R.category},j)),O=j);var a=q[e.datatype];return r.a.createElement(r.a.Fragment,null,n,r.a.createElement("tr",null,r.a.createElement("td",{style:R.caption},e.caption),r.a.createElement("td",{style:R.handler},r.a.createElement(a,{name:"infos["+t+"].value",variant:"outlined",size:"small"}))))})))),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:o}),r.a.createElement(i.e,{caption:"Next",action:function(){h(null),E(!0),l.invoke("update",{objid:p.objid,infos:y.infos,step:p.step<=n.step?n.step+1:p.step},(function(e,t){e?h(e):(m({type:"SET_INFOS",infos:y.infos}),c()),u(!1),E(!1)}))},processing:b}))))}},{step:7,name:"requirements",caption:"Requirements",component:function(e){var t=e.title,n=e.partner,l=e.page,o=e.appService,s=e.moveNextStep,m=e.movePrevStep,p=Object(i.tb)(),u=p[1],d=p[0].app,b=Object(a.useState)(!0)[1],E=Object(a.useState)(!1),f=E[0],v=E[1],h=Object(a.useState)(),g=h[0],y=h[1],S=Object(a.useState)(d.requirements),O=S[0],j=S[1];return Object(a.useEffect)((function(){d.requirements&&d.requirements.length>0||(y(null),v(!0),i.U.lookup(n.id+":OnlineBusinessApplicationService","bpls").invoke("assessRequirements",d,(function(e,t){e?y(e):t&&t.length>0&&(t.forEach((function(e){return e.attachments=[]})),j(t),u({type:"SET_REQUIREMENTS",requirements:t})),b(!1),v(!1)})))}),[]),r.a.createElement("form",null,r.a.createElement(i.g,null,r.a.createElement(i.fb,null,t),r.a.createElement("label",null,"Tracking No. "+d.controlno),r.a.createElement(i.Z,null,"Business Requirements"),r.a.createElement(i.v,{msg:g}),r.a.createElement(i.W,null),r.a.createElement(i.w,{context:O,handler:j,width:500},r.a.createElement(i.bb,null,O.length>0?"Kindly attach an image for each of the requirements listed.":"There are no requirements needed for this application."),r.a.createElement(i.W,{height:10}),r.a.createElement(i.a,{keyId:"reftype",captionExpr:"title",items:O,toolTipCollapsed:"Show attachments",toolTipExpanded:"Hide attachments"},(function(e){return r.a.createElement(i.c,{type:e.reftype,filePrefix:"BPLS/"+e.reftype+"/"+d.objid,onUpload:function(t){return function(e,t){e.attachments=t;var n=O.map((function(n){return n.reftype===e.reftype?c({},e,{attachments:t}):n}));j(n)}(e,t)},attachments:e.attachments,imageWidth:150})}))),r.a.createElement(i.b,null,r.a.createElement(i.d,{action:m}),r.a.createElement(i.e,{caption:"Next",action:function(){y(null),v(!0),o.invoke("update",{objid:d.objid,step:d.step<=l.step?l.step+1:d.step,requirements:O},(function(e,t){e?y(e):(s(),u({type:"SET_REQUIREMENTS",requirements:O})),b(!1),v(!1)}))},processing:f}))))}},{step:8,name:"confirm",caption:"Confirm Application",component:function(e){var t,n,l=e.title,c=e.page,o=e.moveNextStep,s=e.movePrevStep,m=e.appService,p=Object(i.tb)(),u=p[1],d=p[0].app,b=Object(a.useState)(),E=b[0],f=b[1],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(a.useState)(!1),S=y[1],O=null,j=null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.M,{title:"Submit Application",open:y[0],onAccept:function(){f(null),g(!0),S(!1),m.invoke("submit",{objid:d.objid,step:d.step<=c.step?c.step+1:d.step},(function(e,t){e?f(e):(o(),u({type:"SET_APP",app:t})),g(!1)}))},onCancel:function(){return S(!1)},type:"confirm"},r.a.createElement("p",null,"Application processing will now be completed. Make sure that all information are correct."),r.a.createElement("p",null,"Submit?")),r.a.createElement(i.g,null,r.a.createElement(i.O,null,r.a.createElement(i.fb,null,l),r.a.createElement(i.ab,null,"Tracking No. ",d.controlno),r.a.createElement(i.Z,null,"Confirmation"),r.a.createElement(i.W,null),r.a.createElement(i.v,{msg:E}),r.a.createElement(i.B,null,"Kindly verify the application before submitting."),r.a.createElement(i.W,{height:10}),r.a.createElement("div",{style:F.title},r.a.createElement(i.bb,null,"Business Information")),r.a.createElement(i.W,{height:10}),r.a.createElement(i.eb,{caption:"Business Name",value:d.businessname,editable:!1}),r.a.createElement(i.eb,{caption:"Trade Name",value:d.tradename,editable:!1}),r.a.createElement(i.eb,{caption:"Business Address",value:(t=d.location,n=[],"MARKET"===t.type?(n.push(t.market.name),n.push(t.market.address)):"LESSOR"==t.type&&(t.lessor.name&&n.push(t.lessor.name),t.lessor.bldgname&&n.push(bldgname.lessor.address),t.lessor.address&&n.push(t.lessor.address)),n.join(", ")),editable:!1}),r.a.createElement(i.eb,{caption:"Application Type",value:d.apptype,editable:!1}),r.a.createElement(i.eb,{caption:"Year Applied",value:d.appyear,editable:!1}),r.a.createElement(i.eb,{caption:"Office Type",value:d.officetype,editable:!1}),r.a.createElement(i.eb,{caption:"Organization Type",value:_[d.orgtype],editable:!1}),r.a.createElement(i.W,null),r.a.createElement("div",{style:F.title},r.a.createElement(i.bb,null,"Applicant Information")),r.a.createElement(i.W,{height:10}),r.a.createElement(i.eb,{caption:"Last Name",value:d.applicant.lastname,editable:!1}),r.a.createElement(i.eb,{caption:"First Name",value:d.applicant.firstname,editable:!1}),r.a.createElement(i.eb,{caption:"Middle Name",value:d.applicant.middlename,editable:!1}),r.a.createElement(i.eb,{caption:"Address",value:U(d.applicant.address),editable:!1}),r.a.createElement(i.W,null),r.a.createElement("div",{style:F.title},r.a.createElement(i.bb,null,"Business Activities Applied")),r.a.createElement(i.W,{height:10}),r.a.createElement(i.cb,{items:d.lobs,size:"small",showPagination:!1},r.a.createElement(i.db,{expr:function(e){return e.code+" - "+e.name}})),r.a.createElement(i.W,null),r.a.createElement("div",{style:F.title},r.a.createElement(i.bb,null,"Application Informations")),r.a.createElement(i.W,{height:10}),r.a.createElement("table",{style:F.table},d.infos.map((function(e,t){var n=null;O!==(j=e.lob?e.lob.name:e.category)&&(n=r.a.createElement("tr",{key:""+j+t},r.a.createElement("td",{colspan:"2",style:F.category},j)),O=j);var a=D[e.datatype];return r.a.createElement(r.a.Fragment,null,n,r.a.createElement("tr",{key:""+j+t},r.a.createElement("td",{style:F.caption},e.caption),r.a.createElement("td",{style:F.handler},r.a.createElement(a,{value:e.value,variant:"outlined",size:"small",editable:!1}))))}))),r.a.createElement(i.W,null),r.a.createElement("div",{style:F.title},r.a.createElement(i.bb,null,"List of Requirements")),r.a.createElement(i.W,{height:10}),r.a.createElement(i.a,{keyId:"reftype",captionExpr:"title",items:d.requirements,toolTipCollapsed:"Show attachments",toolTipExpanded:"Hide attachments"},(function(e){return r.a.createElement(i.c,{type:e.reftype,filePrefix:"BPLS/"+e.reftype+"/"+d.objid,onUpload:function(t){return onUploadAttachments(e,t)},attachments:e.attachments,imageWidth:150,readOnly:!0})})),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:s}),r.a.createElement(i.e,{caption:"Next",action:function(){return S(!0)},disableWhen:h,processing:h})))))}},{step:9,name:"unifiedform",caption:"Application Form",component:function(e){var t=e.partner,n=e.title,l=e.appService,o=e.moveNextStep,s=e.movePrevStep,m=e.page,p=Object(i.tb)(),u=p[1],d=p[0].app,b=Object(a.useState)(),E=b[0],f=b[1],v=Object(a.useState)(!1),h=v[0],g=v[1],y=Object(a.useState)([]),S=y[0],O=y[1];Object(a.useEffect)((function(){d.attachments&&d.attachments.length>0&&O(d.attachments.filter((function(e){return"uaf"===e.type})))}),[d]);var j=function(e){return void 0===e&&(e=[]),d.attachments.filter((function(e){return"uaf"!==e.type})).concat(e.length>0?e:S)};return r.a.createElement(i.g,null,r.a.createElement(i.fb,null,n),r.a.createElement("label",null,"Tracking No. "+d.controlno),r.a.createElement(i.O,null,r.a.createElement(i.Z,null,"Unified Application Form"),r.a.createElement(i.v,{msg:E}),r.a.createElement(i.W,null),r.a.createElement("p",null,"To complete and submit the application, kindly perform the following steps."),r.a.createElement("p",null,"1. Download and print the Unified Application Form. Review the application carefully and amend any wrong information. If everything is correct, affix your signature on the form."),r.a.createElement(i.O,{row:!0},r.a.createElement(i.R,{href:"/jreports/partner/"+t.group.name+"_"+t.name+"/bpls/unified_application_form?refid="+d.objid}),r.a.createElement(i.r,{href:"/jreports/download/partner/"+t.group.name+"_"+t.name+"/bpls/unified_application_form?refid="+d.objid})),r.a.createElement("p",null,"2. Scan the signed Unified Application Form and attached it on the drag and drop box below."),r.a.createElement(i.c,{type:"uaf",filePrefix:"BPLS/uaf/"+d.objid,onUpload:function(e){O(e)},attachments:S,imageWidth:150}),r.a.createElement(i.b,null,r.a.createElement(i.d,{caption:"Back",action:s}),r.a.createElement(i.e,{caption:"Submit",action:function(){0!==S.length?(f(null),g(!0),i.U.lookup(t.id+":OnlineBusinessApplicationService","bpls").invoke("createNewApp",c({},d,{partner:t}),(function(e,t){e?(f(e.toString()),g(!1)):function(){var e={objid:d.objid,step:m.step+1,attachments:j(),orgtype:d.orgtype};l.invoke("update",e,(function(t,n){t?(f(t),g(!1)):(u({type:"SET_ATTACHMENTS",attachments:e.attachments}),o())}))}()}))):f("Kindly attach the signed Unified Application Form.")},loading:h}))))}},{step:10,name:"completed",caption:"Completed",component:function(e){var t=e.history,n=e.partner,l=e.title,c=e.appService,o=Object(i.tb)()[0],s=Object(a.useState)(!0),m=s[0],p=s[1],u=Object(a.useState)(),d=u[0],b=u[1],E=Object(a.useState)({}),f=E[0],v=E[1];return Object(a.useEffect)((function(){c.invoke("findApp",{objid:o.app.objid},(function(e,t){e?b(e.toString()):v(t),p(!1)}))}),[]),m?null:r.a.createElement(i.g,null,r.a.createElement(i.O,null,r.a.createElement(i.fb,null,l),r.a.createElement(i.ab,null,"Tracking No. "+f.controlno),r.a.createElement(i.Z,null,"Application Completed"),r.a.createElement(i.W,{height:30}),r.a.createElement(i.v,{msg:d}),r.a.createElement("p",null,"Your application has been successfully submitted."),r.a.createElement("p",null,"A notification would be sent on your business email account upon approval of your application for payment."),r.a.createElement("p",null,"Thank you for using this service."),r.a.createElement(i.b,null,r.a.createElement(i.e,{caption:"Return",action:function(){t.replace("/partner/"+n.name+"/services",{partner:n})}}))))}}],M=function(e){var t=e.partner,n=e.service,l=e.location,o=e.history,s=e.initialStep,m=void 0===s?0:s,p=Object(a.useState)(m),u=p[0],d=p[1],b=Object(a.useState)(m),E=b[0],f=b[1],v=Object(a.useState)({step:0}),h=v[0],g=v[1],y=Object(a.useState)(),S=y[0],O=y[1],j=Object(a.useState)(!0),N=j[0],A=j[1],w=Object(a.useState)(c({},x.initialState)),B=w[0],k=w[1],T=Object(a.useState)(!1),W=T[0],P=T[1];S!==l.hash&&O(l.hash),Object(a.useEffect)((function(){var e=Object(i.mb)(l,"refid");e&&S&&!W?z.invoke("findApp",{objid:e},(function(e,t){if(!e&&t)if("completed"!==Z.find((function(e){return e.step===t.step})).name){var n=Z.find((function(e){return e.name===S.substring(1)}));n&&n.step<=t.step&&d(n.step)}else d(t.step);k(c({},B,{app:t})),A(!1),E<t.step&&f(t.step),P(!0)})):A(!1)}),[S]);var C=function(e){l.hash="#"+Z[e].name,o.push(l)};if(N)return null;var I=Z[u],L=I.component,q={partner:t,service:n,location:l,history:o,page:I,moveNextStep:function(e){"number"==typeof e?d(e):e=u+1,g(c({},h,{step:e})),E<e?(f(e),d((function(e){return e+1}))):d(E),C(e)},movePrevStep:function(){if(0===u)o.goBack();else{var e=u-1;d(e),C(e)}},appService:z,stepCompleted:u<h.step,title:"New Business Application"};return r.a.createElement(i.X,{initialState:B,reducer:x},r.a.createElement(i.N,null,u>1&&"completed"!==I.name&&r.a.createElement(i.O,{target:"left",style:V.stepperContainer},r.a.createElement(i.Y,{steps:Z.filter((function(e){return e.step>1})),completedStep:E-1,activeStep:u-2,handleStep:function(e){var t=e+2;d(t),C(t)}})),r.a.createElement(i.l,{center:!0},r.a.createElement(i.O,null,r.a.createElement(L,c({page:I},q))),r.a.createElement(i.W,{height:50}))))},V={stepperContainer:{paddingLeft:40,paddingBottom:50}}}}]);