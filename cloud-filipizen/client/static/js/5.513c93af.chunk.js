(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[5],{537:function(e,t,n){"use strict";n.r(t),n.d(t,"RealtyTaxClearanceWebController",(function(){return T})),n.d(t,"RptBillingWebController",(function(){return x}));var a=n(0),r=n.n(a),l=n(2);n(86);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var c=function(e){var t=e.partner,n=e.onVerify,o=e.onCancel,c=e.connection,i=void 0===c?"epayment":c,m=e.visibleWhen,u=e.history,s=e.showName,p=void 0!==s&&s,d=e.module,y=e.title,b=e.subtitle,f=void 0===b?"Email Verification":b,E=e.emailRequired,v=e.contact;if(void 0!==m&&!m)return null;var O=Object(a.useState)(),h=O[0],S=O[1],g=Object(a.useState)(v),x=g[0],j=g[1],P=Object(a.useState)({})[0],C=Object(a.useState)(),w=C[0],T=C[1],k=Object(a.useState)(),I=k[0],N=k[1],A=Object(a.useState)(!1),V=A[0],B=A[1],W=Object(a.useState)(!1),R=W[0],q=W[1],D=function(){try{var e=l.N.lookupAsync(t.id+":VerifyEmailService",i);return Promise.resolve(e.invoke("verifyEmail",{email:x.email,mobileno:x.mobileno}))}catch(e){return Promise.reject(e)}},F=Object(a.useRef)(),L=d&&d.title||y||null;return r.a.createElement(l.e,null,L&&r.a.createElement(l.W,null,L),r.a.createElement(l.R,null,f),r.a.createElement(l.O,null),r.a.createElement(l.r,{msg:I}),r.a.createElement(l.s,{visibleWhen:!h,context:x,handler:j},r.a.createElement("form",{ref:F},!0===p&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.V,{label:"Full Name",name:"name",autoFocus:!0,required:!0}),r.a.createElement(l.V,{label:"Address",name:"address",required:!0})),r.a.createElement(l.q,{name:"email",required:E,error:P.email,helperText:P.email,autoFocus:!p}),r.a.createElement(l.E,{name:"mobileno"}),r.a.createElement(l.a,{disabled:V},r.a.createElement(l.b,{action:function(){"function"==typeof o&&o(),u&&u.goBack()}}),r.a.createElement(l.d,{label:"Submit",action:function(){F.current.reportValidity()&&(x.email||x.mobileno?(N(null),B(!0),D().then((function(e){S(e.key),B(!1)})).catch((function(e){N(e),B(!1)}))):N("Please specify email or Mobile No."))},loading:V})))),r.a.createElement(l.G,{open:R,title:"Email Verification",msg:"Resend verification code?",onAccept:function(){N(null),D().then((function(e){S(e.key),q(!1)})).catch((function(e){N(e),q(!1)}))},onCancel:function(){return q(!1)}}),r.a.createElement(l.I,{visibleWhen:!!h},r.a.createElement(l.V,{label:"Email Code",placeholder:"Enter code sent to your email",name:"keycode",value:w,onChange:T,maxLength:6,autoFocus:!0}),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},r.a.createElement(l.d,{label:"Resend Code",action:function(){return q(!0)},variant:"text"})),r.a.createElement(l.a,null,r.a.createElement(l.d,{label:"Verify",visibleWhen:h,action:function(){h!==w?N("Code is incorrect"):n(x)}}))))},i=function(e){var t,n=e.partner,o=e.moveNextStep,i=e.movePrevStep,m=e.title,u=e.subtitle,s=void 0===u?"Email Verification":u,p=e.visibleWhen,d=e.emailRequired,y=void 0!==d&&d,b=e.showName,f=void 0!==b&&b,E=e.contact,v=void 0===E?{}:E;if(void 0!==p&&!p)return null;var O=Object(l.hb)()[1];return Object(a.useState)(!1),Object(a.useState)(!1),r.a.createElement(c,((t={emailRequired:!1,partner:n,title:m,subtitle:s,onVerify:function(e){O({type:"SET_CONTACT",contact:e}),o(e)},onCancel:i}).emailRequired=y,t.contact=v,t.showName=f,t))},m=function(e){var t=e.onCancel,n=e.onSubmit,c=e.bill,i=e.loading,m=e.error,s=Object(a.useState)({}),p=s[0],d=s[1],y=Object(a.useState)({}),b=y[0],f=y[1],E=Object(a.useState)(!1),v=E[0],O=E[1];return Object(a.useEffect)((function(){O(null!=m)}),[m]),r.a.createElement(l.e,null,r.a.createElement(l.I,{style:{maxWidth:400}},r.a.createElement(l.j,{center:!0},r.a.createElement(l.W,null,"Confirm Transaction"),r.a.createElement(l.O,null),r.a.createElement(l.x,{style:o({},u.text)},"Please confirm and fill up name and address of the payer for your electronic official receipt and click Continue to proceed for payment."),r.a.createElement(l.O,null)),r.a.createElement(l.s,{context:p,handler:d},r.a.createElement(l.V,{name:"paidby",caption:"Paid By Name",required:!0,error:b.paidby,helperText:b.paidby,autoFocus:!0}),r.a.createElement(l.V,{name:"paidbyaddress",caption:"Paid By Address",required:!0,error:b.paidbyaddress,helperText:b.paidbyaddress})),r.a.createElement(l.O,null),r.a.createElement(l.I,{style:u.infoContainer},r.a.createElement("div",{style:o({},u.infoContainer,{alignItems:"center"})},r.a.createElement("label",null,"Payment Details"),r.a.createElement("h4",null,c.paymentdetails)),r.a.createElement("div",{style:u.amountContainer},r.a.createElement("label",{style:u.amount},"Php ",Object(l.Y)(c.amount)))),r.a.createElement(l.O,null),r.a.createElement(l.G,{open:v,title:"Error",onAccept:function(){return O(!1)},msg:"An error was encountered when processing your order. Please try again later or contact LGU for assistance."}),r.a.createElement(l.a,null,r.a.createElement(l.d,{variant:"text",caption:"Back",action:t}),r.a.createElement(l.d,{caption:"Continue",action:function(){var e={};p.paidby||(e.paidby="Required"),p.paidbyaddress||(e.paidbyaddress="Required"),f(e),0===Object.keys(e).length&&n(p)},disableWhen:i,loading:i}))))},u={text:{display:"block",textAlign:"center"},infoContainer:{display:"flex",flexDirection:"column"},amountContainer:{display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #aaa"},amount:{fontSize:24,fontWeight:800,padding:10}},s={paymentTypeContainer:{display:"flex",flexDirection:"column",width:"400px"},paymentType:{paddingLeft:20},label:{fontWeight:"bold",textAlign:"right"},row:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},p={paymentTypeContainer:{display:"flex",justifyContent:"center",width:"400px"},paymentType:{paddingLeft:20},label:{fontWeight:"bold",textAlign:"right"},row:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},d={paymaya:{component:function(e){var t=e.po,n=e.onCancel,o=e.onCheckout,c=Object(a.useState)("wallet"),i=c[0],m=c[1],u=Object(a.useState)(0),p=u[0],d=u[1];return Object(a.useEffect)((function(){if("wallet"===i)d(30);else{var e=Math.round(100*(t.amount/.985-t.amount))/100;d(e+20)}}),[i]),r.a.createElement(l.e,{style:{minWidth:"400px"}},r.a.createElement(l.j,{center:!0},r.a.createElement(l.u,{src:"/assets/paymaya.png",width:"150",style:{cursor:"pointer"}})),r.a.createElement(l.O,null),r.a.createElement("div",{style:s.paymentTypeContainer},r.a.createElement(l.x,{labelStyle:s.label},"Select Type of Payment"),r.a.createElement("div",{style:s.paymentType},r.a.createElement(l.L,{name:"payType",value:i,onChange:m},r.a.createElement(l.w,{caption:"Wallet",value:"wallet"}),r.a.createElement(l.w,{caption:"Credit/Debit Card",value:"card"})))),r.a.createElement(l.O,null),r.a.createElement(l.I,{row:!0,style:s.row},r.a.createElement(l.x,{labelStyle:s.label},"Amount"),r.a.createElement(l.x,{labelStyle:s.label},"PHP "+Object(l.Y)(t.amount))),r.a.createElement(l.I,{row:!0,style:s.row},r.a.createElement(l.x,{labelStyle:s.label},"Convenience Fee"),r.a.createElement(l.x,{labelStyle:s.label},"PHP "+Object(l.Y)(p))),r.a.createElement(l.I,{row:!0,style:s.row},r.a.createElement(l.x,{labelStyle:s.label},"Sub-Total"),r.a.createElement(l.x,{labelStyle:s.label},"PHP "+Object(l.Y)(t.amount+p))),r.a.createElement(l.a,null,r.a.createElement(l.b,{caption:"Cancel",action:n}),r.a.createElement(l.d,{caption:"Proceed Payment",action:function(){o({type:i,fee:p})}})))}},gcash:{component:function(e){var t=e.po,n=e.onCancel,o=e.onCheckout,c=Object(a.useState)("wallet")[0],i=Object(a.useState)(30)[0];return r.a.createElement(l.e,{style:{minWidth:"400px"}},r.a.createElement(l.j,{center:!0},r.a.createElement(l.u,{src:"/assets/gcash.png",width:"150",style:{cursor:"pointer"}})),r.a.createElement("div",{style:p.paymentTypeContainer},r.a.createElement("h3",{labelStyle:p.label},"Payment Details")),r.a.createElement(l.O,null),r.a.createElement(l.I,{row:!0,style:p.row},r.a.createElement(l.x,{labelStyle:p.label},"Amount"),r.a.createElement(l.x,{labelStyle:p.label},"PHP "+Object(l.Y)(t.amount))),r.a.createElement(l.I,{row:!0,style:p.row},r.a.createElement(l.x,{labelStyle:p.label},"Convenience Fee"),r.a.createElement(l.x,{labelStyle:p.label},"PHP "+Object(l.Y)(10))),r.a.createElement(l.I,{row:!0,style:p.row},r.a.createElement(l.x,{labelStyle:p.label},"Web Service Fee"),r.a.createElement(l.x,{labelStyle:p.label},"PHP "+Object(l.Y)(20))),r.a.createElement(l.I,{row:!0,style:p.row},r.a.createElement(l.x,{labelStyle:p.label},"Sub-Total"),r.a.createElement(l.x,{labelStyle:p.label},"PHP "+Object(l.Y)(t.amount+i))),r.a.createElement(l.a,null,r.a.createElement(l.b,{caption:"Cancel",action:n}),r.a.createElement(l.d,{caption:"Proceed Payment",action:function(){o({type:c,fee:i})}})))}}},y=function(e){var t=e.po,n=e.error,c=e.payOptions,i=e.partner,m=Object(a.useState)(!1)[0],u=Object(a.useState)(!1),s=u[0],p=u[1],y=Object(a.useState)(),f=y[0],E=y[1],v=Object(a.useState)(!1),O=v[0],h=v[1],S=Object(a.useState)(!1),g=S[0],x=S[1],j=Object(a.useState)(!1),P=j[0],C=j[1],w=Object(a.useState)({}),T=w[0],k=w[1],I=Object(a.useState)("payment"),N=I[0],A=I[1],V=Object(a.useState)({}),B=V[0],W=V[1],R=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=document.getElementById("postform");e&&T.formaction&&e.submit()}),[T]);var q=function(e){E(null),p(!0),l.N.lookup("CloudPaymentService","epayment").invoke("getPayPartner",{objid:t.objid,payoption:e.objid,checkout:e.checkout},(function(e,t){e?("string"==typeof e?/syntax/gi.test(e)?E("Could not contact payment partner. Please try again."):E(e):E(e.errormsg),p(!1),h(!0)):k(t)}))};if("checkout"===N){var D=d[B.paypartnerid.toLowerCase()].component;return r.a.createElement(D,{po:t,onCancel:function(){A("payment")},onCheckout:function(e){A("payment"),q(o({},B,{checkout:e}))}})}var F=[];return T.params&&Object.keys(T.params).forEach((function(e){F.push([e,T.params[e]])})),r.a.createElement(r.a.Fragment,null,r.a.createElement(l.G,{title:"Acknowledgement",msg:"Kindly acknowledge and confirm with the Terms and Conditions before proceeding.",open:P,onAccept:function(){return C(!1)}}),r.a.createElement(l.G,{title:"Payment Processing Error",msg:"An error occurred while processing your request. Correct the problem and resubmit your request or kindly contact the LGU for assistance",open:O,onAccept:function(){return h(!1)}},r.a.createElement("ul",null,r.a.createElement("li",null,/timeout/gi.test(f)?"Could not contact payment partner. Please try again.":f))),r.a.createElement(l.F,{open:s,showActions:!1},r.a.createElement(l.I,{center:!0},r.a.createElement(l.O,null),r.a.createElement("label",{style:{fontSize:20,fontWeight:800}},"Contacting Partner"),r.a.createElement("label",{style:{fontSize:14,opacity:.75}},"Kindly wait while we send your payment request to our partner."),r.a.createElement(l.B,{showMessage:!1}),r.a.createElement(l.O,null))),r.a.createElement(l.O,null),r.a.createElement(l.I,{center:!0},r.a.createElement(l.I,{style:b.poContainer},r.a.createElement(l.I,{center:!0},r.a.createElement(l.W,{color:"green"},"Your Order")),r.a.createElement(l.O,null),r.a.createElement(l.I,null,r.a.createElement(l.x,{context:i,caption:"Agency",expr:"title"}),r.a.createElement(l.x,{context:t,caption:"Reference No.",expr:"objid"}),r.a.createElement(l.x,{context:t,caption:"Transaction Type",expr:"txntypename"}),r.a.createElement(l.x,{context:t,caption:"Particulars",expr:"particulars"}),r.a.createElement(l.x,{context:t,caption:"Paid By",expr:"paidby"}),r.a.createElement(l.O,{height:10}),r.a.createElement(l.x,{caption:"Amount"},t&&Object(l.Y)(t.amount))),r.a.createElement(l.t,{row:!0,style:{marginTop:10}},r.a.createElement(l.x,{style:{color:"blue",paddingRight:5}},"Note:"),r.a.createElement(l.x,{style:{color:"red"}},t&&"Pay on or before "+t.expirydate)),r.a.createElement(l.h,{checked:g,onChange:x,style:{marginRight:5},caption:r.a.createElement("span",{style:{fontSize:14,paddingTop:8}},"I acknowledge and agree to the Terms and Conditions of this e-payment facility.")}),r.a.createElement(l.O,{height:10})),!m&&g&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.r,{msg:n}),r.a.createElement(l.O,null),r.a.createElement(l.x,null,"Click to choose Type of Payment:"),r.a.createElement(l.t,{row:!0},c&&c.map((function(e){return r.a.createElement("button",{type:"submit",style:b.payButton,onClick:function(){return t=e,void(g?function(e){return void 0!==d[e.paypartnerid.toLowerCase()]}(t)?(A("checkout"),W(t)):q(t):C(!0));var t}},r.a.createElement("input",{type:"hidden",name:"refno",value:t.objid}),r.a.createElement("input",{type:"hidden",name:"payoption",value:e.objid}),r.a.createElement(l.u,{src:"/assets/"+e.paypartnerid.toLowerCase()+".png",width:"150",style:{cursor:"pointer"}}))}))))),!0===T.isredirect?r.a.createElement("form",{id:"postform",method:"GET",action:T.formaction,ref:R},r.a.createElement("input",{type:"hidden",name:"id",value:T.id})):r.a.createElement("form",{id:"postform",method:"POST",action:T.formaction,ref:R},r.a.createElement(r.a.Fragment,null,F.map((function(e){return r.a.createElement("input",{key:e[0],type:"hidden",name:e[0],value:e[1]})})),r.a.createElement("input",{type:"hidden",name:"orgcode",value:"${po.orgcode}"}))))},b={poContainer:{display:"flex",flexDirection:"column",border:"1px solid #aaa",borderRadius:5,padding:15,maxWidth:450},payButton:{border:"none",background:"none"}},f=function(e){var t=e.module,n=e.partner,u=e.contact,s=e.initialStep,p=void 0===s?0:s,d=e.cancelPayment,b=function(){C((function(e){return e+1!==E.length?e+1:e}))},f=function(){C((function(e){return e-1>=0?e-1:e}))},E=[{name:"verifyemail",title:"Email Verification",component:c,actions:{onCancel:function(){e.history.goBack()},onVerify:function(e){setContact(e),b()}}},{name:"billing",title:t.title,component:t.component,actions:{onCancel:function(e){d?d():f()},onSubmit:function(e){A(e),C(E.findIndex(u.email?function(e){return"checkout"===e.name}:function(e){return"verification"===e.name}))}}},{name:"verification",caption:"Email Verification",component:i,actions:{movePrevStep:function(){C(1)},moveNextStep:function(){C(E.findIndex((function(e){return"checkout"===e.name})))}}},{name:"checkout",title:"Checkout Order",component:m,actions:{onCancel:function(){C(1)},onSubmit:function(e){h(!0),x(null),function(){try{var t=o({},N);t.paidby=e.paidby,t.paidbyaddress=e.paidbyaddress,t.email=u.email,t.mobileno=u.mobileno;var a=l.N.lookupAsync(n.id+":EPaymentService","epayment");return Promise.resolve(a.invoke("createPaymentOrder",t)).then((function(e){var t=l.N.lookupAsync("CloudPaymentService","epayment");return Promise.resolve(t.invoke("getPaymentOrder",{objid:e.objid})).then((function(a){return e=a,Promise.resolve(t.invoke("getPaymentPartnerOptions",{partnerid:e.orgcode})).then((function(t){return{po:e,payOptions:t,partner:n}}))}))}))}catch(e){return Promise.reject(e)}}().then((function(e){W(e.po),D(e.payOptions),b(),h(!1)})).catch((function(e){x(e.toString()),h(!1)}))}}},{name:"payment",title:"Online Payment",component:y,actions:{onCancel:f,onSubmit:function(){}}}],v=Object(a.useState)(!1),O=v[0],h=v[1],S=Object(a.useState)(),g=S[0],x=S[1],j=Object(a.useState)(p),P=j[0],C=j[1],w=Object(a.useState)(E[p]),T=w[0],k=w[1],I=Object(a.useState)(),N=I[0],A=I[1],V=Object(a.useState)(),B=V[0],W=V[1],R=Object(a.useState)(),q=R[0],D=R[1],F=Object(a.useState)(0)[0];return Object(a.useEffect)((function(){k(E[P])}),[P]),r.a.createElement(T.component,o({},e,{contact:u,bill:N,po:B,payOptions:q},T.actions,{error:g,module:t,loading:O,page:T,initialStep:F,emailRequired:!0}))};function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var v=function(e){var t=e.initialValue,n=void 0===t?{}:t,o=e.open,c=e.onAccept,i=e.onCancel,m=Object(a.useState)(n),u=m[0],s=m[1],p=Object(a.useState)(Object(l.eb)(n.fromyear,Object(l.Z)()+3))[0],d=Object(a.useState)([1,2,3,4]),y=d[0],b=d[1];return Object(a.useEffect)((function(){var e=n.fromqtr;u.billtoyear===n.fromyear&&1!==e?b(Object(l.eb)(e,4)):(b([1,2,3,4]),s(E({},u,{billtoqtr:4})))}),[u.billtoyear]),r.a.createElement(l.F,{open:o,caption:"Pay Options",onAccept:function(){c(u)},onCancel:i,maxWidth:100},r.a.createElement(l.s,{context:u,handler:s,style:{width:"250px"}},r.a.createElement(l.i,{caption:"Year to Bill",name:"billtoyear",items:p}),r.a.createElement(l.M,{caption:"Quarter to Bill",name:"billtoqtr",items:y})))},O=function(e){var t=e.title,n=e.partner,o=e.onCancel,c=e.onSubmit,i=e.error,m=Object(l.hb)()[0],u=m.refno,s=m.txntype,p=m.contact,d=Object(a.useState)(m.bill),y=d[0],b=d[1],f=Object(a.useState)(i),O=f[0],h=f[1],S=Object(a.useState)(!1),g=S[0],x=S[1],j=Object(a.useState)(!1),P=j[0],C=j[1],w=(Object(a.useState)(),Object(a.useState)(),Object(a.useState)()),T=w[0],k=w[1],I=!!p.email&&p.email===y.email;return r.a.createElement(l.e,{style:{maxWidth:500}},r.a.createElement(l.W,null,t),r.a.createElement(l.R,null,"Billing Information"),r.a.createElement(l.O,null),r.a.createElement(l.r,{msg:O}),r.a.createElement(l.s,{context:y,handler:b},r.a.createElement(l.I,{row:!0},r.a.createElement(l.V,{name:"billno",caption:"Bill No.",readOnly:!0}),r.a.createElement(l.V,{name:"billdate",caption:"Bill Date",readOnly:!0})),r.a.createElement(l.V,{name:"tdno",caption:"TD No.",readOnly:!0}),r.a.createElement(l.V,{name:"fullpin",caption:"PIN",readOnly:!0}),r.a.createElement(l.V,{name:"taxpayer.name",caption:"Property Owner",readOnly:!0,visibleWhen:I}),r.a.createElement(l.V,{name:"taxpayer.address",caption:"Owner Address",readOnly:!0,visibleWhen:I}),r.a.createElement(l.V,{name:"billperiod",caption:"Bill Period",readOnly:!0}),r.a.createElement(l.l,{name:"amount",caption:"Amount Due",readOnly:!0,textAlign:"left"})),r.a.createElement(l.a,{disabled:g},r.a.createElement(l.b,{caption:"Back",action:function(){o(0)}}),r.a.createElement(l.I,{row:!0},r.a.createElement(l.d,{caption:"Pay Option",action:function(){return C(!0)},variant:"outlined"}),r.a.createElement(l.d,{caption:"Confirm Payment",action:function(){var e=E({},y,{barcode:T}),t=e.items;delete e.items,c({refno:u,txntype:s,origin:"filipizen",orgcode:n.id,billtoyear:y.billtoyear,billtoqtr:y.billtoqtr,paidby:y.paidby,paidbyaddress:y.paidbyaddress,amount:y.amount,particulars:"Real Property TD No. "+y.tdno+" "+y.billperiod,items:t,info:{data:e}})},disableWhen:0===y.amount}))),r.a.createElement(v,{initialValue:y&&{billtoyear:y.billtoyear,billtoqtr:y.billtoqtr,fromyear:y.fromyear,fromqtr:y.fromqtr},open:P,onAccept:function(e){var t;C(!1),void 0===(t=e)&&(t={}),x(!0),h(null),function(e){void 0===e&&(e={});try{return Promise.resolve(l.N.lookupAsync(n.id+":OnlineLandTaxBillingService","rpt")).then((function(t){var n=E({txntype:s,refno:u},e);return Promise.resolve(t.invoke("getBilling",n))}))}catch(e){return Promise.reject(e)}}(t).then((function(e){b(e.info),k(e.info.billno),x(!1)})).catch((function(e){h(e.toString()),x(!1)}))},onCancel:function(){return C(!1)}}))},h={txntype:"rptcol",refno:null,bill:{},contact:{}},S=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},g=[{step:1,name:"verification",caption:"Verification",Component:i},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,o=e.moveNextStep,c=e.movePrevStep,i=Object(l.hb)(),m=i[1],u=i[0].txntype,s=(new Date).getFullYear(),p=Object(a.useState)(),d=p[0],y=p[1],b=Object(a.useState)(!1),f=b[0],v=b[1],O=Object(a.useState)(),h=O[0],S=O[1],g=Object(a.useState)(s+1),x=g[0],j=g[1],P=Object(a.useState)("initial"),C=P[0],w=P[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.e,null,r.a.createElement(l.W,null,t),r.a.createElement(l.R,null,"Initial Information"),r.a.createElement(l.O,null),r.a.createElement(l.r,{msg:d}),r.a.createElement(l.I,{visibleWhen:"initial"===C},r.a.createElement(l.V,{caption:"Tax Declaration No.",name:"refno",value:h,onChange:S,readOnly:f,autoFocus:!0})),r.a.createElement(l.I,{visibleWhen:"initial-advance"===C},r.a.createElement("p",null,"The associated ledger is fully paid for the current year.",r.a.createElement("br",null),"To pay in advance, specify the year and click Next button."),r.a.createElement(l.O,null),r.a.createElement(l.I,null,r.a.createElement(l.V,{caption:"Tax Declaration No.",name:"refno",value:h,onChange:S,readOnly:!0}),r.a.createElement(l.v,{caption:"Advance Year to Pay",name:"billtoyear",value:x,onChange:j,thousandSeparator:!1,autoFocus:!0}))),r.a.createElement(l.a,null,r.a.createElement(l.b,{caption:"Back",variant:"text",action:c}),r.a.createElement(l.d,{caption:"Next",action:function(){"initial-advance"===C&&x<=s?y("Advance year to pay should be greater than "+s):(v(!0),y(null),function(e){void 0===e&&(e={});try{return Promise.resolve(l.N.lookupAsync(n.id+":OnlineLandTaxBillingService","rpt")).then((function(t){var n=E({txntype:u,refno:h},e);return"initial-advance"===C&&(n.billtoyear=x),Promise.resolve(t.invoke("getBilling",n))}))}catch(e){return Promise.reject(e)}}().then((function(e){m({type:"SET_BILL",refno:h,bill:e.info}),o()})).catch((function(e){/unpaid|full/gi.test(e)?w("initial-advance"):y(e.toString()),v(!1)})))},loading:f,disabled:f}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(l.hb)();return r.a.createElement(f,E({module:{title:"Realty Tax Online Billing",component:O}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],x=function(e){var t=e.partner,n=e.service,o=e.location,c=e.history,i=e.initialStep,m=Object(a.useState)(void 0===i?0:i),u=m[0],s=m[1],p=g[u];return r.a.createElement(l.P,{initialState:h,reducer:S},r.a.createElement(l.H,null,r.a.createElement(l.j,{center:!0},r.a.createElement(p.Component,E({page:p},{partner:t,service:n,location:o,history:c,moveNextStep:function(){s((function(e){return e+1}))},movePrevStep:function(){0===u?c.goBack():s((function(e){return e-1}))},cancelPayment:function(){s(1)},title:"Realty Tax Online Billing"})))))},j=function(e){var t=e.title,n=e.partner,o=e.onCancel,c=e.onSubmit,i=e.error,m=Object(l.hb)()[0],u=m.refno,s=m.txntype,p=Object(a.useState)(m.bill),d=p[0],y=p[1],b=Object(a.useState)(i)[0],f=Object(a.useState)(!1)[0],v=(Object(a.useState)(!1),Object(a.useState)(),Object(a.useState)(),Object(a.useState)()[0]);return r.a.createElement(l.e,{style:{maxWidth:500}},r.a.createElement(l.W,null,t),r.a.createElement(l.R,null,"Billing Information"),r.a.createElement(l.O,null),r.a.createElement(l.r,{msg:b}),r.a.createElement(l.s,{context:d,handler:y},r.a.createElement(l.V,{name:"tdno",caption:"TD No.",readOnly:!0}),r.a.createElement(l.V,{name:"pin",caption:"PIN",readOnly:!0}),r.a.createElement(l.V,{name:"owner.name",caption:"Property Owner",readOnly:!0}),r.a.createElement(l.V,{name:"owner.address",caption:"Owner Address",readOnly:!0}),r.a.createElement(l.V,{name:"purpose",caption:"Purpose",readOnly:!0}),r.a.createElement(l.O,null),r.a.createElement(l.l,{name:"amount",caption:"Amount Due",readOnly:!0,textAlign:"left"})),r.a.createElement(l.a,{disabled:f},r.a.createElement(l.b,{caption:"Back",action:function(){o(0)}}),r.a.createElement(l.d,{caption:"Confirm Payment",action:function(){delete E({},d,{barcode:v}).items,c({refno:u,txntype:s,origin:"filipizen",orgcode:n.id,paidby:d.paidby,paidbyaddress:d.paidbyaddress,amount:d.amount,particulars:"Realty Tax Clearance for TD No. "+d.tdno,items:d.billitems,info:{data:d}})},disableWhen:0===d.amount})))},P={txntype:"rpttaxclearance",refno:null,bill:{},contact:{}},C=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},w=[{step:1,name:"verification",caption:"Verification",Component:i},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,o=e.moveNextStep,c=e.movePrevStep,i=Object(l.hb)(),m=i[1],u=i[0].txntype,s=Object(a.useState)(),p=s[0],d=s[1],y=Object(a.useState)({}),b=y[0],f=y[1],v=Object(a.useState)(!1),O=v[0],h=v[1],S=Object(a.useState)(),g=S[0],x=S[1],j=Object(a.useState)(),P=j[0],C=j[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.e,null,r.a.createElement(l.W,null,t),r.a.createElement(l.R,null,"Initial Information"),r.a.createElement(l.O,null),r.a.createElement(l.r,{msg:p}),r.a.createElement(l.V,{caption:"Tax Declaration No.",name:"refno",value:g,onChange:x,readOnly:O,autoFocus:!0,error:b.refno,helperText:b.refno}),r.a.createElement(l.V,{caption:"Purpose",name:"purpose",value:P,onChange:C,readOnly:O,error:b.purpose,helperText:b.purpose}),r.a.createElement(l.a,null,r.a.createElement(l.b,{caption:"Back",variant:"text",action:c}),r.a.createElement(l.d,{caption:"Next",action:function(){g||f(E({},b,{refno:"Tax Declaration No. is required."})),P||f(E({},b,{purpose:"Purpose is required."})),0===Object.keys(b).length&&(h(!0),d(null),function(){try{return Promise.resolve(l.N.lookupAsync(n.id+":OnlineRealtyTaxClearanceService","rpt")).then((function(e){return Promise.resolve(e.invoke("getBilling",{txntype:u,refno:g,purpose:P}))}))}catch(e){return Promise.reject(e)}}().then((function(e){m({type:"SET_BILL",refno:g,bill:e}),o()})).catch((function(e){d(e.toString()),h(!1)})))},loading:O,disabled:O}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(l.hb)();return r.a.createElement(f,E({module:{title:"Online Realty Tax Clearance",component:j}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],T=function(e){var t=e.partner,n=e.service,o=e.location,c=e.history,i=e.initialStep,m=Object(a.useState)(void 0===i?0:i),u=m[0],s=m[1],p=w[u];return r.a.createElement(l.P,{initialState:P,reducer:C},r.a.createElement(l.H,null,r.a.createElement(l.j,{center:!0},r.a.createElement(p.Component,E({page:p},{partner:t,service:n,location:o,history:c,moveNextStep:function(){s((function(e){return e+1}))},movePrevStep:function(){0===u?c.goBack():s((function(e){return e-1}))},cancelPayment:function(){s(1)},emailRequired:!0,title:"Online Realty Tax Clearance"})))))}}}]);