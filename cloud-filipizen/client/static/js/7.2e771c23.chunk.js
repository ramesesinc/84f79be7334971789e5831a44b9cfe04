(this["webpackJsonpfilipizen-client"]=this["webpackJsonpfilipizen-client"]||[]).push([[7],{744:function(e,t,n){"use strict";n.r(t),n.d(t,"WaterworksBillingWebController",(function(){return b}));var a=n(0),i=n.n(a),r=n(2),l=(n(116),n(117));function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var c=function(e){var t=e.title,n=e.partner,l=e.onCancel,o=e.onSubmit,c=e.error,u=Object(r.tb)()[0],p=u.refno,s=u.txntype,b=Object(a.useState)(u.bill),d=b[0],f=b[1],E=Object(a.useState)(c)[0],y=Object(a.useState)(!1)[0];return i.a.createElement(r.g,{style:{maxWidth:500}},i.a.createElement(r.fb,null,t),i.a.createElement(r.Z,null,"Billing Information"),i.a.createElement(r.W,null),i.a.createElement(r.v,{msg:E}),i.a.createElement(r.w,{context:d,handler:f},i.a.createElement(r.eb,{name:"acctno",caption:"Account No.",readOnly:!0}),i.a.createElement(r.eb,{name:"acctname",caption:"Account Name",readOnly:!0}),i.a.createElement(r.eb,{name:"address.text",caption:"Address",readOnly:!0}),i.a.createElement(r.eb,{name:"classificationid",caption:"Classification",readOnly:!0}),i.a.createElement(r.eb,{name:"billno",caption:"Last Bill Period",readOnly:!0}),i.a.createElement(r.O,{row:!0},i.a.createElement(r.eb,{name:"monthname",caption:"Bill Month",readOnly:!0}),i.a.createElement(r.eb,{name:"year",caption:"Bill Year",readOnly:!0})),i.a.createElement(r.O,{row:!0},i.a.createElement(r.eb,{name:"meter.size.title",caption:"Meter Size",readOnly:!0}),i.a.createElement(r.eb,{name:"consumption.prev.reading",caption:"Previous Reading",readOnly:!0}),i.a.createElement(r.eb,{name:"consumption.reading",caption:"Current Reading",readOnly:!0}),i.a.createElement(r.eb,{name:"consumption.volume",caption:"Consumption",readOnly:!0})),i.a.createElement(r.W,null),i.a.createElement("h4",null,"Bill Details"),i.a.createElement(r.cb,{items:d.items,showPagination:!1},i.a.createElement(r.db,{expr:"item.title",caption:"Account"}),i.a.createElement(r.db,{expr:"remarks",caption:"Particulars"}),i.a.createElement(r.db,{expr:function(e){return Object(r.hb)(e.amount)},caption:"Amount Due",type:"decimal",align:"right"})),i.a.createElement(r.O,{style:m.totalContainer},i.a.createElement("h4",{style:m.total},"TOTAL"),i.a.createElement("h4",{style:m.amount},Object(r.hb)(d.amount)))),i.a.createElement(r.b,{disabled:y},i.a.createElement(r.d,{caption:"Back",action:function(){l(0)}}),i.a.createElement(r.e,{caption:"Confirm Payment",action:function(){o({refno:p,txntype:s,origin:"filipizen",orgcode:n.id,billtoyear:d.billtoyear,billtoqtr:d.billtoqtr,paidby:d.paidby,paidbyaddress:d.paidbyaddress,amount:d.amount,info:{data:d},particulars:"Wateworks Account "+d.acctno+" Bill No. "+d.billno})},disableWhen:0===d.amount})))},m={subtitle:{fontSize:16,fontWeight:400,opacity:.8,color:"green"},totalContainer:{display:"flex",justifyContent:"flex-end",marginTop:-10},total:{fontWeight:800,marginRight:40},amount:{marginRight:20}},u={txntype:"waterworks",refno:null,bill:{},contact:{}},p=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},s=[{step:1,name:"verification",caption:"Verification",Component:l.b},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,l=e.moveNextStep,c=e.movePrevStep,m=Object(r.tb)(),u=m[1],p=m[0].txntype,s=Object(a.useState)(),b=s[0],d=s[1],f=Object(a.useState)(!1),E=f[0],y=f[1],g=Object(a.useState)(),v=g[0],O=g[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.g,null,i.a.createElement(r.fb,null,t),i.a.createElement(r.Z,null,"Initial Information"),i.a.createElement(r.W,null),i.a.createElement(r.v,{msg:b}),i.a.createElement(r.eb,{caption:"Account No.",name:"refno",value:v,onChange:O,readOnly:E,autoFocus:!0}),i.a.createElement(r.b,null,i.a.createElement(r.d,{caption:"Back",variant:"text",action:c}),i.a.createElement(r.e,{caption:"Next",action:function(e){void 0===e&&(e={}),y(!0),d(null),function(e){void 0===e&&(e={});try{return Promise.resolve(r.U.lookupAsync(n.id+":OnlineWaterworksBillingService","waterworks")).then((function(t){var n=o({txntype:p,refno:v},e);return Promise.resolve(t.invoke("getBilling",n))}))}catch(e){return Promise.reject(e)}}(e).then((function(e){u({type:"SET_BILL",refno:v,bill:e}),l()})).catch((function(e){d(e.toString()),y(!1)}))},loading:E,disabled:E}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(r.tb)();return i.a.createElement(l.d,o({module:{title:"Waterworks Online Billing",component:c}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],b=function(e){var t=e.partner,n=e.service,l=e.location,c=e.history,m=e.initialStep,b=Object(a.useState)(void 0===m?0:m),d=b[0],f=b[1],E=s[d];return i.a.createElement(r.X,{initialState:u,reducer:p},i.a.createElement(r.N,null,i.a.createElement(r.l,{center:!0},i.a.createElement(E.Component,o({page:E},{partner:t,service:n,location:l,history:c,moveNextStep:function(){f((function(e){return e+1}))},movePrevStep:function(){0===d?c.goBack():f((function(e){return e-1}))},cancelPayment:function(){f(1)},title:"Waterworks Online Billing"})))),i.a.createElement(r.W,{height:50}))}}}]);