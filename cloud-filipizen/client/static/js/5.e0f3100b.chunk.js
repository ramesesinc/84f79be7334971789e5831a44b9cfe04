(this["webpackJsonpfilipizen-client"]=this["webpackJsonpfilipizen-client"]||[]).push([[5],{554:function(e,t,n){"use strict";n.r(t),n.d(t,"RealtyTaxClearanceWebController",(function(){return v})),n.d(t,"RptBillingWebController",(function(){return s}));var a=n(0),r=n.n(a),l=n(2),i=(n(91),n(92));function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var c=function(e){var t=e.initialValue,n=void 0===t?{}:t,i=e.open,c=e.onAccept,m=e.onCancel,u=Object(a.useState)(n),p=u[0],b=u[1],s=Object(a.useState)(Object(l.jb)(n.fromyear,Object(l.eb)()+3))[0],d=Object(a.useState)([1,2,3,4]),f=d[0],y=d[1];return Object(a.useEffect)((function(){var e=n.fromqtr;p.billtoyear===n.fromyear&&1!==e?y(Object(l.jb)(e,4)):(y([1,2,3,4]),b(o({},p,{billtoqtr:4})))}),[p.billtoyear]),r.a.createElement(l.J,{open:i,caption:"Pay Options",onAccept:function(){c(p)},onCancel:m,maxWidth:100},r.a.createElement(l.u,{context:p,handler:b,style:{width:"250px"}},r.a.createElement(l.j,{caption:"Year to Bill",name:"billtoyear",items:s}),r.a.createElement(l.Q,{caption:"Quarter to Bill",name:"billtoqtr",items:f})))},m=function(e){var t=e.title,n=e.partner,i=e.onCancel,m=e.onSubmit,u=e.error,p=Object(l.mb)()[0],b=p.refno,s=p.txntype,d=p.contact,f=Object(a.useState)(p.bill),y=f[0],E=f[1],v=Object(a.useState)(u),O=v[0],S=v[1],h=Object(a.useState)(!1),g=h[0],j=h[1],x=Object(a.useState)(!1),T=x[0],P=x[1],C=(Object(a.useState)(),Object(a.useState)(),Object(a.useState)()),B=C[0],N=C[1],k=!!d.email&&d.email===y.email;return r.a.createElement(l.f,{style:{maxWidth:500}},r.a.createElement(l.cb,null,t),r.a.createElement(l.W,null,"Billing Information"),r.a.createElement(l.T,null),r.a.createElement(l.t,{msg:O}),r.a.createElement(l.u,{context:y,handler:E},r.a.createElement(l.M,{row:!0},r.a.createElement(l.bb,{name:"billno",caption:"Bill No.",readOnly:!0}),r.a.createElement(l.bb,{name:"billdate",caption:"Bill Date",readOnly:!0})),r.a.createElement(l.bb,{name:"tdno",caption:"TD No.",readOnly:!0}),r.a.createElement(l.bb,{name:"fullpin",caption:"PIN",readOnly:!0}),r.a.createElement(l.bb,{name:"taxpayer.name",caption:"Property Owner",readOnly:!0,visibleWhen:k}),r.a.createElement(l.bb,{name:"taxpayer.address",caption:"Owner Address",readOnly:!0,visibleWhen:k}),r.a.createElement(l.bb,{name:"billperiod",caption:"Bill Period",readOnly:!0}),r.a.createElement(l.n,{name:"amount",caption:"Amount Due",readOnly:!0,textAlign:"left"})),r.a.createElement(l.b,{disabled:g},r.a.createElement(l.d,{caption:"Back",action:function(){i(0)}}),r.a.createElement(l.M,{row:!0},r.a.createElement(l.e,{caption:"Pay Option",action:function(){return P(!0)},variant:"outlined"}),r.a.createElement(l.e,{caption:"Confirm Payment",action:function(){var e=o({},y,{barcode:B}),t=e.items;delete e.items,m({refno:b,txntype:s,origin:"filipizen",orgcode:n.id,billtoyear:y.billtoyear,billtoqtr:y.billtoqtr,paidby:y.paidby,paidbyaddress:y.paidbyaddress,amount:y.amount,particulars:"Real Property Tax TD No. "+y.tdno+" Payment for: "+y.billperiod,items:t,info:{data:e}})},disableWhen:0===y.amount}))),r.a.createElement(c,{initialValue:y&&{billtoyear:y.billtoyear,billtoqtr:y.billtoqtr,fromyear:y.fromyear,fromqtr:y.fromqtr},open:T,onAccept:function(e){var t;P(!1),void 0===(t=e)&&(t={}),j(!0),S(null),function(e){void 0===e&&(e={});try{return Promise.resolve(l.R.lookupAsync(n.id+":OnlineLandTaxBillingService","rpt")).then((function(t){var n=o({txntype:s,refno:b},e);return Promise.resolve(t.invoke("getBilling",n))}))}catch(e){return Promise.reject(e)}}(t).then((function(e){E(e.info),N(e.info.billno),j(!1)})).catch((function(e){S(e.toString()),j(!1)}))},onCancel:function(){return P(!1)}}))},u={txntype:"rptcol",refno:null,bill:{},contact:{}},p=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},b=[{step:1,name:"verification",caption:"Verification",Component:i.b},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,i=e.moveNextStep,c=e.movePrevStep,m=Object(l.mb)(),u=m[1],p=m[0].txntype,b=(new Date).getFullYear(),s=Object(a.useState)(),d=s[0],f=s[1],y=Object(a.useState)(!1),E=y[0],v=y[1],O=Object(a.useState)(),S=O[0],h=O[1],g=Object(a.useState)(b+1),j=g[0],x=g[1],T=Object(a.useState)("initial"),P=T[0],C=T[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.f,null,r.a.createElement(l.cb,null,t),r.a.createElement(l.W,null,"Initial Information"),r.a.createElement(l.T,null),r.a.createElement(l.t,{msg:d}),r.a.createElement(l.M,{visibleWhen:"initial"===P},r.a.createElement(l.bb,{caption:"Tax Declaration No.",name:"refno",value:S,onChange:h,readOnly:E,autoFocus:!0})),r.a.createElement(l.M,{visibleWhen:"initial-advance"===P},r.a.createElement("p",null,"The associated ledger is fully paid for the current year.",r.a.createElement("br",null),"To pay in advance, specify the year and click Next button."),r.a.createElement(l.T,null),r.a.createElement(l.M,null,r.a.createElement(l.bb,{caption:"Tax Declaration No.",name:"refno",value:S,onChange:h,readOnly:!0}),r.a.createElement(l.w,{caption:"Advance Year to Pay",name:"billtoyear",value:j,onChange:x,thousandSeparator:!1,autoFocus:!0}))),r.a.createElement(l.b,null,r.a.createElement(l.d,{caption:"Back",variant:"text",action:c}),r.a.createElement(l.e,{caption:"Next",action:function(){"initial-advance"===P&&j<=b?f("Advance year to pay should be greater than "+b):(v(!0),f(null),function(e){void 0===e&&(e={});try{return Promise.resolve(l.R.lookupAsync(n.id+":OnlineLandTaxBillingService","rpt")).then((function(t){var n=o({txntype:p,refno:S},e);return"initial-advance"===P&&(n.billtoyear=j),Promise.resolve(t.invoke("getBilling",n))}))}catch(e){return Promise.reject(e)}}().then((function(e){u({type:"SET_BILL",refno:S,bill:e.info}),i()})).catch((function(e){/unpaid|full/gi.test(e)?C("initial-advance"):f(e.toString()),v(!1)})))},loading:E,disabled:E}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(l.mb)();return r.a.createElement(i.d,o({module:{title:"Realty Tax Online Billing",component:m}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],s=function(e){var t=e.partner,n=e.service,i=e.location,c=e.history,m=e.initialStep,s=Object(a.useState)(void 0===m?0:m),d=s[0],f=s[1],y=b[d];return r.a.createElement(l.U,{initialState:u,reducer:p},r.a.createElement(l.L,null,r.a.createElement(l.k,{center:!0},r.a.createElement(y.Component,o({page:y},{partner:t,service:n,location:i,history:c,moveNextStep:function(){f((function(e){return e+1}))},movePrevStep:function(){0===d?c.goBack():f((function(e){return e-1}))},cancelPayment:function(){f(1)},title:"Realty Tax Online Billing"})))),r.a.createElement(l.T,{height:50}))},d=function(e){var t=e.title,n=e.partner,i=e.onCancel,c=e.onSubmit,m=e.error,u=Object(l.mb)()[0],p=u.refno,b=u.txntype,s=Object(a.useState)(u.bill),d=s[0],f=s[1],y=Object(a.useState)(m)[0],E=Object(a.useState)(!1)[0],v=(Object(a.useState)(!1),Object(a.useState)(),Object(a.useState)(),Object(a.useState)()[0]);return r.a.createElement(l.f,{style:{maxWidth:500}},r.a.createElement(l.cb,null,t),r.a.createElement(l.W,null,"Billing Information"),r.a.createElement(l.T,null),r.a.createElement(l.t,{msg:y}),r.a.createElement(l.u,{context:d,handler:f},r.a.createElement(l.bb,{name:"tdno",caption:"TD No.",readOnly:!0}),r.a.createElement(l.bb,{name:"pin",caption:"PIN",readOnly:!0}),r.a.createElement(l.bb,{name:"owner.name",caption:"Property Owner",readOnly:!0}),r.a.createElement(l.bb,{name:"owner.address",caption:"Owner Address",readOnly:!0}),r.a.createElement(l.bb,{name:"purpose",caption:"Purpose",readOnly:!0}),r.a.createElement(l.T,null),r.a.createElement(l.n,{name:"amount",caption:"Amount Due",readOnly:!0,textAlign:"left"})),r.a.createElement(l.b,{disabled:E},r.a.createElement(l.d,{caption:"Back",action:function(){i(0)}}),r.a.createElement(l.e,{caption:"Confirm Payment",action:function(){delete o({},d,{barcode:v}).items,c({refno:p,txntype:b,origin:"filipizen",orgcode:n.id,paidby:d.paidby,paidbyaddress:d.paidbyaddress,amount:d.amount,particulars:"Realty Tax Clearance for TD No. "+d.tdno,items:d.billitems,info:{data:d}})},disableWhen:0===d.amount})))},f={txntype:"rpttaxclearance",refno:null,bill:{},contact:{}},y=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},E=[{step:1,name:"verification",caption:"Verification",Component:i.b},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,i=e.moveNextStep,c=e.movePrevStep,m=Object(l.mb)(),u=m[1],p=m[0].txntype,b=Object(a.useState)(),s=b[0],d=b[1],f=Object(a.useState)({}),y=f[0],E=f[1],v=Object(a.useState)(!1),O=v[0],S=v[1],h=Object(a.useState)(),g=h[0],j=h[1],x=Object(a.useState)(),T=x[0],P=x[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.f,null,r.a.createElement(l.cb,null,t),r.a.createElement(l.W,null,"Initial Information"),r.a.createElement(l.T,null),r.a.createElement(l.t,{msg:s}),r.a.createElement(l.bb,{caption:"Tax Declaration No.",name:"refno",value:g,onChange:j,readOnly:O,autoFocus:!0,error:y.refno,helperText:y.refno}),r.a.createElement(l.bb,{caption:"Purpose",name:"purpose",value:T,onChange:P,readOnly:O,error:y.purpose,helperText:y.purpose}),r.a.createElement(l.b,null,r.a.createElement(l.d,{caption:"Back",variant:"text",action:c}),r.a.createElement(l.e,{caption:"Next",action:function(){g||E(o({},y,{refno:"Tax Declaration No. is required."})),T||E(o({},y,{purpose:"Purpose is required."})),0===Object.keys(y).length&&(S(!0),d(null),function(){try{return Promise.resolve(l.R.lookupAsync(n.id+":OnlineRealtyTaxClearanceService","rpt")).then((function(e){return Promise.resolve(e.invoke("getBilling",{txntype:p,refno:g,purpose:T}))}))}catch(e){return Promise.reject(e)}}().then((function(e){u({type:"SET_BILL",refno:g,bill:e}),i()})).catch((function(e){d(e.toString()),S(!1)})))},loading:O,disabled:O}))))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(l.mb)();return r.a.createElement(i.d,o({module:{title:"Online Realty Tax Clearance",component:d}},e,{contact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],v=function(e){var t=e.partner,n=e.service,i=e.location,c=e.history,m=e.initialStep,u=Object(a.useState)(void 0===m?0:m),p=u[0],b=u[1],s=E[p];return r.a.createElement(l.U,{initialState:f,reducer:y},r.a.createElement(l.L,null,r.a.createElement(l.k,{center:!0},r.a.createElement(s.Component,o({page:s},{partner:t,service:n,location:i,history:c,moveNextStep:function(){b((function(e){return e+1}))},movePrevStep:function(){0===p?c.goBack():b((function(e){return e-1}))},cancelPayment:function(){b(1)},emailRequired:!0,title:"Online Realty Tax Clearance"})))),r.a.createElement(l.T,{height:50}))}}}]);