(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[13],{248:function(e,t,n){"use strict";n.r(t),n.d(t,"AppTrackingWebController",(function(){return ce})),n.d(t,"BuildingPermitWebController",(function(){return q})),n.d(t,"OboBillingWebController",(function(){return de})),n.d(t,"OccupancyPermitWebController",(function(){return Y})),n.d(t,"ProfessionalWebController",(function(){return oe}));var a=n(0),i=n.n(a),o=n(37),l=n(81);n(18);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t.indexOf(n=o[a])>=0||(i[n]=e[n]);return i}var p=function(e){var t=e.onCancel,n=e.onSubmit,l=e.error,c=e.service,r=Object(a.useState)({}),p=r[0],m=r[1],s=Object(a.useState)("new"),u=s[0],d=s[1],f=Object(a.useState)(),E=f[0],y=f[1];return i.a.createElement(o.H,null,i.a.createElement(o.g,null,i.a.createElement(o.X,null,c.title),i.a.createElement(o.S,null,"Select an action"),i.a.createElement(o.P,{height:30}),i.a.createElement(o.L,{value:u,onChange:d},i.a.createElement(o.x,{caption:"Create New Application",value:"new"}),i.a.createElement(o.x,{caption:"Resume Pending Application",value:"resume"})),i.a.createElement(o.W,{caption:"Application Tracking No.",value:E,onChange:y,visibleWhen:"resume"===u,variant:"outlined",fullWidth:!1,required:!0,style:{marginLeft:40},error:p.appno||l,helperText:p.appno||l,size:"small"}),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Cancel",action:t}),i.a.createElement(o.e,{caption:"Next",action:function(){"new"===u||E?n({appType:u,appno:E}):m({appno:"Tracking No. is required."})}}))))},m=function(e){var t=e.partner,n=e.title,l=void 0===n?"New Permit Application":n,c=e.onCancel,r=e.onContinue,p=e.error,m=Object(a.useState)(!1),s=m[0],u=m[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.S,null,l),i.a.createElement(o.P,{height:30}),i.a.createElement(o.s,{msg:p}),i.a.createElement(o.T,null,"Please read thoroughly before proceeding"),i.a.createElement("p",{style:{opacity:.8}},"This online service will require personal information from the applicant, lot owner(s) and professionals involved in this transaction. In compliance with the Data Privacy Act, we are securing your consent that you have been authorized by the aforementioned parties to act on their behalf. The data collected will be stored, processed and used for effectively carrying out legitimate transactions with the local government of ",t.title,". If you do not agree to these terms, you can cancel out by click on the Cancel button. If you agree to these terms, tick on the checkbox and click Continue."),i.a.createElement(o.j,{caption:"Yes, I have read and agree to the terms and conditions",value:s,name:"agreeDisclaimer",onChange:u}),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Cancel",action:c}),i.a.createElement(o.e,{caption:"Continue",action:r,disableWhen:!s})))},s=function(e){var t=e.title,n=e.appno,a=e.onContinue;return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.S,null,void 0===t?"New Permit Application":t),i.a.createElement(o.P,{height:30}),i.a.createElement(o.T,null,"Application created"),i.a.createElement("p",null,"Please take note of the tracking number for this application. This will be your tracking reference for completing and follow up for this application."),i.a.createElement(o.T,null,n),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Continue",action:a})))},u=o.O.lookup("OnlineBuildingPermitService","obo"),d=[{name:"email",caption:"Email Verification"},{name:"select-apptype",caption:"Select Application Type"},{name:"project-name",caption:"Project Name"},{name:"confirmation",caption:"Confirmation"},{name:"newapp",caption:"New Application "}],f=function(e){var t=Object(a.useState)({}),n=t[0],r=t[1],p=(Object(a.useState)(!1),Object(a.useState)("new")[0]),f=(Object(a.useState)(),Object(a.useState)()),E=f[0],y=f[1],b=Object(a.useState)({apptype:"NEW"}),v=b[0],g=b[1],h=Object(a.useState)(0),S=h[0],j=h[1],O=Object(a.useState)(),x=O[0],k=O[1],w=e.partner,P=e.service,C=e.handler,W=e.onCancel,T=d[S],N=function(){j((function(e){return e+1}))};return i.a.createElement(o.H,null,"email"===T.name?i.a.createElement(l.g,{title:P.title,visibleWhen:"email"===T.name,showName:!0,onCancel:W,onVerify:function(e){r(e),N()},partner:w,connection:"obo"}):i.a.createElement(o.g,null,i.a.createElement(o.X,null,P.title),i.a.createElement(o.t,{visibleWhen:"select-apptype"===T.name,context:v,handler:g},i.a.createElement(o.S,null,"Select Application Type"),i.a.createElement(o.J,{style:{marginLeft:20}},i.a.createElement(o.L,{name:"apptype"},i.a.createElement(o.x,{caption:"New Construction",value:"NEW"}),i.a.createElement(o.x,{caption:"Renovation",value:"RENOVATION",editable:!1}),i.a.createElement(o.x,{caption:"Demolition",value:"DEMOLITION",editable:!1}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Back",action:W}),i.a.createElement(o.e,{caption:"Next",action:N}))),i.a.createElement(o.t,{visibleWhen:"project-name"===T.name,context:v,handler:g},i.a.createElement(o.S,null,"New Building Permit Application"),i.a.createElement(o.P,{height:30}),i.a.createElement(o.T,null,"Project Information"),i.a.createElement(o.W,{caption:"Project Name",name:"title",autoFocus:!0}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){j((function(e){return e-1}))}}),i.a.createElement(o.e,{caption:"Next",action:N}))),i.a.createElement(o.J,{visibleWhen:"confirmation"===T.name},i.a.createElement(m,{partner:w,error:x,onCancel:e.goBack,onContinue:function(){var e=c({},v,{orgcode:w.orgcode||w.id,apptype:p,contact:n,worktypes:[]});u.invoke("create",e,(function(e,t){e?k(e):(y(t.objid),N())}))}})),i.a.createElement(o.J,{visibleWhen:"newapp"===T.name,width:400},i.a.createElement(s,{appno:E,onContinue:function(){C(E)}}))))},E=["INDIVIDUAL","CORPORATION","GOVERNMENT","OTHER"],y=function(e){var t=e.name,n=r(e,["name","caption"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.T,null,n.title||"Lot Ownership"),i.a.createElement(o.L,c({name:t},n),i.a.createElement(o.x,{caption:"Lot Owned",value:"1"}),i.a.createElement(o.x,{caption:"Leased",value:"0"})))},b=["INDIVIDUAL","CORPORATION","GOVERNMENT","OTHER"],v=function(e){var t=e.owner,n=e.editable,a=e.orgcode,c=r(e,["owner","editable","orgcode"]),p=c.showIdEntry||!1;return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.T,null,c.title||"Lot Owner Information"),i.a.createElement(o.J,null,i.a.createElement(o.W,{caption:"Profile No.",name:"owner.profileno",editable:n}),i.a.createElement(o.l,{items:b,name:"owner.entitytype",caption:"Ownership Type",editable:n}),"INDIVIDUAL"!==t.entitytype&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.W,{caption:"Lot Owner Name",name:"owner.name",editable:n}),i.a.createElement(o.y,null,"Name of administrator/contact of property owner")),i.a.createElement(o.W,{caption:"Last Name",name:"owner.lastname",editable:n}),i.a.createElement(o.W,{caption:"First Name",name:"owner.firstname",editable:n}),i.a.createElement(o.W,{caption:"Middle Name",name:"owner.middlename",editable:n}),i.a.createElement(l.n,{person:t,orgcode:a,name:"owner",editable:n}),p&&i.a.createElement(l.h,{name:"owner.id",editable:n})))},g=function(e){var t=e.editable,n=r(e,["editable"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.T,null,n.title||"Lot Information"),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"PIN",name:"pin",editable:t}),i.a.createElement(o.W,{caption:"Lot No.",name:"lotno",editable:t}),i.a.createElement(o.W,{caption:"Block No.",name:"blockno",editable:t})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"Street",name:"street",editable:t}),i.a.createElement(o.W,{caption:"Barangay",name:"barangay",editable:t})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"TD No.",name:"tdno",editable:t}),i.a.createElement(o.W,{caption:"Title No.",name:"titleno",editable:t})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"Classification",name:"classcode",editable:t}),i.a.createElement(o.W,{caption:"Area",name:"areasqm",editable:t})))},h={balanceText:{color:"red",fontWeight:"bold"},locationContainer:{border:"1px solid #aaa",borderRadius:5,boxShadow:"0px 5px 7px -7px rgba(0,0,0,0.75)",marginBottom:10},tdno:{padding:"5px 10px",backgroundColor:"#ddd",borderBottom:"1px solid #aaa",borderRadius:5},rpuInfoContainer:{padding:"10px"}},S=o.O.lookup("OboMiscListService","obo"),j={column:{display:"flex",flexDirection:"column",marginLeft:20}},O=o.O.lookup("OboProfessionalService","obo"),x=function(e){var t=e.onSelect,n=e.hideSearchText,l=void 0!==n&&n,r=(Object(a.useState)(!1),Object(a.useState)({prc:{}})),p=r[0],m=r[1],s=Object(a.useState)(),u=s[0],d=s[1],f=Object(a.useState)(),E=f[0],y=f[1],b=function(e){if(O&&p.prc.idno){var t=c({},p,e);O.invoke("getList",t,(function(e,t){e?console.log("ERROR",e):(console.log("list",t),y(t))}))}};return i.a.createElement("div",null,i.a.createElement(o.D,{caption:"Search Professional",query:p,setQuery:m,searchFieldTitle:"PRC No.",searchField:"prc.idno",onSelect:function(){t(u)},fetchList:b,hideSearchText:l,enableSelect:u&&u.length>0},i.a.createElement(o.t,{context:p,handler:m},i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"PRC No.",name:"prc.idno",width:200,variant:"outlined"}),i.a.createElement(o.e,{caption:"Search",action:function(){b({limit:5,start:0})}}))),i.a.createElement(o.U,{items:E,fetchList:b,rowsPerPage:5,showPagination:!1,singleSelect:!0,keyId:"objid",onSelectItems:function(e){d(e)}},i.a.createElement(o.V,{caption:"PRC",expr:"prc.idno"}),i.a.createElement(o.V,{caption:"Name",expr:function(e){return e.lastname+", "+e.firstname+" "+e.middlename}}),i.a.createElement(o.V,{caption:"Profession",expr:"profession"}))))},k=function(e){var t=e.professional,n=void 0===t?{}:t,a=e.onSelectProfessional,l=e.photoUrl,c="";return n.lastname&&(c=n.lastname+", "+n.firstname+" "+n.middlename),i.a.createElement("div",{style:w.container},i.a.createElement(o.J,{style:w.lookupContainer},i.a.createElement(o.y,{captionStyle:w.caption,caption:e.caption}),i.a.createElement(x,{hideSearchText:!0,onSelect:a,fullWidth:!1})),i.a.createElement("div",{style:{margin:10,padding:10}},i.a.createElement("div",{style:w.nameContainer},i.a.createElement(o.J,null,i.a.createElement(o.y,{labelStyle:w.name},c),i.a.createElement(o.y,{labelStyle:w.profession},n.profession)),i.a.createElement(o.v,{src:l})),i.a.createElement(o.J,{style:w.row},i.a.createElement(o.J,null,i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"PRC ID No."},n.prc.idno),i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"Date Issued"},n.prc.dtissued),i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"Valid Until"},n.prc.dtvalid),i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"Place Issued"},n.prc.placeissued)),i.a.createElement(o.J,null,i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"PTR ID No."},n.ptr.refno),i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"Date Issued"},n.ptr.dtissued),i.a.createElement(o.y,{style:w.label,captionStyle:{width:120},caption:"Place Issued"},n.ptr.placeissued)))))},w={container:{borderWidth:1,borderColor:"#aaa",boxShadow:"0px 5px 7px -7px rgba(0,0,0,0.75)",backgroundColor:"#eee"},caption:{fontSize:18,width:"100%"},lookupContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"lightgray",paddingTop:5,paddingLeft:10,paddingRight:10},nameContainer:{dipslay:"flex",justifyContent:"space-between",marginBottom:5},name:{fontSize:16,fontWeight:600},profession:{fontSize:14,fontWeight:600,backgroundColor:"#ddd",width:"100%",padding:10},row:{display:"flex",flexDirection:"row",justifyContent:"space-between"},label:{paddingBottom:2}},P=o.O.lookup("OboMiscListService","obo"),C={row:{display:"flex",alignItems:"flex-start"},group:{fontSize:20,fontWeight:700,marginRight:15,paddingTop:8}},W=function(e){var t=e.item;return i.a.createElement(o.J,{style:{paddingBottom:5}},i.a.createElement(o.J,{style:C.row},i.a.createElement("div",{style:C.group},t.objid),i.a.createElement(o.J,null,i.a.createElement(o.T,null,t.title),i.a.createElement("label",null,t.description))))},T={decimal:o.o,integer:o.w,boolean:function(e){return i.a.createElement("div",{style:A.checkInfo},i.a.createElement(o.j,e))}},N=function(e){var t=e.category,n=e.dataType,a=void 0===n?"integer":n,l=e.unit,c=e.name,r=T[a],p=e.caption.toLowerCase();return"boolean"!==a&&(p+=" ("+l.toLowerCase()+")"),i.a.createElement(o.J,null,t&&i.a.createElement(o.y,{style:A.category},t),i.a.createElement("div",{style:A.infoContainer},i.a.createElement("label",null,p),i.a.createElement(r,{name:c,fullWidth:!1,variant:"outlined",size:"small",width:120,style:{flexBasis:100}})))},A={infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:20},category:{fontSize:16,fontWeight:600,border:"1px solid #aaa",backgroundColor:"#eee",padding:"2px 10px",margin:"10px 0px"},checkInfo:{width:100,display:"flex",justifyContent:"flex-start",alignItems:"center",borderWidth:1,borderColor:"#aaa",borderRadius:3}},J={infoTitle:{fontWeight:"bold"},infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:20}},I={professionalLookup:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"lightgray"},itemsContainer:{marginLeft:20,display:"flex",flexDirection:"column"},workTypeContainer:{display:"flex",flexDirection:"column",marginLeft:20}},L={container:{display:"flex",flexDirection:"column",justifyConent:"flex-start",border:"1px solid #aaa",padding:20,borderRadius:3},linkContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%"},ancillaryContainer:{marginRight:15,marginBottom:20},ancillaryItem:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",padding:5,marginRight:10,border:"1px solid #aaa"}},B={container:{display:"flex",flexDirection:"column",justifyConent:"flex-start",border:"1px solid #aaa",padding:20,borderRadius:3},infoContainer:{display:"flex",flexDirection:"column",marginRight:10,width:"100%"},linkContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%"},ancillaryContainer:{marginRight:15,marginBottom:20},ancillaryItem:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",padding:5,marginRight:10,border:"1px solid #aaa"}},D=o.O.lookup("OnlineBuildingPermitService","obo"),R=[{step:0,component:null},{step:1,name:"applicant",caption:"Applicant",component:function(e){var t=e.appno,n=e.partner,r=e.appService,p=e.moveNextStep,m=Object(a.useState)(!1)[1],s=Object(a.useState)(!1),u=s[0],d=s[1],f=Object(a.useState)("read")[1],y=Object(a.useState)({appno:t,appid:t,entitytype:"INDIVIDUAL",resident:!1}),b=y[0],v=y[1];return Object(a.useEffect)((function(){m(!0),d(null),r.invoke("getApplicant",{appid:t},(function(e,t){e?d(e):t?(v(t),f("read")):f("create"),m(!1)}))}),[]),i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+t),i.a.createElement(o.S,null,"Building Applicant Details"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:u}),i.a.createElement(o.t,{context:b,handler:v},i.a.createElement(o.l,{items:E,name:"entitytype",caption:"Type of Applicant"}),i.a.createElement(o.W,{caption:"Name",name:"name",visibleWhen:"INDIVIDUAL"!==b.entitytype}),i.a.createElement(o.P,null),i.a.createElement(o.J,null,i.a.createElement(o.T,null,"Administrator or contact name of applicant"),i.a.createElement(o.W,{caption:"Last Name",name:"lastname",required:!0}),i.a.createElement(o.W,{caption:"First Name",name:"firstname",required:!0}),i.a.createElement(o.W,{caption:"Middle Name",name:"middlename",required:!0}),i.a.createElement(o.r,{name:"email"}),i.a.createElement(o.E,{name:"mobileno"})),i.a.createElement(o.P,null),i.a.createElement(o.T,null,"Applicant Address"),i.a.createElement(o.j,{caption:"Resident",name:"resident",onChange:function(){var e=c({},b,{resident:!b.resident,address:{}});v(e)}}),b.resident?i.a.createElement(l.i,{orgcode:n.id,name:"address",caption:"Address"}):i.a.createElement(l.j,{name:"address",caption:"Address"}),i.a.createElement(o.P,null),i.a.createElement(o.T,null,"Proof of Identity"),i.a.createElement(l.h,{name:"id"})),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){d(null),r.invoke("saveApplicant",b,(function(e,t){e?d(e):p(),m(!1)}))}})))}},{step:2,name:"location",caption:"Project Location",component:function(e){var t=e.partner,n=e.appno,r=e.appService,p=e.moveNextStep,m=Object(l.p)(t.id),s=Object(a.useState)(),u=s[0],d=s[1],f=Object(a.useState)(!1),E=f[0],b=f[1],S=Object(a.useState)("view-rpus"),j=S[0],O=S[1],x=Object(a.useState)("view"),k=x[0],w=x[1],P=Object(a.useState)(),C=P[0],W=P[1],T=Object(a.useState)([]),N=T[0],A=T[1],J=Object(a.useState)({}),I=J[0],L=J[1],B=Object(a.useState)({}),D=B[0],R=B[1];Object(a.useEffect)((function(){"view-rpus"===j&&V()}),[j]);var q=function(){W(),w("edit"),O("initial")},V=function(){r.invoke("getRpus",{appid:e.appno},(function(e,t){e?d(e):A(t)}))},F=function(){O("view-rpus")};return i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+n),i.a.createElement(o.S,null,"Project Location"),i.a.createElement(o.P,null),i.a.createElement(o.J,{visibleWhen:"view-rpus"===j},i.a.createElement(o.T,null,"Lot Information"),i.a.createElement(o.s,{msg:u}),N.map((function(e){return i.a.createElement(o.J,{style:h.locationContainer,key:e.tdno},i.a.createElement("div",{style:h.tdno},i.a.createElement(o.T,null,"TD No. "+e.tdno)),i.a.createElement("div",{style:h.rpuInfoContainer},i.a.createElement(o.y,{caption:"Title No."},e.titleno),i.a.createElement(o.y,{caption:"PIN"},e.pin),i.a.createElement(o.y,{caption:"Address"},(n=[],(t=e).lotno&&n.push("Lot: "+t.lotno),t.blockno&&n.push("Block: "+t.blockno),t.street&&n.push("Street: "+t.street),t.barangay&&n.push("Barangay: "+t.barangay),n.join(" "))),i.a.createElement(o.y,{caption:"Class"},e.classcode),i.a.createElement(o.y,{caption:"Area"},e.areasqm),i.a.createElement(o.y,{caption:"Owner"},e.owner.name)));var t,n})),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Add Lot Info",action:q}),i.a.createElement(o.e,{caption:"Next",action:function(){if(d(null),0===N.length)d("Add at least one Lot Information.");else{var e=N[0];R({lotno:e.lotno,blockno:e.blockno,barangay:m.find((function(t){return t.name===e.barangay}))}),O("specify-location")}}}))),i.a.createElement(o.J,{visibleWhen:"initial"===j},i.a.createElement(o.T,null,"Specify the Site Location/Property"),i.a.createElement(o.s,{msg:u}),i.a.createElement(o.P,null),i.a.createElement(o.W,{caption:"Tax Declaration No.",value:C,onChange:W,autoFocus:!0}),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Back to List",action:F,variant:"text"}),i.a.createElement(o.e,{caption:"Search",action:function(){b(!0),o.O.lookup((t.orgcode||t.id)+":OboOnlineService","obo").invoke("findLocation",{refno:C||newRefno},(function(t,n){t?d(t):(n.owner.resident="local"==n.owner.address.type?1:0,n.owner.address.city&&(n.owner.address.citymunicipality=n.owner.address.city),n.owner.address.municipality&&(n.owner.address.citymunicipality=n.owner.address.municipality),n.owner.ctc={},n.lotowned=1,n.appid=e.appno,L(n),O("view-lot")),b(!1)}))},disableWhen:E,loading:E}))),i.a.createElement(o.J,{visibleWhen:"view-lot"===j},i.a.createElement("p",null,"Please check carefully if the information is correct. For any discrepancies, please contact the Assessor's Office before proceeding."),i.a.createElement(o.t,{context:I,handler:L},i.a.createElement(g,{editable:!1}),i.a.createElement(y,{property:I,name:"lotowned",row:!0,editable:!1}),i.a.createElement(v,{name:"owner",orgcode:t.id,owner:I.owner,editable:!1})),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:q,caption:"Back",visibleWhen:"edit"===k}),i.a.createElement(o.e,{action:function(e){O("edit-owner-info")},caption:"Next",visibleWhen:"edit"==k}),i.a.createElement(o.e,{action:F,caption:"Back",visibleWhen:"view"===k}))),i.a.createElement(o.J,{visibleWhen:"edit-owner-info"===j},i.a.createElement("p",null,"Please update the information if necessary"),i.a.createElement(o.t,{context:I,handler:L},i.a.createElement(y,{name:"lotowned",row:!0,autoFocus:!0}),i.a.createElement(v,{name:"owner",owner:I.owner,orgcode:t.id,showIdEntry:!0})),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return O("view-lot")},caption:"Back"}),i.a.createElement(o.e,{action:function(){I.owner.id?(d(null),r.invoke("saveRpu",I,(function(e,t){e?d(e):(V(),O("view-rpus"))}))):alert("Please provide proof of identity for owner/administrator of property")},caption:"Next"}))),i.a.createElement(o.J,{visibleWhen:"specify-location"===j},i.a.createElement(o.T,null,"Specify Project Location"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:u}),i.a.createElement(o.t,{context:D,handler:R},i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{name:"lotno",caption:"Lot No."}),i.a.createElement(o.W,{name:"blockno",caption:"Block No."})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{name:"unitno",caption:"Unit No."}),i.a.createElement(o.W,{name:"bldgno",caption:"Building No."})),i.a.createElement(o.W,{name:"bldgname",caption:"Building Name"}),i.a.createElement(o.W,{name:"street",caption:"Street"}),i.a.createElement(o.W,{name:"subdivision",caption:"Subdivision"}),i.a.createElement(l.a,{barangays:m,name:"barangay",caption:"Barangay"})),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Back",action:function(){return O("view-rpus")},variant:"text"}),i.a.createElement(o.e,{caption:"Next",action:function(){d(null),r.invoke("saveLocation",c({appid:n},D),(function(e,t){e?d(e):p()}))}}))))}},{step:3,name:"project",caption:"Project Details",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,r=e.stepCompleted,p={appid:t,apptype:"NEW",worktypes:[],numfloors:1,numunits:1,occupancytype:{objid:null,group:{},division:{}}},m=Object(a.useState)(),s=m[0],u=m[1],d=(Object(a.useState)({}),Object(a.useState)(!1)[1]),f=Object(a.useState)("project-detail"),E=f[0],y=f[1],b=Object(a.useState)("group")[0],v=Object(a.useState)(p),g=v[0],h=v[1],O=Object(a.useState)([])[1],x=Object(a.useState)([])[1],k=Object(a.useState)([])[1],w=Object(a.useState)()[1],P=Object(a.useState)([]),C=P[0],W=P[1];return Object(a.useEffect)((function(){d(!0),u(null),S.invoke("getWorkTypes",null,(function(e,t){e?u(e):W(t),d(!1)}))}),[]),Object(a.useEffect)((function(){0!==C.length&&(d(!0),u(null),n.invoke("getProjectInfo",{appid:t},(function(e,t){if(e)u(e);else{if(0===t.worktypes.length)t.worktypes=C;else{var n=C.map((function(e){return t.worktypes.find((function(t){return e.objid===t}))?c({},e,{checked:!0}):e}));t.worktypes=n}t.numunits=t.numunits||1,t.numfloors=t.numfloors||1,w(t.contractor),h(t),y("project-detail")}d(!0)})))}),[C]),Object(a.useEffect)((function(){"group"===b?S.invoke("getOccupancyTypeGroups",null,(function(e,t){e?u(e):O(t)})):"division"===b?S.invoke("getOccupancyTypeDivisions",{groupid:g.occupancytype.group.objid},(function(e,t){e?u(e):x(t)})):"type"===b&&S.invoke("getOccupancyTypes",{divisionid:g.occupancytype.division.objid},(function(e,t){e?u(e):k(t)}))}),[b]),i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+t),i.a.createElement(o.S,null,"Project Details"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:s}),i.a.createElement(o.t,{visibleWhen:"project-detail"===E,context:g,handler:h},i.a.createElement(o.W,{caption:"Project Title",name:"title",required:!0,readOnly:r,autoFocus:!0}),i.a.createElement(o.W,{caption:"Project Description",name:"description",required:!0,readOnly:r}),g.occupancytypeid&&i.a.createElement(o.W,{caption:"Occupancy Type",name:"occupancytype.title",required:!0,readOnly:r}),i.a.createElement(o.P,null),i.a.createElement(o.w,{caption:"No of Units",name:"numunits",required:!0,readOnly:r}),i.a.createElement(o.J,{row:!0},i.a.createElement(o.o,{caption:"Total Floor Area [sq.meter]",name:"totalfloorarea",required:!0,readOnly:r,fullWidth:!0,textAlign:"left"}),i.a.createElement(o.o,{caption:"Building Height [meter]",name:"height",required:!0,readOnly:r,fullWidth:!0,textAlign:"left"})),i.a.createElement(o.w,{caption:"No. of Storeys",name:"numfloors",required:!0,readOnly:r}),i.a.createElement(o.P,null),i.a.createElement(o.o,{caption:"Estimated Cost [Php]",name:"projectcost",required:!0,readOnly:r,decimalScale:2,textAlign:"left"}),i.a.createElement(o.J,{row:!0},i.a.createElement(o.n,{caption:"Proposed Construction Date",name:"dtproposedconstruction",readOnly:r}),i.a.createElement(o.n,{caption:"Expected Completion Date",name:"dtexpectedcompletion",readOnly:r})),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){u(null),n.invoke("update",{appid:t,title:g.title,description:g.description,numunits:g.numunits,totalfloorarea:g.totalfloorarea,height:g.height,numfloors:g.numfloors,projectcost:g.projectcost,dtproposedconstruction:g.dtproposedconstruction,dtexpectedcompletion:g.dtexpectedcompletion},(function(e,t){e?u(e):(u(null),d(!1),y("select-worktype"))}))}}))),i.a.createElement(o.t,{visibleWhen:"select-worktype"===E,context:g,handler:h},i.a.createElement(o.T,null,"Select Work Types"),i.a.createElement(o.J,{style:j.column},g.worktypes.map((function(e,t){return i.a.createElement(o.j,{caption:e.name,name:"worktypes["+t+"].checked",value:e.objid})}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return y("project-detail")}}),i.a.createElement(o.e,{caption:"Next",action:function(){if(u(null),g.worktypes.findIndex((function(e){return!0===e.checked}))>=0){u(null);var e={appid:t,worktypes:g.worktypes.filter((function(e){return e.checked})).map((function(e){return e.objid}))};n.invoke("update",e,(function(e,t){e?u(s):(d(!1),l())}))}else u("Please check at least one work type.")}})),i.a.createElement("p",null,JSON.stringify(g.worktypes,null,2))))}},{step:4,name:"contractor",caption:"Contractor",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c={appid:t,apptype:"NEW"},r=Object(a.useState)(),p=r[0],m=r[1],s=(Object(a.useState)({}),Object(a.useState)(!1),Object(a.useState)(c)[1]),u=Object(a.useState)(),d=u[0],f=u[1];Object(a.useEffect)((function(){n.invoke("getProjectInfo",{appid:t},(function(e,t){e?m(e):(f(t.contractor),s(t))}))}),[]);var E=function(e){if(0!==e.length){var a=e[0];n.invoke("update",{appid:t,contractorid:a.objid},(function(e,t){e?m(e):(m(null),f(a))}))}else f({})};return i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+t),i.a.createElement(o.S,null,"Project Details"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:p}),i.a.createElement(o.J,null,i.a.createElement("label",null,"Specify full time inspector and supervisor of construction work"),i.a.createElement(o.P,{height:10}),d&&d.lastname&&i.a.createElement(o.J,null,i.a.createElement(k,{caption:"Inspector/Supervisor",professional:d,onSelectProfessional:E})),(!d||!d.lastname)&&i.a.createElement(x,{caption:"Search Professional",onSelect:E,fullWidth:!1}),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){d?l():m("Please select a professional.")},disableWhen:!d||!d.objid}))))}},{step:5,name:"project",caption:"Occupancy Type",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c=Object(a.useState)(),r=c[0],p=c[1],m=Object(a.useState)(!1)[1],s=Object(a.useState)("select-occupancytype")[0],u=Object(a.useState)("group"),d=u[0],f=u[1],E=Object(a.useState)({}),y=E[0],b=E[1],v=Object(a.useState)([]),g=v[0],h=v[1],S=Object(a.useState)([]),j=S[0],O=S[1],x=Object(a.useState)([]),k=x[0],w=x[1],C=Object(a.useState)(!1)[1],T=Object(a.useState)(!1)[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){e?p(e):(b({occupancytype:t.occupancytype}),C(t.occupancytype.objid))}))}),[]),Object(a.useEffect)((function(){"group"===d?P.invoke("getOccupancyTypeGroups",null,(function(e,t){e?p(e):h(t)})):"division"===d?P.invoke("getOccupancyTypeDivisions",{groupid:y.occupancytype.group.objid},(function(e,t){e?p(e):O(t)})):"type"===d&&P.invoke("getOccupancyTypes",{divisionid:y.occupancytype.division.objid},(function(e,t){e?p(e):w(t)}))}),[d]),i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+t),i.a.createElement(o.S,null,"Occupancy Type"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:r}),i.a.createElement(o.J,{visibleWhen:"select-occupancytype"===s},i.a.createElement(o.t,{visibleWhen:"group"===d,context:y,handler:b},i.a.createElement(o.T,null,"Select Occupancy Group"),i.a.createElement(o.L,{name:"occupancytype.group.objid",list:g,Control:W}),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){y.occupancytype.group.objid?f("division"):p("Kindly select an occupancy group.")}}))),i.a.createElement(o.t,{visibleWhen:"division"===d,context:y,handler:b},i.a.createElement(o.T,null,"Select Occupancy Group Division"),i.a.createElement(o.L,{name:"occupancytype.division.objid",list:j,Control:W}),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Back",action:function(){return f("group")}}),i.a.createElement(o.e,{caption:"Next",action:function(){y.occupancytype.division.objid?f("type"):p("Kindly select an occupancy division group.")}}))),i.a.createElement(o.t,{visibleWhen:"type"===d,context:y,handler:b},i.a.createElement(o.T,null,"Select Occupancy Type"),i.a.createElement(o.L,{name:"occupancytype.objid",list:k,Control:W}),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Back",action:function(){return f("division")}}),i.a.createElement(o.e,{caption:"Next",action:function(){y.occupancytype.objid?n.invoke("updateOccupancyType",{appid:t,occupancytype:y.occupancytype},(function(e,t){e?p(e):(p(null),m(!1),T(!1),l())})):p("Kindly select an occupancy type.")}})))))}},{step:6,name:"accessories",caption:"Accessories",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c=Object(a.useState)(),r=c[0],p=c[1],m=(Object(a.useState)(!1),Object(a.useState)("initial")),s=m[0],u=m[1],d=Object(a.useState)("TRUE"),f=d[0],E=d[1],y=Object(a.useState)([]),b=y[0],v=y[1],g=Object(a.useState)([]),h=g[0],S=g[1],j=Object(a.useState)([]),O=j[0],x=j[1],k=function(){n.invoke("getAccessories",{appid:t},(function(e,t){v(t),function(e){return!!(e.length>0&&/j.*/i.test(e[0].occupancytypeid))}(t)&&u("infos")}))};return Object(a.useEffect)((function(){o.O.lookup("OboMiscListService","obo").invoke("getAccessoryOccupancyTypes",null,(function(e,t){if(e)p(e);else{var n={};t.forEach((function(e){n[""+e.objid.toLowerCase()]=!1})),x(t),S(n)}})),k()}),[]),i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+t),i.a.createElement(o.S,null,"Accessories"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:r}),i.a.createElement(o.J,{visibleWhen:"initial"===s},i.a.createElement("p",null,"Does the plan include accessories?"),i.a.createElement(o.L,{name:"hasAccessories",value:f,onChange:E},i.a.createElement(o.x,{caption:"Yes",value:"TRUE"}),i.a.createElement(o.x,{caption:"No",value:"FALSE"})),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){"TRUE"===f?u("select-accessories"):(p(null),n.invoke("saveAccessories",{appid:t,items:[]},(function(e,t){e?p(e):l()})))}}))),i.a.createElement(o.J,{visibleWhen:"select-accessories"===s},i.a.createElement(o.T,null,"Select accessory to add if applicable"),i.a.createElement(o.t,{context:h,handler:S},O.map((function(e){return i.a.createElement(o.j,{key:e.objid,caption:e.title,name:""+e.objid.toLowerCase()})}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return u("initial")}}),i.a.createElement(o.e,{caption:"Next",action:function(){if(Object.keys(h).length>0){var e=function(){var e=[];for(var n in h)h[n]&&e.push(n);return{appid:t,items:e}}();n.invoke("saveAccessories",e,(function(e,t){e?p(e):(k(),u("infos"))}))}else p("Select at least one accessory type before proceeding.")}}))),i.a.createElement(o.t,{visibleWhen:"infos"===s,context:b,handler:v},b.map((function(e,t){return i.a.createElement("div",{key:e.objid},i.a.createElement(o.y,{style:J.infoTitle},e.type.title),e.infos.map((function(e,n){return i.a.createElement(N,{key:e.name+":"+t+":"+n,name:"["+t+"].infos["+n+"].value",dataType:e.datatype,caption:e.caption,unit:e.unit})})))})),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return u("select-accessories")}}),i.a.createElement(o.e,{caption:"Next",action:function(){var e={appid:t,infos:[]};b.forEach((function(t){var n;(n=e.infos).push.apply(n,t.infos)})),n.invoke("saveAccessoryInfos",e,(function(e,t){e?p(e):l()}))}}))))}},{step:7,name:"ancillarylist",caption:"Other Permits",component:function(e){var t,n,l,r=e.appno,p=e.appService,m=e.moveNextStep,s=Object(a.useState)(!1),u=s[0],d=s[1],f=Object(a.useState)(),E=f[0],y=f[1],b=Object(a.useState)(!1)[1],v=Object(a.useState)("permit-list"),g=v[0],h=v[1],S=Object(a.useState)([]),j=S[0],O=S[1],x=Object(a.useState)([]),w=x[0],P=x[1],C=Object(a.useState)({worktypes:[],type:{}}),W=C[0],T=C[1],A=function(){p.invoke("getAncillaryPermits",{appid:r},(function(e,t){e?y(e):(P(t),u||0!==t.length||(d(!0),h("available-list")))}))};Object(a.useEffect)((function(){p.invoke("getAvailableAncillaryPermitTypes",{appid:r},(function(e,t){e?y(e):O(t)}))}),[w]),Object(a.useEffect)((function(){A()}),[g,u]);var J=!1;w.length>0&&(J=w.findIndex((function(e){return!e.designprofessionalid}))>=0);var L=null;return i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+r),i.a.createElement(o.S,null,"Other Permits"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:E}),i.a.createElement(o.J,{visibleWhen:"permit-list"===g},i.a.createElement(o.P,null),w.map((function(e){return i.a.createElement(o.J,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement(o.J,{row:!0},e.designprofessionalid?i.a.createElement("div",{style:{width:40}},i.a.createElement(o.i,{style:{color:"green",paddingRight:10}})):i.a.createElement("div",{style:{width:40}}),i.a.createElement("label",null,e.type.title)),i.a.createElement(o.J,{row:!0},i.a.createElement(o.q,{action:function(){p.invoke("getAncillaryPermit",{objid:e.objid},(function(e,t){e?y(e):(y(null),function(e){o.O.lookup("OboMiscListService","obo").invoke("getWorkTypes",{typeid:e.type.objid},(function(t,n){t?y(t):n&&n.length>0?(n.forEach((function(t){e.worktypes.findIndex((function(e){return e.toLowerCase()===t.name.toLowerCase()}))>=0&&(t.checked=!0)})),T(c({},e,{worktypes:n})),h("select-worktypes")):(h(e.infos.length>0?"infos":1===e.type.includecost?"cost":"professional"),T(e))}))}(t))}))},size:"small"}),i.a.createElement(o.p,{action:function(){return t=e,void p.invoke("removeAncillaryPermit",{objid:t.objid},(function(e,t){e?y(e):(y(null),A())}));var t},size:"small"})))})),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Add New Permits",action:function(){return h("available-list")}}),i.a.createElement(o.e,{caption:"Next",action:function(){var e=[];w.forEach((function(t){t.designprofessionalid||e.push(t.type.title)})),1===e.length?y("Permit "+e[0]+" is not processed"):e.length>1?y("The following permist are not processed: "+e.join(",")):m()},disableWhen:J}))),i.a.createElement(o.t,{visibleWhen:"select-worktypes"===g,context:W,handler:T},i.a.createElement("h4",null,W.type.title),i.a.createElement(o.T,null,"Select Work Types"),i.a.createElement(o.J,{style:I.workTypeContainer},W.worktypes.map((function(e,t){return i.a.createElement(o.j,{caption:e.name.toUpperCase(),name:"worktypes["+t+"].checked",value:e.name})}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return h("permit-list")}}),i.a.createElement(o.e,{caption:"Next",action:function(){y(null),y(null);var e={objid:W.objid,worktypes:W.worktypes.filter((function(e){return e.checked})).map((function(e){return e.name}))};p.invoke("updateAncillaryPermit",e,(function(e,t){e?y(E):(h("infos"),b(!1))}))}}))),i.a.createElement(o.t,{visibleWhen:"infos"===g,context:W,handler:T},i.a.createElement(o.T,null,null===(t=W.type)||void 0===t?void 0:t.title),i.a.createElement(o.P,null),i.a.createElement("p",null,"Please fill the applicable values and click Save and Complete when done."),W.infos&&W.infos.map((function(e,t){var n=null;return null!==L&&L.category===e.category||(n=e.category,L=e),i.a.createElement(N,{key:e.name+":"+t,name:"infos["+t+"].value",category:n,dataType:e.datatype,caption:e.caption,unit:e.unit})})),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){h(W.worktypes&&W.worktypes.length>0?"select-worktypes":"permit-list")}}),i.a.createElement(o.e,{caption:"Next",action:function(){p.invoke("updateAncillaryPermit",{objid:W.objid,projectcost:W.projectcost,equipmentcost:W.equipmentcost},(function(e,t){e?y(e):h(1===W.type.includecost?"cost":"professional")}))}}))),i.a.createElement(o.J,{visibleWhen:"available-list"===g},i.a.createElement(o.T,null,"Select ancillary and other permits to include in the project"),i.a.createElement(o.t,{context:j,handler:O,style:I.itemsContainer},j.map((function(e,t){return i.a.createElement(o.j,{key:e.objid,caption:e.title,name:"["+t+"].selected"})}))),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){var e=j.filter((function(e){return!0===e.selected}));e.length>0?(P(e),p.invoke("saveAncillaryPermits",{appid:r,permits:e},(function(e,t){e?y(e):(y(null),h("permit-list"))}))):h("permit-list")}}))),i.a.createElement(o.t,{visibleWhen:"cost"===g,context:W,handler:T},i.a.createElement(o.T,null,null===(n=W.type)||void 0===n?void 0:n.title),i.a.createElement(o.o,{name:"projectcost",caption:"Project Cost",textAlign:"left",fullWidth:!1}),i.a.createElement(o.o,{name:"equipmentcost",caption:"Equipment Cost",textAlign:"left"}),i.a.createElement(o.P,null),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return h("infos")}}),i.a.createElement(o.e,{caption:"Next",action:function(){y(null),p.invoke("saveAncillaryPermit",{objid:W.objid,infos:W.infos},(function(e,t){e?y(e):h("professional")}))}}))),i.a.createElement(o.t,{visibleWhen:"professional"===g,context:W,handler:T},i.a.createElement(o.T,null,null===(l=W.type)||void 0===l?void 0:l.title),i.a.createElement(o.P,null),i.a.createElement(k,{caption:"Design Professional",professional:W.designprofessional,onSelectProfessional:function(e){var t=e[0];T(c({},W,{designprofessional:t,designprofessionalid:t.objid}))}}),i.a.createElement(o.P,null),i.a.createElement(k,{caption:"Supervisor in Charge Professional",professional:W.supervisor,onSelectProfessional:function(e){var t=e[0];T(c({},W,{supervisor:t,supervisorid:t.objid}))}}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return h("permit-list")}}),i.a.createElement(o.e,{caption:"Save and Complete",action:function(){if(y(null),W.designprofessionalid)if(W.supervisorid){var e=c({},W,{worktypes:W.worktypes.filter((function(e){return e.checked})).map((function(e){return e.name}))});p.invoke("saveAncillaryPermit",e,(function(e,t){e?y(e):h("permit-list")}))}else y("Supervisor is required.");else y("Design Professional is required.")}}))))}},{step:8,name:"confirm",caption:"Confirm",component:function(e){var t=e.partner,n=e.appno,l=e.appService,c=e.moveNextStep,r=Object(a.useState)(!1),p=r[0],m=r[1],s=Object(a.useState)()[1],u=Object(a.useState)(!1),d=u[0],f=u[1],E=Object(a.useState)({}),y=E[0],b=E[1],v=Object(a.useState)([]),g=v[0],h=v[1],S=Object(a.useState)(!1),j=S[0],O=S[1],x=function(){s(null),f(!1)};Object(a.useEffect)((function(){f(!0),l.invoke("getApplication",{appid:n},(function(e,t){e?s(e):(b(t),x())})),f(!0),l.invoke("getAncillaryPermits",{appid:n},(function(e,t){e?s(e):(h(t),x())}))}),[]);var k=[];return g.forEach((function(e){k.push({title:e.permittypeid.toUpperCase(),Icon:o.I,href:"/jreports/obo/"+e.permittypeid+"permit?refid="+e.objid})})),i.a.createElement(o.J,null,i.a.createElement("label",null,"Tracking No. "+n),i.a.createElement(o.S,null,"Confirm Application"),i.a.createElement(o.P,null),i.a.createElement(o.M,{title:"Building Permit Application",items:k,open:j,style:{},onClose:function(){O(!1)}}),i.a.createElement(o.G,{open:p,type:"confirm",msg:"Permit processing will now be completed. Make sure that all information are correct.",onAccept:function(){m(!1),c()},onCancel:function(){return m(!1)}}),i.a.createElement(o.C,{visibleWhen:d}),i.a.createElement("p",null,"Please confirm the info and preview each permit application before submitting"),i.a.createElement(o.t,{visibleWhen:!d,context:y,handler:b},i.a.createElement(o.J,{style:L.container},i.a.createElement(o.J,{style:L.linkContainer},i.a.createElement(o.f,{caption:"Preview",href:"/jreports/partner/"+t.group.name+"_"+t.name+"/obo/buildingpermit?refid="+n,Icon:o.I}),i.a.createElement(o.f,{caption:"Download",href:"/jreports/download/partner/"+t.group.name+"_"+t.name+"/obo/buildingpermit?refid="+n,Icon:o.k})),i.a.createElement(o.J,null,i.a.createElement(o.W,{caption:"Tracking No.",name:"objid",readOnly:!0}),i.a.createElement(o.W,{caption:"Project Title",name:"title",readOnly:!0}),i.a.createElement(o.W,{caption:"Project Location",expr:function(){if(!y.location)return"";var e=[];return y.location.lotno&&e.push("Lot: "+y.location.lotno),y.location.blockno&&e.push("Block: "+y.location.blockno),y.location.street&&e.push("Street: "+y.location.street),y.location.barangay.name&&e.push("Barangay: "+y.location.barangay.name),e.join(" ")},readOnly:!0}),i.a.createElement(o.P,null),i.a.createElement(o.W,{caption:"Applicant",name:"applicant.name",readOnly:!0}),i.a.createElement(o.W,{caption:"Occupancy Type",name:"occupancytype.title",readOnly:!0}),i.a.createElement(o.W,{caption:"Type of Work",expr:function(){var e,t="";return y.worktypes&&y.worktypes.length>0&&(t=null===(e=y.worktypes)||void 0===e?void 0:e.join(",")),t},readOnly:!0}),i.a.createElement(o.W,{caption:"Supervisor in Charge of Construction",expr:function(){var e="";return y.contractor&&(e=y.contractor.lastname+", "+y.contractor.firstname+" "+y.contractor.middlename),e},readOnly:!0})),i.a.createElement(o.J,null,i.a.createElement(o.J,{row:!0},i.a.createElement(o.w,{caption:"No. of Units",name:"numunits",readOnly:!0}),i.a.createElement(o.w,{caption:"No. of Floors",name:"numfloors",readOnly:!0}),i.a.createElement(o.o,{caption:"Bldg. Height",name:"height",readOnly:!0,textAlign:"left"})),i.a.createElement(o.P,null),i.a.createElement(o.J,{row:!0},i.a.createElement(o.o,{caption:"Total Area (sqm)",name:"totalfloorarea",readOnly:!0,textAlign:"left",fullWidth:!0}),i.a.createElement(o.o,{caption:"Project Cost",name:"projectcost",readOnly:!0,textAlign:"left",fullWidth:!0})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"Est. Start Date",name:"dtproposedconstruction",readOnly:!0}),i.a.createElement(o.W,{caption:"Est. Completion Date",name:"dtexpectedcompletion",readOnly:!0})))),i.a.createElement(o.P,null),i.a.createElement(o.J,{style:L.ancillaryContainer},i.a.createElement(o.T,{style:L.label},"Other Permits"),i.a.createElement(o.J,{visibleWhen:g.length>0},g.map((function(e){return i.a.createElement(o.J,{style:L.ancillaryItem},i.a.createElement("label",{style:{marginLeft:20}},e.type.title),i.a.createElement(o.J,{row:!0},i.a.createElement(o.f,{caption:"Preview",href:"/jreports/partner/"+t.group.name+"_"+t.name+"/obo/"+e.permittypeid+"permit?refid="+e.objid,Icon:o.I}),i.a.createElement(o.f,{caption:"Download",href:"/jreports/download/partner/"+t.group.name+"_"+t.name+"/obo/"+e.permittypeid+"permit?refid="+e.objid,Icon:o.k})))})))),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Submit",action:function(){m(!0)}}))))}},{step:9,name:"completed",caption:"Completed",component:function(e){var t=e.partner,n=e.appno,l=e.appService,c=Object(a.useState)(),r=c[0],p=c[1],m=Object(a.useState)(!1)[1],s=Object(a.useState)({}),u=s[0],d=s[1],f=Object(a.useState)([]),E=f[0],y=f[1],b=Object(a.useState)(!1),v=b[0],g=b[1],h=function(){p(null),m(!1)};Object(a.useEffect)((function(){m(!0),l.invoke("getProjectInfo",{appid:n},(function(e,t){e?p(e):(d(t),h())})),m(!0),l.invoke("getAncillaryPermits",{appid:n},(function(e,t){e?p(e):(y(t),h())}))}),[]);var S=[];u.location&&(u.location.lotno&&S.push("Lot: "+u.location.lotno),u.location.blockno&&S.push("Block: "+u.location.blockno),u.location.street&&S.push("Street: "+u.location.street),u.location.barangay.name&&S.push("Barangay: "+u.location.barangay.name));var j="";u.contractor&&(j=u.contractor.lastname+", "+u.contractor.firstname+" "+u.contractor.middlename,j+="\n"+u.contractor.profession,j+=" PRC NO.: "+u.contractor.prc.idno+" Issued: "+u.contractor.prc.dtissued);var O=[];E.forEach((function(e){O.push({title:e.permittypeid.toUpperCase(),icon:"",href:"/jreports/obo/"+e.permittypeid+"permit?refid="+e.objid})}));var x=function(e){void 0===e&&(e={});var t="";t+="Please download and print the Building and Ancillary Permit forms, prepare the ",t+="requirements listed below, and submit at the receiving window of our ",t+=e.officename,t+=" at the ",t+=e.address1,t+=e.address2?", "+e.address2+". ":". ";var n=[];return e.phoneno&&n.push(e.phoneno),e.mobileno&&n.push(e.mobileno),e.email?(n.length>0?(t+="You can email at "+e.email,t+=" or contact us on "+n.join(" or ")):t+="You can email us at "+e.email,t+=" for any inquiries on application."):n.length>0&&(t+="You can contact us on "+n.join(" or ")+" for any inquiries on application."),t}(u.obocontactinfo);return i.a.createElement(o.J,null,i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:r}),i.a.createElement(o.M,{title:"Building Permit Application",items:O,open:v,style:{},onClose:function(){g(!1)}}),i.a.createElement(o.t,{context:u,handler:d},i.a.createElement("label",null,x),i.a.createElement(o.P,{height:10}),i.a.createElement(o.J,{style:B.container},i.a.createElement(o.J,{style:B.linkContainer},i.a.createElement(o.f,{caption:"Preview",href:"/jreports/partner/"+t.group.name+"_"+t.name+"/obo/buildingpermit?refid="+n,Icon:o.I}),i.a.createElement(o.f,{caption:"Download",href:"/jreports/download/partner/"+t.group.name+"_"+t.name+"/obo/buildingpermit?refid="+n,Icon:o.k})),i.a.createElement(o.J,{style:B.infoContainer},i.a.createElement(o.W,{caption:"Tracking No.",name:"objid",readOnly:!0}),i.a.createElement(o.W,{caption:"Project Title",name:"title",readOnly:!0}),i.a.createElement(o.W,{caption:"Location",expr:function(){return S.join(" ,")},readOnly:!0}),i.a.createElement(o.W,{caption:"Applicant",name:"applicant.name",readOnly:!0}),i.a.createElement(o.o,{caption:"Project Cost",name:"projectcost",readOnly:!0,textAlign:"left"}),i.a.createElement(o.J,{row:!0},i.a.createElement(o.n,{caption:"Est. Start Date",name:"dtproposedconstruction",readOnly:!0}),i.a.createElement(o.n,{caption:"Est. End Date",name:"dtexpectedcompletion",readOnly:!0})),i.a.createElement(o.W,{caption:"Supervisor/In Charge of Project",expr:function(){return j},readOnly:!0,multiline:!0,rows:2})))),i.a.createElement(o.P,null),i.a.createElement(o.J,{style:B.ancillaryContainer},i.a.createElement(o.T,{style:B.label},"Other Permits"),i.a.createElement(o.J,{visibleWhen:E.length>0},E.map((function(e){return i.a.createElement(o.J,{style:B.ancillaryItem},i.a.createElement("label",{style:{marginLeft:20}},e.type.title),i.a.createElement(o.J,{row:!0},i.a.createElement(o.f,{caption:"Preview",href:"/jreports/partner/"+t.group.name+"_"+t.name+"/obo/"+e.permittypeid+"permit?refid="+e.objid,Icon:o.I}),i.a.createElement(o.f,{caption:"Download",href:"/jreports/download/partner/"+t.group.name+"_"+t.name+"/obo/"+e.permittypeid+"permit?refid="+e.objid,Icon:o.k})))})))))}}],q=function(e){var t=Object(a.useState)(!1)[1],n=Object(a.useState)(!1),l=n[0],r=n[1],m=Object(a.useState)("apptype"),s=m[0],u=m[1],d=(Object(a.useState)("new"),Object(a.useState)(Object(o.db)(e.location,"appid"))),E=d[0],y=d[1],b=Object(a.useState)({step:1}),v=b[0],g=b[1],h=Object(a.useState)(1),S=h[0],j=h[1],O=Object(a.useState)({}),x=O[0],k=O[1],w=e.partner,P=e.service,C=e.history;if(Object(a.useEffect)((function(){E&&(t(!0),D.invoke("findCurrentInfo",{appid:E},(function(e,n){var a=w.orgcode||w.id;e?r(e):n?a!=n.orgcode?r("The application number provided is not for this local government"):(g(n),j(n.step),u("processing")):r("Application no. does not exist"),t(!1)})))}),[E]),"apptype"===s)return i.a.createElement(p,{service:P,error:l,onCancel:C.goBack,onSubmit:function(e){var t=e.appType,n=e.appno;"new"===t?u(t):n?y(n):k(c({},x,{appno:"Tracking No. is required"}))}});if("new"===s)return i.a.createElement(f,c({},e,{handler:function(e){y(e),u("processing")},onCancel:function(){return e.history.goBack()}}));var W=R[S],T=W.component,N={partner:w,appno:E,pages:R,moveNextStep:function(){S<v.step&&1!==S?j((function(e){return e+1})):D.invoke("update",{appid:E,step:S+1},(function(e,t){e?r(e):(j(t.step),g(c({},v,{step:t.step})))}))},appService:D,saveHandler:function(){console.log("SAVE HANDLER")},stepCompleted:S<v.step};return i.a.createElement(o.H,null,v.step<9&&i.a.createElement(o.J,{target:"left",style:V.stepperContainer},i.a.createElement(o.R,{steps:R,completedStep:v.step,activeStep:S,handleStep:function(e){j(e)}})),i.a.createElement(o.g,null,i.a.createElement(o.X,null,P.title),i.a.createElement(T,c({page:W},N))))},V={stepperContainer:{paddingTop:30,paddingLeft:40}},F=[{name:"email",title:"Email Verification"},{name:"specifybldgpermit",title:"Specify Building Permit"},{name:"verifybldgpermit",title:"Verify Building Permit Information"},{name:"confirmation",title:"Confirmation"},{name:"newapp",title:"New Application "}],U=function(e){var t=e.partner,n=e.service,c=e.onComplete,r=e.appService,p=e.onCancel,u=Object(a.useState)(),d=u[0],f=u[1],E=Object(a.useState)({}),y=E[0],b=E[1],v=Object(a.useState)({}),g=v[0],h=v[1],S=Object(a.useState)("new")[0],j=Object(a.useState)(),O=j[0],x=j[1],k=Object(a.useState)(),w=k[0],P=k[1],C=Object(a.useState)({}),W=C[0],T=C[1],N=Object(a.useState)(0),A=N[1],J=F[N[0]],I=function(){A((function(e){return e+1}))},L=function(){A((function(e){return e-1}))};return i.a.createElement(o.H,null,"email"===J.name?i.a.createElement(l.g,{title:n.title,showName:!0,onCancel:p,onVerify:function(e){h(e),I()},partner:t,connection:"obo"}):i.a.createElement(o.g,null,i.a.createElement(o.J,{visibleWhen:"specifybldgpermit"===J.name},i.a.createElement(o.X,null,n.title),i.a.createElement(o.S,null,J.title),i.a.createElement(o.P,{height:30}),i.a.createElement(o.W,{caption:"Building Permit No.",value:w,onChange:P,variant:"outlined",fullWidth:!1,required:!0,error:y.bldgPermitNo||d,helperText:y.bldgPermitNo||d,size:"small",autoFocus:!0}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:L}),i.a.createElement(o.e,{caption:"Next",action:function(){w?(f(null),o.O.lookup(t.id+":OboOnlineService","obo").invoke("findBldgPermitNo",{permitno:w},(function(e,t){e?f(e):(T(t),I())}))):b({bldgPermitNo:"Please specify the Building Permit No."})}}))),i.a.createElement(o.t,{visibleWhen:"verifybldgpermit"===J.name,context:W,handler:T},i.a.createElement(o.S,null,"Verify Building Permit Information"),i.a.createElement(o.P,{height:30}),i.a.createElement(o.W,{caption:"Building Permit No.",name:"permitno",readOnly:!0}),i.a.createElement(o.W,{caption:"Applicant",name:"applicant.name",readOnly:!0}),i.a.createElement(o.P,null),i.a.createElement(o.W,{caption:"Project Title",name:"title",readOnly:!0}),i.a.createElement(o.W,{caption:"Location",name:"location.text",readOnly:!0}),i.a.createElement(o.o,{caption:"Project Cost",name:"projectcost",readOnly:!0}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:L}),i.a.createElement(o.e,{caption:"Next",action:function(){I()}}))),i.a.createElement(o.J,{visibleWhen:"confirmation"===J.name},i.a.createElement(m,{partner:t,error:d,onCancel:L,onContinue:function(){r.invoke("create",{orgcode:t.id,apptype:S,permittype:W.apptype,applicant:W.applicant,bldgpermit:W,contact:g},(function(e,t){e?f(e):(x(t.objid),I())}))}})),i.a.createElement(o.J,{visibleWhen:"newapp"===J.name,width:400},i.a.createElement(s,{appno:O,onContinue:function(){c({appType:"new",appno:O})}}))))},z={container:{display:"flext",flexDirection:"column",justifyContent:"flex-start"},columnTitle:{fontWeight:"bold",textAlign:"center",width:300,padding:10},row:{display:"flex",flexDirection:"row",alignItems:"center"},label:{width:"100%"},item:{width:300,marginRight:10}},H={container:{display:"flext",flexDirection:"column",justifyContent:"flex-start"},row:{display:"flex",flexDirection:"row",alignItems:"center"},label:{width:"100%"},item:{width:300,marginRight:10}},M={container:{display:"flext",flexDirection:"column",justifyContent:"flex-start"},row:{display:"flex",flexDirection:"row",alignItems:"center"},label:{width:"100%"},item:{width:300,marginRight:10}},_={container:{maxWidth:350,marginLeft:50},row:{display:"flex",justifyContent:"space-between",alignItems:"center"},label:{fontWeight:"bold"}},X=o.O.lookup("OnlineOccupancyPermitService","obo"),G=[{step:0,component:null},{step:1,name:"apptype",caption:"Application Type",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c=Object(a.useState)(),r=c[0],p=c[1],m=(Object(a.useState)(!1),Object(a.useState)({})),s=m[0],u=m[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){e?p(e):u(t)}))}),[]),i.a.createElement(o.J,null,i.a.createElement(o.s,{msg:r}),i.a.createElement(o.t,{context:s,handler:u},i.a.createElement(o.L,{name:"apptype"},i.a.createElement(o.x,{caption:"Full (Completed)",value:"full"}),i.a.createElement(o.x,{caption:"Partial",value:"partial"}))),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){n.invoke("update",{objid:s.objid,apptype:s.apptype},(function(e,t){e?p(e):l()}))}})))}},{step:2,name:"plannedactual",caption:"Planned vs Actual",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c=e.movePrevStep,r=Object(a.useState)()[1],p=Object(a.useState)({}),m=p[0],s=p[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){e?r(e):s(t)}))}),[t]),i.a.createElement(o.J,{style:{maxWidth:600}},i.a.createElement(o.y,null,"Please indicate the actual values of construction."),i.a.createElement(o.P,null),i.a.createElement(o.t,{context:m,handler:s,style:z.container},i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"",style:z.label}),i.a.createElement("div",{style:z.columnTitle},"Planned"),i.a.createElement("div",{style:z.columnTitle},"Actual")),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"Total Floor Area (sqm)",style:z.label}),i.a.createElement(o.o,{name:"bldgpermit.totalfloorarea",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.o,{name:"actualtotalfloorarea",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"Project Total Cost",style:z.label}),i.a.createElement(o.o,{name:"bldgpermit.projectcost",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.o,{name:"actualprojectcost",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"No. of Units",style:z.label}),i.a.createElement(o.o,{name:"bldgpermit.numunits",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.o,{name:"actualnumunits",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"No. of Floors",style:z.label}),i.a.createElement(o.o,{name:"bldgpermit.numfloors",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.o,{name:"actualnumfloors",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"Height (m)",style:z.label}),i.a.createElement(o.o,{name:"bldgpermit.height",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.o,{name:"actualheight",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"Start Date",style:z.label}),i.a.createElement(o.n,{name:"bldgpermit.dtproposedconstruction",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.n,{name:"dtactualstarted",style:z.item,fullWdith:!1,variant:"outlined"})),i.a.createElement(o.J,{style:z.row},i.a.createElement(o.y,{caption:"Completion Date",style:z.label}),i.a.createElement(o.n,{name:"bldgpermit.dtexpectedcompletion",disabled:!0,variant:"outlined",style:z.item,fullWdith:!1}),i.a.createElement(o.n,{name:"dtactualcompleted",style:z.item,fullWdith:!1,variant:"outlined"}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:c}),i.a.createElement(o.e,{caption:"Next",action:function(){n.invoke("update",m,(function(e,t){e?r(e):l()}))}})))}},{step:3,name:"actualcost",caption:"Actual Cost",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,r=e.movePrevStep,p=Object(a.useState)(),m=p[0],s=p[1],u=Object(a.useState)({}),d=u[0],f=u[1],E=Object(a.useState)({items:[{caption:"Total Materials Cost",field:"totalmaterialcost",value:0},{caption:"Total Direct Cost",field:"totaldirectlaborcost",value:0},{caption:"Total Equipment Cost",field:"totalequipmentcost",value:0},{caption:"Total Other Cost",field:"totalothercost",value:0}]}),y=E[0],b=E[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){if(e)s(e);else{f(t);var n=c({},y);n.items.forEach((function(e){e.value=t[e.field]})),b(n)}}))}),[t]),i.a.createElement(o.J,{style:{maxWidth:600}},i.a.createElement(o.S,null,"Actual Costs"),i.a.createElement(o.y,null,"Please indicate the actual cost of construction."),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:m}),i.a.createElement(o.t,{context:y,handler:b,style:H.container},y.items.map((function(e,t){return i.a.createElement(o.J,{key:e.field,style:H.row},i.a.createElement(o.y,{caption:e.caption,style:H.label}),i.a.createElement(o.o,{name:"items["+t+"].value",variant:"outlined",style:H.item,fullWdith:!1}))}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:r}),i.a.createElement(o.e,{caption:"Next",action:function(){var e=c({},d);y.items.forEach((function(t){e[t.field]=t.value})),n.invoke("update",e,(function(e,t){e?s(e):l()}))}})))}},{step:4,name:"othercost",caption:"Other Cost",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,r=e.movePrevStep,p=Object(a.useState)(),m=p[0],s=p[1],u=Object(a.useState)({}),d=u[0],f=u[1],E=Object(a.useState)({items:[{caption:"Fire Alarm Cost",field:"firealarmcost",value:0},{caption:"Sprinkler Cost",field:"sprinklercost",value:0},{caption:"LPG Piping Cost",field:"lpgpipingcost",value:0},{caption:"Fire Suppression System Cost",field:"firesuppcost",value:0}]}),y=E[0],b=E[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){if(e)s(e);else{f(t);var n=c({},y);n.items.forEach((function(e){e.value=t[e.field]})),b(n)}}))}),[t]),i.a.createElement(o.J,{style:{maxWidth:600}},i.a.createElement(o.S,null,"Other Costs"),i.a.createElement(o.y,null,"Please indicate the other cost of construction."),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:m}),i.a.createElement(o.t,{context:y,handler:b,style:M.container},y.items.map((function(e,t){return i.a.createElement(o.J,{key:e.field,style:M.row},i.a.createElement(o.y,{caption:e.caption,style:M.label}),i.a.createElement(o.o,{name:"items["+t+"].value",variant:"outlined",style:M.item,fullWdith:!1}))}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:r}),i.a.createElement(o.e,{caption:"Next",action:function(){var e=c({},d);y.items.forEach((function(t){e[t.field]=t.value})),n.invoke("update",e,(function(e,t){e?s(e):l()}))}})))}},{step:5,name:"contractor",caption:"Contractor",component:function(e){var t=e.appno,n=e.appService,l=e.moveNextStep,c=e.movePrevStep,r=Object(a.useState)()[1],p=Object(a.useState)({}),m=p[0],s=p[1],u=Object(a.useState)(!1),d=u[0],f=u[1];return Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){e?r(e):s(t)}))}),[t]),i.a.createElement(o.J,null,i.a.createElement(o.S,null,"Contractor"),i.a.createElement(o.y,null,"Please specify contractor if available"),i.a.createElement(o.P,null),i.a.createElement(o.j,{value:d,onChange:f,caption:"Is undertaken by a Contractor?"}),i.a.createElement(o.t,{visibleWhen:d,context:m,handler:s},i.a.createElement(o.W,{name:"contractor.name",caption:"Contractor",required:!0}),i.a.createElement(o.W,{name:"contractor.address",caption:"Address",required:!0}),i.a.createElement(o.W,{name:"contractor.pcabno",caption:"PCAB License No.",required:!0}),i.a.createElement(o.n,{name:"contractor.pcabvalidaty",caption:"Validity Date",required:!0}),i.a.createElement(o.W,{name:"contractor.tin",caption:"TIN",required:!0}),i.a.createElement(o.W,{name:"contractor.managingofficer.name",caption:"Authorized Managing Officer",required:!0}),i.a.createElement(o.r,{name:"contractor.managingofficer.email",required:!0})),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:c}),i.a.createElement(o.e,{caption:"Next",action:function(){n.invoke("update",m,(function(e,t){e?r(e):l()}))}})))}},{step:6,name:"confirmation",caption:"Confirmation",component:function(e){var t=e.appno,n=e.appService,l=e.movePrevStep,c=e.onComplete,r=Object(a.useState)()[1],p=Object(a.useState)({}),m=p[0],s=p[1];return Object(a.useState)(!1),Object(a.useEffect)((function(){n.invoke("getApplication",{appid:t},(function(e,t){e?r(e):s(t)}))}),[t]),i.a.createElement(o.J,null,i.a.createElement(o.S,null,"Confirm Entry"),i.a.createElement("p",null,"Before sending please check first the generated application info. If everything is in order, you can click Submit button to complete the transaction."),i.a.createElement(o.P,null),i.a.createElement(o.J,{style:_.container},i.a.createElement(o.J,{style:_.row},i.a.createElement(o.y,{style:_.label},"Application for Occupancy Permit"),i.a.createElement(o.e,{caption:"View",action:function(){},variant:"outlined"})),i.a.createElement(o.J,{style:_.row},i.a.createElement(o.y,{style:_.label},"Certificate of Completion"),i.a.createElement(o.e,{caption:"View",action:function(){},variant:"outlined"}))),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:l}),i.a.createElement(o.e,{caption:"Submit",action:function(){n.invoke("update",m,(function(e,t){e?r(e):c()}))}})))}}],Y=function(e){var t=Object(a.useState)(!1)[1],n=Object(a.useState)(!1),l=n[0],r=n[1],m=Object(a.useState)("apptype"),s=m[0],u=m[1],d=(Object(a.useState)("full"),Object(a.useState)(Object(o.db)(e.location,"appid"))),f=d[0],E=d[1],y=Object(a.useState)({}),b=y[0],v=y[1],g=Object(a.useState)(0),h=g[0],S=g[1],j=e.partner,O=e.service;Object(a.useEffect)((function(){f&&(t(!0),X.invoke("findCurrentInfo",{appid:f},(function(e,n){e?r(e):(n||r("Application no. does not exist"),j.orgcode!=n.orgcode&&r("The application number provided is not for this local government"),console.log("app.step",n.step),v(n),S(n.step),u("processing")),t(!1)})))}),[f]);var x=function(e){E(e.appno),S(h+1),u("processing")},k=function(){var e=h<b.step?b.step:h+1;X.invoke("update",{objid:f,step:e},(function(t,n){t?r(t):S(e)}))};if("apptype"===s)return i.a.createElement(p,{service:e.service,error:l,onCancel:history.goBack,onSubmit:function(e){var t=e.appType,n=e.appno;"new"===t?u("init"):X.invoke("findCurrentInfo",{appid:n},(function(e,a){e?r(e):a?x({appType:t,appno:n}):r("Application no. does not exist.")}))}});if("init"===s)return i.a.createElement(U,c({},e,{appService:X,onComplete:x,onCancel:function(){return e.history.goBack()}}));var w=G[h],P=w.component,C={partner:j,appno:f,pages:G,moveNextStep:k,movePrevStep:function(){S((function(e){return e-1}))},appService:X,currentStep:h,stepCompleted:h<b.step,onComplete:function(){k(),e.history.goBack()}};return i.a.createElement(o.H,null,i.a.createElement(o.J,{target:"left",style:K.stepperContainer},i.a.createElement(o.R,{steps:G,completedStep:b.step,activeStep:h,handleStep:function(e){S(e)}})),i.a.createElement(o.g,null,i.a.createElement(o.X,null,O.title),i.a.createElement(o.T,null,"Tracking No. "+f),i.a.createElement(o.S,null,w.caption),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:l}),i.a.createElement(P,c({page:w},C))))},K={stepperContainer:{paddingTop:30,paddingLeft:40}},Q=function(e){var t=e.name,n=void 0===t?"profession":t,a=e.caption,l=void 0===a?"Profession":a,p=e.professions,m=r(e,["name","caption","professions"]);return i.a.createElement(o.l,c({name:n,caption:l,items:p},m))},Z=o.O.lookup("OboProfessionalService","obo"),$=function(e){var t=e.partner,n=e.onCancel,c=e.onVerified,r=Object(a.useState)("init"),p=r[0],m=r[1],s=Object(a.useState)({}),u=s[0],d=s[1],f=Object(a.useState)(),E=f[0],y=f[1],b=Object(a.useState)(!1)[1],v=Object(a.useState)({}),g=v[0],h=v[1],S=Object(a.useState)(),j=S[0],O=S[1],x=Object(a.useState)([]),k=x[0],w=x[1];Object(a.useEffect)((function(){Z.invoke("getProfessionList",null,(function(e,t){w(t)}))}),[]),Object(a.useEffect)((function(){Object.keys(u).length>0&&P()}),[g]);var P=function(){var e={};return g.prc&&g.prc.idno||(e.idno="PRC No. is required"),g.profession||(e.profession="Profession is required"),g.email||(e.email="Email is required"),0==Object.keys(e).length?(d({}),!0):(d(e),!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.t,{visibleWhen:"init"===p,context:g,handler:h},i.a.createElement(o.S,null,"Please specify initial information"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:E}),i.a.createElement(o.W,{name:"prc.idno",caption:"PRC No.",required:!0,error:u.idno,helperText:u.idno}),i.a.createElement(Q,{caption:"Profession (Copy profession in the PRC card",name:"profession",expr:function(e){return e},professions:k,required:!0,error:u.profession,helperText:u.profession}),i.a.createElement(o.r,{name:"email",required:!0,error:u.email,helperText:u.email}),i.a.createElement(o.E,{name:"mobileno"}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:n}),i.a.createElement(o.e,{caption:"Next",action:function(){P()&&(y(null),b(!0),Z.invoke("verifyInfo",g,(function(e,n){e?y(e):(function(){try{var e=o.O.lookupAsync(t.id+":VerifyEmailService","obo");return Promise.resolve(e.invoke("verifyEmail",{email:g.email,mobileno:g.mobileno}))}catch(e){return Promise.reject(e)}}().then((function(e){y(null),O(e.key),m("verify")})).catch((function(e){y(e)})),b(!1))})))}}))),i.a.createElement(o.J,{visibleWhen:"verify"===p},i.a.createElement(o.S,null,"Email Verification"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:E}),i.a.createElement("p",null,"Please enter the key code sent to your email at ",g.email,"."),i.a.createElement(l.o,{partner:t,hiddenCode:j,email:g.email,onCancel:function(){return m("init")},onVerified:function(){return c(g)},onResendCode:function(e){O(e)},width:200,connection:"obo"})))},ee=function(e){var t=e.info,n=void 0===t?{}:t,r=e.partner,p=e.onSubmit,m={entity:c({},n,{resident:!0}),prc:n.prc,resident:!0},s=Object(a.useState)()[0],u=Object(a.useState)(m),d=u[0],f=u[1];return i.a.createElement(o.J,null,i.a.createElement(o.S,null,"Register New Professional"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:s}),i.a.createElement(o.J,null,i.a.createElement(o.t,{context:d,handler:f},i.a.createElement("p",null,"Please fill in the necessary data below. Text marked with * are required fields. "),i.a.createElement(o.W,{caption:"Profession",name:"entity.profession",readOnly:!0}),i.a.createElement(l.k,{name:"entity",person:d,showAddress:!0,orgcode:r.id}),i.a.createElement(o.P,null),i.a.createElement(l.l,{name:"prc",disableIdNo:!0}),i.a.createElement(l.m,{name:"ptr"}),i.a.createElement(l.h,{caption:"Primary Identification",name:"id"}),i.a.createElement(o.a,null,i.a.createElement(o.e,{caption:"Next",action:function(){p(d)}})))))},te=function(e){var t=e.onClose;return i.a.createElement(o.J,null,i.a.createElement(o.m,{center:!0},i.a.createElement(o.P,null),i.a.createElement(o.v,{src:"/assets/success.png",width:120,alt:"success"}),i.a.createElement(o.P,null),i.a.createElement(o.X,null,"Success!"),i.a.createElement(o.P,null),i.a.createElement(o.y,{style:c({},ne.text,{maxWidth:300})},"You have successfully registered your professional information."),i.a.createElement(o.y,{labelStyle:ne.text},"Thank you for using this service."),i.a.createElement(o.P,null),i.a.createElement(o.h,null,i.a.createElement(o.e,{variant:"text",caption:"Return",onClick:t}))))},ne={text:{display:"block",textAlign:"center"}},ae=o.O.lookup("OboProfessionalService","obo"),ie=[{step:1,name:"initial",caption:"Initial"},{step:2,name:"newprofessional",caption:"New Professional"},{step:3,name:"disclaimer",caption:"Disclaimer"},{step:4,name:"registered",caption:"Registered"}],oe=function(e){var t=Object(a.useState)(!1)[1],n=Object(a.useState)(!1),r=n[0],p=n[1],m=(Object(a.useState)({}),Object(a.useState)("new"),Object(a.useState)(0)),s=m[0],u=m[1],d=(Object(a.useState)(),Object(a.useState)()),f=d[0],E=d[1],y=Object(a.useState)(),b=y[0],v=y[1],g=e.partner,h=e.service,S=e.history,j=function(){u((function(e){return e+1}))},O=ie[s];return i.a.createElement(o.H,null,i.a.createElement(o.J,{target:"left",style:le.stepperContainer},i.a.createElement(o.R,{steps:ie,activeStep:s})),i.a.createElement(o.g,null,i.a.createElement(o.X,null,h.title),i.a.createElement(o.s,{msg:r}),i.a.createElement(o.J,{visibleWhen:"initial"===O.name},i.a.createElement($,{partner:g,onCancel:S.goBack,onVerified:function(e){E(e),j()}})),i.a.createElement(o.J,{visibleWhen:"newprofessional"===O.name},i.a.createElement(ee,{partner:g,info:f,onSubmit:function(e){v(e),j()}})),i.a.createElement(o.J,{visibleWhen:"disclaimer"===O.name},i.a.createElement(l.c,{partner:g,onCancel:function(){u((function(e){return e-1}))},onSubmit:function(){t(!0);var e=function(){var e=c({},b.entity.address);b.entity.resident&&(e.citymunicipality=g.title,e.province=g.group.title);var t=c({},b.entity,{address:e}),n=c({},t,b);return delete n.entity,n}();ae.invoke("create",e,(function(e,n){e?function(e){t(!1),p(e.toString())}(e):j()}))}})),i.a.createElement(o.J,{visibleWhen:"registered"===O.name},i.a.createElement(te,{onClose:function(){return S.goBack()}}))))},le={stepperContainer:{paddingTop:30,paddingLeft:40}},ce=function(e){var t=Object(a.useState)(!1)[1],n=Object(a.useState)(!1),c=n[0],r=n[1],p=Object(a.useState)("init"),m=p[0],s=p[1],u=Object(a.useState)(),d=u[0],f=u[1],E=Object(a.useState)({subtasks:[]}),y=E[0],b=E[1],v=Object(a.useState)({}),g=v[0],h=v[1],S=Object(a.useState)()[1],j=e.partner,O=e.service,x=e.history,k="";return y&&y.task&&(k=Object(o.bb)(y.task.dtcreated)),i.a.createElement(o.H,null,i.a.createElement(o.g,null,i.a.createElement(o.X,null,O.title),i.a.createElement(o.J,{visibleWhen:"init"===m},i.a.createElement(o.S,null,"Building Permit Tracking No."),i.a.createElement(o.P,null),i.a.createElement(o.W,{caption:"Tracking No.",name:"trackingno",value:d,onChange:f,required:!0,error:c,helperText:c,fullWidth:!1,variant:"outlined"}),i.a.createElement(o.a,null,i.a.createElement(o.c,{action:function(){return x.goBack()}}),i.a.createElement(o.e,{caption:"Next",action:function(){r(null),d?o.O.lookup(j.id+":OboOnlineService","obo").invoke("verifyApplication",{trackingno:d},(function(e,t){e?r(e):(h(t),s("verification"))})):r("Tracking No. is required.")}}))),i.a.createElement(o.J,{visibleWhen:"verification"===m},i.a.createElement(o.S,null,"Account Verification"),i.a.createElement(o.P,null),i.a.createElement(l.o,{partner:j,hiddenCode:g.key,email:g.email,onCancel:function(){return s("init")},onVerified:function(e){S(e),t(!0),o.O.lookup(j.id+":OboOnlineService","obo").invoke("findApplicationStatus",{trackingno:d},(function(e,n){e?r(e):(b(n),s("info"),r(null),t(!1))}))}})),i.a.createElement(o.t,{visibleWhen:"info"===m,context:y,handler:b},i.a.createElement(o.S,null,"Building Permit Application Status"),i.a.createElement(o.P,null),i.a.createElement(o.J,null,i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{caption:"Tracking No.",name:"trackingno",readOnly:!0}),i.a.createElement(o.W,{caption:"Application No.",name:"appno",readOnly:!0})),i.a.createElement(o.W,{caption:"Project Title",name:"title",readOnly:!0}),i.a.createElement(o.W,{caption:"Project Location",expr:function(){if(!y.location)return"";var e=[];return y.location.lotno&&e.push("Lot: "+y.location.lotno),y.location.blockno&&e.push("Block: "+y.location.blockno),y.location.street&&e.push("Street: "+y.location.street),y.location.barangay.name&&e.push("Barangay: "+y.location.barangay.name),e.join(" ")},readOnly:!0}),i.a.createElement(o.P,null),i.a.createElement(o.W,{caption:"Applicant",name:"applicant.name",readOnly:!0}),i.a.createElement(o.W,{caption:"Occupancy Type",name:"occupancytype.title",readOnly:!0}),i.a.createElement(o.W,{caption:"Type of Work",expr:function(){var e,t="";return y.worktypes&&y.worktypes.length>0&&(t=null===(e=y.worktypes)||void 0===e?void 0:e.join(",")),t},readOnly:!0})),i.a.createElement(o.P,null),i.a.createElement(o.J,{style:re.currentTask},i.a.createElement("div",{style:re.title},i.a.createElement(o.T,null,"Current Task (ongoing)")),i.a.createElement("div",{style:re.taskInfo},i.a.createElement("h3",null,y&&y.task&&y.task.title),i.a.createElement(o.y,{caption:"Date Endorsed",expr:"task.dtcreated"}),y&&y.task&&y.task.assignee.name&&i.a.createElement(o.y,{caption:"Assigned To",expr:"task.assignee.name"}),i.a.createElement(o.y,{caption:"Duration",context:y,expr:function(e){return k}})))),i.a.createElement(o.J,{visibleWhen:"info"===m},i.a.createElement(o.P,null),i.a.createElement(o.T,null,"Activity Summary"),i.a.createElement("table",{style:re.table},i.a.createElement("tr",{style:re.trth},i.a.createElement("th",{style:re.tableText},"Section"),i.a.createElement("th",{style:re.tableText},"Name"),i.a.createElement("th",{style:re.tableText},"Date Endorsed"),i.a.createElement("th",{style:re.tableText},"Duration")),i.a.createElement("tbody",null,y.subtasks.map((function(e){return i.a.createElement("tr",{key:e.objid,style:re.trth},i.a.createElement("td",{style:re.tableText},e.typeid),i.a.createElement("td",{style:re.tableText},e.task.title),i.a.createElement("td",{style:re.tableText},e.task.dtcreated||"Not yet started"),i.a.createElement("td",{style:re.tableText},Object(o.bb)(e.task.dtcreated),"  "))})))))))},re={currentTask:{border:"1px solid #aaa",borderRadius:5,boxShadow:"0px 5px 7px -7px rgba(0,0,0,0.75)"},taskInfo:{padding:"0px 10px"},title:{padding:"5px 10px",backgroundColor:"#ddd",borderBottom:"1px solid #aaa",borderRadius:5},table:{width:"100%",borderSpacing:0},tableText:{fontSize:12,border:"1px solid #ddd",padding:5},trth:{border:"1px solid #ddd",cellSpacing:0,padding:5}},pe=function(e){var t=e.title,n=e.partner,l=e.onCancel,c=e.onSubmit,r=e.error,p=Object(o.hb)()[0],m=p.refno,s=p.txntype,u=Object(a.useState)(p.bill)[0],d=Object(a.useState)(r)[0],f=Object(a.useState)(!1)[0];return i.a.createElement(o.g,{style:{maxWidth:800}},i.a.createElement(o.X,null,t),i.a.createElement(o.S,null,"Billing Information"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:d}),i.a.createElement(o.J,null,i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{context:u,caption:"Tracking No.",expr:"trackingno",readOnly:!0}),i.a.createElement(o.W,{context:u,caption:"Application No.",expr:"appno",readOnly:!0})),i.a.createElement(o.J,{row:!0},i.a.createElement(o.W,{context:u,caption:"Permit Type",expr:"permittype",readOnly:!0}),i.a.createElement(o.W,{context:u,caption:"Application Type",expr:"apptype",readOnly:!0})),i.a.createElement(o.W,{context:u,caption:"Project Name",expr:"title",readOnly:!0}),i.a.createElement(o.W,{context:u,caption:"Applicant",expr:"applicant.name",readOnly:!0}),i.a.createElement(o.W,{context:u,caption:"Address",expr:"applicant.address.text",readOnly:!0}),i.a.createElement("h4",null,"Bill Details"),i.a.createElement(o.U,{items:u?u.items:[],size:"small",showPagination:!1},i.a.createElement(o.V,{caption:"Particulars",expr:"item.title"}),i.a.createElement(o.V,{caption:"Amount",expr:"amount",align:"right",format:"currency"})),i.a.createElement(o.J,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",paddingRight:15}},i.a.createElement(o.y,{context:u,caption:"Bill Amount:",expr:function(e){return Object(o.Z)(e.amount)}}))),i.a.createElement(o.a,{disabled:f},i.a.createElement(o.c,{caption:"Back",action:function(){l(0)}}),i.a.createElement(o.e,{caption:"Confirm Payment",action:function(){c({refno:m,txntype:s,origin:"filipizen",orgcode:n.id,info:{data:u},paidby:u.paidby,paidbyaddress:u.paidbyaddress,amount:u.amount,particulars:"Obo Application No. "+u.appno})},disableWhen:0===u.amount})))},me={txntype:"obo",contact:{},refno:null,apptype:null,bill:{}},se=function(e,t){switch(t.type){case"SET_BILL":return e.refno=t.refno,e.apptype=t.apptype,void(e.bill=t.bill);case"SET_CONTACT":return void(e.contact=t.contact)}},ue=[{step:1,name:"verification",caption:"Verification",Component:l.b},{step:2,name:"initial",caption:"Initial Information",Component:function(e){var t=e.title,n=e.partner,l=e.moveNextStep,r=e.movePrevStep,p=Object(o.hb)(),m=p[1],s=p[0].txntype,u=Object(a.useState)(),d=u[0],f=u[1],E=Object(a.useState)({}),y=E[0],b=E[1],v=Object(a.useState)(!1),g=v[0],h=v[1],S=Object(a.useState)({apptype:"building"}),j=S[0],O=S[1];return i.a.createElement(o.g,null,i.a.createElement(o.X,null,t),i.a.createElement(o.S,null,"Initial Information"),i.a.createElement(o.P,null),i.a.createElement(o.s,{msg:d}),i.a.createElement(o.t,{context:j,handler:O},i.a.createElement(o.W,{name:"refno",caption:"Application No.",autoFocus:!0,error:y.refno,helperText:y.refno}),i.a.createElement(o.P,null),i.a.createElement(o.J,null,i.a.createElement("label",null,"Application Type:"),i.a.createElement(o.J,{style:{marginLeft:20}},i.a.createElement(o.L,{name:"apptype"},i.a.createElement(o.x,{caption:"Building Permit",value:"building"}),i.a.createElement(o.x,{caption:"Occupancy Permit",value:"occupancy"}))))),i.a.createElement(o.a,null,i.a.createElement(o.c,{caption:"Back",variant:"text",action:r}),i.a.createElement(o.e,{caption:"Next",action:function(){b({}),j.refno?(h(!0),f(null),function(){try{return Promise.resolve(o.O.lookupAsync(n.id+":OboOnlineBillingService","obo")).then((function(e){return Promise.resolve(e.getBilling(c({txntype:s},j,{qtr:4,showdetails:!0})))}))}catch(e){return Promise.reject(e)}}().then((function(e){console.log("BILL",e),m(c({type:"SET_BILL"},j,{bill:e})),l()})).catch((function(e){f(e.toString()),h(!1)}))):b({refno:"Application No. is required."})},loading:g,disabled:g})),i.a.createElement("p",null,JSON.stringify(j,null,2)))}},{step:3,name:"payment",caption:"Payment",Component:function(e){var t=Object(o.hb)();return i.a.createElement(l.d,c({module:{title:e.title,component:pe}},e,{initialContact:t[0].contact,initialStep:1,cancelPayment:e.cancelPayment}))}}],de=function(e){var t=e.partner,n=e.service,l=e.location,r=e.history,p=e.initialStep,m=Object(a.useState)(void 0===p?1:p),s=m[0],u=m[1],d=ue[s];return i.a.createElement(o.Q,{initialState:me,reducer:se},i.a.createElement(o.H,null,i.a.createElement(o.m,{center:!0},i.a.createElement(o.J,null,i.a.createElement(d.Component,c({page:d},{partner:t,service:n,location:l,history:r,moveNextStep:function(){u((function(e){return e+1}))},movePrevStep:function(){0===s?r.goBack():u((function(e){return e-1}))},cancelPayment:function(){u(1)},title:"Building Permit Online Billing"}))))))}}}]);
//# sourceMappingURL=13.ae2f5c30.chunk.js.map